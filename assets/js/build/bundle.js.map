{"version":3,"sources":["bundle.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","update_script","add_script","delete_script","_types","_output","_interopRequireDefault","_menu","_data","obj","__esModule","default","scripts","props","type","DELETE_SCRIPT","id","inputs","menuItem","newScript","dest","ADD_SCRIPT","data","menu","output","script","UPDATE_SCRIPT","input","attr","../reducers/data","../reducers/menu","../reducers/output","./types","2","3","_dataset","_utilities","_scriptActions","_slicedToArray","arr","Array","isArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","_iterableToArrayLimit","TypeError","_nonIterableRest","content","options","editor","fromTextArea","document","getElementById","lineNumbers","mode","javascript","theme","tabSize","elements","_svt","querySelector","settings","querySelectorAll","icons","init","isEmpty","this","newSession","setActiveScript","getFirstScript","events","_this","_this$elements","addEventListener","selectScript","bind","on","codeUpdate","forEach","setting","attrUpdate","deleteScript","btn","toggleMenu","toggleButtons","uploadFile","target","classList","contains","getAttribute","uniqueID","activeScript","codeOutput","concat","setValue","setOption","language","dataset","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","children","return","_scripts$id","label","file","entries","_arr$_i","key","textContent","getFileName","toggle","arguments","_this$elements2","_this$activeScript","getValue","preventDefault","toUpperCase","boilerplate","element","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","parentNode","checked","_this2","attachment","mediaUploader","uploader","state","get","first","toJSON","url","open","../../../codemirror/addon/mode/simple","../../../codemirror/lib/codemirror","../../../codemirror/mode/css/css","../../../codemirror/mode/htmlmixed/htmlmixed","../../../codemirror/mode/javascript/javascript","../../../codemirror/mode/xml/xml","./actions/scriptActions","./modes/enhanced","./modules/dataset","./modules/utilities","4","defineSimpleMode","start","regex","token","indent","dedent","comment","meta","dontIndentStates","lineComment","../../../../codemirror/lib/codemirror","5","_defineProperties","descriptor","enumerable","configurable","writable","Savant","instance","Constructor","_classCallCheck","getInitialScripts","getOptions","protoProps","staticProps","x","from","reduce","acc","curr","prototype","6","hasOwnProperty","Math","floor","random","unique","keys","str","replace","wp","media","frames","file_frame","title","button","text","multiple","7","action","_action$data","8","node","createElement","add","appendChild","remove","9","_value","name","10","_typeof","constructor","mod","CodeMirror","ensureState","states","toRegex","val","caret","flags","RegExp","ignoreCase","source","String","Rule","apply","result","asToken","cmp","b","prop","enterLocalMode","config","spec","pers","persistent","persistentStates","getMode","lState","startState","localState","local","end","endScan","forceEnd","endToken","join","defineMode","simpleMode","states_","hasIndentation","list","orig","pending","copyState","s","slice","stack","stream","pend","shift","pos","match","tok","m","exec","current","index","curState","rule","matches","sol","pop","indentation","indentUnit","j","backUp","innerMode","textAfter","line","indexOf","Pass","rules","scan","dedentIfLineStart","define","amd","../../lib/codemirror","11","factory","userAgent","navigator","platform","gecko","test","ie_upto10","ie_11up","edge","ie","ie_version","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","Number","flipCtrlCmd","captureRightClick","classTest","cls","range","rmClass","className","after","removeChildren","count","childNodes","removeChild","firstChild","removeChildrenAndAdd","parent","elt","tag","style","cssText","createTextNode","eltP","setAttribute","child","nodeType","host","activeElt","activeElement","body","shadowRoot","addClass","joinClasses","as","split","createRange","endNode","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","select","args","copyObj","overwrite","countColumn","string","startIndex","startValue","search","nextTab","selectionStart","selectionEnd","Delayed","array","set","ms","clearTimeout","setTimeout","scrollerGap","toString","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","col","skipped","min","spaceStrs","spaceStr","lst","map","out","nothing","createObj","base","inst","create","nonASCIISingleCaseWordChar","isWordCharBasic","ch","toLowerCase","isWordChar","helper","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","dir","charAt","findFirst","pred","to","midF","mid","ceil","Display","place","doc","d","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursorDiv","measure","lineMeasure","lineSpace","lines","mover","sizer","sizerWidth","heightForcer","gutters","lineGutter","scroller","wrapper","zIndex","paddingRight","draggable","viewFrom","viewTo","reportedViewFrom","reportedViewTo","view","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","selForContextMenu","activeTouch","getLine","size","chunk","sz","chunkSize","getBetween","iter","getLines","updateLineHeight","height","diff","lineNo","cur","no","_lineAtHeight","h","outer","i$1","lh","isLine","l","lineNumberFor","lineNumberFormatter","firstLineNumber","Pos","sticky","equalCursorPos","copyPos","maxPos","minPos","clipLine","max","_clipPos","linelen","last","clipPosArray","sawReadOnlySpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","stretchSpansOverChange","change","full","oldFirst","markedSpans","oldLast","startCh","endCh","isInsert","old","nw","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansBefore","startsBefore","markedSpansAfter","sameLine","offset","found","span$1","clearEmptySpans","newMarkers","gapMarkers","gap","i$2","i$3","clearWhenEmpty","splice","detachMarkedSpans","detachLine","attachMarkedSpans","attachLine","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","find","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","visualLine","merged","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","_heightAtLine","lineObj","lineLength","len","found$1","findMaxLine","cm","display","bidiOther","getBidiPartAt","order","bidiOrdering","lowTypes","arabicTypes","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","direction","outerType","types","prev","type$1","prev$1","type$2","i$4","type$3","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","at","j$2","nstart","unshift","reverse","getOrder","noHandlers","emitter","attachEvent","_handlers","getHandlers","off","removeEventListener","detachEvent","signal","handlers","signalDOMEvent","override","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","ctrlKey","zwspSupported","badBidiRects","dragAndDrop","div","zeroWidthElement","offsetHeight","offsetWidth","hasBadBidiRects","txt","r0","getBoundingClientRect","r1","left","right","splitLinesAuto","nl","rt","hasSelection","window","getSelection","te","ownerDocument","selection","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","modes","mimeModes","resolveMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","nstate","info","a1","a2","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","eol","peek","eat","eatWhile","eatSpace","skipToEnd","skipTo","column","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","lookAhead","oracle","baseToken","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","context","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","save","styleClasses","highlightFrontier","modeFrontier","precise","minindent","minline","lim","indented","findStartLine","saved","fromSaved","processLine","nextLine","startAt","callBlankLine","readToken","blankLine","copy","Token","takeToken","asArray","tokens","extractLineClasses","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","Line","estimateHeight","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","insertLineContent","maps","caches","lastChild","defaultSpecialCharPlaceholder","startStyle","endStyle","css","displayText","trailingBefore","spaceBefore","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","part","buildCollapsedSpan","ignoreWidget","widget","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","Infinity","foundBookmarks","endStyles","upto","tokenText","LineView","visualLineContinued","hidden","buildViewArray","nextPos","operationGroup","orphanDelayedCallbacks","signalLater","delayedCallbacks","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","getLineContent","ext","built","background","wrap","insertBefore","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","markers","gutterMarkers","wrap$1","gutterWrap","lineNumber","gutterLeft","k","gutterWidth","alignable","nextSibling","insertLineWidgets","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","position","marginLeft","widgetHeight","parentStyle","clientWidth","eventInWidget","paddingTop","offsetTop","paddingVert","paddingH","getComputedStyle","currentStyle","parseInt","isNaN","scrollGap","displayWidth","displayHeight","clientHeight","mapFromLineView","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","abs","bottom","top","ensureLineHeights","nodeAndOffsetInLineMap","coverStart","coverEnd","getUsefulRect","screen","logicalXDPI","deviceXDPI","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","charWidth","nullRect","rtop","rbot","bot","bogus","singleCursorHeightPerLine","rbottom","measureCharInner","measureText","mStart","mEnd","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","_charCoords","_cursorCoords","preparedMeasure","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","_coordsChar","y","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","boxIsAfter","box","ltr","_lineNo","ref","closestDist","endX","dist","baseX","chAround","boxAround","atLeft","atStart","textHeight","anchor","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","estHeight","posFromMouse","liberal","forRect","space","clientX","clientY","colDiff","round","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","head","drawSelectionRange","cursor","cursorHeight","otherCursor","cmpCoords","fragment","padding","leftSide","rightSide","docLTR","drawForLine","fromArg","toArg","lineLen","wrapX","side","extent","iterateBidiSections","fromPos","toPos","openStart","openEnd","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","visibility","cursorBlinkRate","setInterval","ensureFocus","focus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","readOnly","reset","receivedFocus","updateHeightsInViewport","prevBottom","updateWidgetHeight","w","visibleLines","viewport","ensure","ensureFrom","ensureTo","alignHorizontally","comp","gutterW","align","maybeUpdateLineNumberWidth","innerW","updateGutterSpace","calculateScrollPos","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","margin","cursorScrollMargin","scrollToCoords","scrollToCoordsRange","sPos","updateScrollTop","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","setScrollLeft","isScroller","scrollWidth","measureForScrollbars","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","update","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elementFromPoint","clear","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","borderBottom","coverGutterNextToScrollbar","scrollbarModel","native","null","initScrollbars","scrollbarStyle","axis","nextOpId","_startOperation","op","viewChanged","updateInput","typing","changeObjs","cursorActivityCalled","selectionChanged","updateMaxLine","ops","ownsGroup","_endOperation","endCb","group","callbacks","fireCallbacksForOps","finishOperation","endOperation_R1","updatedDisplay","mustUpdate","updateDisplayIfNeeded","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","marginBottom","borderRightWidth","DisplayUpdate","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","doScroll","innerHeight","scrollNode","scrollIntoView","maybeScrollWindow","limit","changed","endCoords","scrollPos","startTop","startLeft","scrollPosIntoView","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","countDirtyView","dirty","time","highlight","highlightWorker","Date","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","viewportMargin","different","toUpdate","selSnapshot","hasFocus","active","anchorNode","extend","anchorOffset","focusNode","focusOffset","selectionSnapshot","updateNumbersFrom","container","rm","currentWheelTarget","updateNumber","patchDisplay","snapshot","removeAllRanges","addRange","restoreSelection","updateGutters","specs","gElt","setGuttersForLineNumbers","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","deepCopy","Range","somethingSelected","normalizeSelection","prim","sort","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","updateLine","linesFor","firstLine","lastText","lastSpans","nlines","insert","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","History","startGen","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","addChangeToHistory","selAfter","opId","hist","history","historyEventDelay","pushSelectionToHistory","addSelectionToHistory","clearRedo","existing","removeClearedSpans","explicitlyCleared","mergeOldSpans","getOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","event","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","setSelectionNoUndo","NaN","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","mark","parts","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","filter","returned","v","shiftDoc","distance","removed","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","makeChangeSingleDocInEditor","_replaceRange","assign","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","ok","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","remaining","leaf","maybeSpill","me","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","nextMarkerId","TextMarker","_markText","cloneNode","isParent","SharedTextMarker","markTextShared","replacedWith","addToHistory","curLine","clearOnEnter","clearHistory","withOp","visual","dHeight","findSharedMarkers","findMarks","clipPos","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","lineSeparator","replaceRange","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","newSel","hint","oldPrev","newPrev","computeReplacedSel","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","addLineWidget","insertAt","aboveVisible","removeLineWidget","markText","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","loadFile","allowDropFileTypes","reader","onload","readAsText","draggingText","text$1","getData","selected","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","globalsRegistered","ensureGlobalHandlers","resizeTimer","onResize","setSize","keyNames","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","127","145","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","fromCharCode","keyMap","normalizeKeyName","alt","ctrl","cmd","normalizeKeyMap","keymap","keyname","lookupKey","getKeyMap","fallthrough","isModifierKey","keyCode","addModifierNames","noShift","altKey","metaKey","shiftKey","keyName","altGraphKey","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","prep","targetTop","basic","Left","Right","Up","Down","End","Home","PageUp","PageDown","Delete","Backspace","Shift-Backspace","Tab","Shift-Tab","Enter","Insert","Esc","pcDefault","Ctrl-A","Ctrl-D","Ctrl-Z","Shift-Ctrl-Z","Ctrl-Y","Ctrl-Home","Ctrl-End","Ctrl-Up","Ctrl-Down","Ctrl-Left","Ctrl-Right","Alt-Left","Alt-Right","Ctrl-Backspace","Ctrl-Delete","Ctrl-S","Ctrl-F","Ctrl-G","Shift-Ctrl-G","Shift-Ctrl-F","Shift-Ctrl-R","Ctrl-[","Ctrl-]","Ctrl-U","Shift-Ctrl-U","Alt-U","emacsy","Ctrl-B","Ctrl-P","Ctrl-N","Alt-F","Alt-B","Ctrl-E","Ctrl-V","Shift-Ctrl-V","Ctrl-H","Alt-D","Alt-Backspace","Ctrl-K","Ctrl-T","Ctrl-O","macDefault","Cmd-A","Cmd-D","Cmd-Z","Shift-Cmd-Z","Cmd-Y","Cmd-Home","Cmd-Up","Cmd-End","Cmd-Down","Cmd-Left","Cmd-Right","Ctrl-Alt-Backspace","Alt-Delete","Cmd-S","Cmd-F","Cmd-G","Shift-Cmd-G","Cmd-Alt-F","Shift-Cmd-Alt-F","Cmd-[","Cmd-]","Cmd-Backspace","Cmd-Delete","Cmd-U","Shift-Cmd-U","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","charCoords","coordsChar","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","visualLineEnd","lineEnd","goLineRight","cursorCoords","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","keyMaps","extraKeys","lookupKeyForEditor","handleKeyBinding","motion","lastStoppedKey","onKeyDown","handled","up","showCrossHair","onKeyUp","onKeyPress","charCode","lastClick","lastDoubleClick","PastClick","onMouseDown","supportsTouch","contextMenuInGutter","clickInGutter","now","repeat","compare","selectingText","handleMappedButton","contained","behavior","option","unit","addNew","moveOnDrag","configureMouse","dragDrop","moved","dragEnd","mouseMove","dragStart","e2","leftButtonStartDrag","ourRange","ourIndex","startSel","rangeForUnit","lastPos","extendTo","startCol","posCol","leftPos","oldRange","ranges$1","anchorLine","boundary","headIndex","usePart","bidiSimplify","editorSize","counter","move","buttons","curCount","leftButtonSelect","leftButtonDown","onContextMenu","findWordAt","gutterEvent","prevent","mX","mY","touches","lineBox","g","themeChanged","Init","defaults","optionHandlers","guttersChanged","dragDropChanged","funcs","dragFunctions","enter","over","leave","drop","wrappingChanged","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","word","touchFinished","prevTouch","finishTouch","farAway","touch","radiusX","radiusY","isMouseLikeTouchEvent","pageX","pageY","frag","onDragOver","setData","effectAllowed","setDragImage","img","src","_top","onDragStart","inp","getField","registerEventHandlers","finishInit","initHooks","textRendering","how","aggressive","curSpace","curSpaceString","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","hiddenTextarea","border","_findPosH","origDir","moveOnce","boundToLine","bidi","mv","getWrappedLineExtent","moveInStorageOrder","searchInVisualLine","getRes","res","nextCh","moveVisually","sawType","getHelper","hitSide","_findPosV","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","badPos","bad","domToPos","lineNode","locateNodeInLineView","textNode","topNode","nodeValue","curNode","previousSibling","dist$1","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","blur","pollSelection","pollInterval","poll","isInGutter","triggerOnKeyDown","pollContent","fromIndex","fromNode","toNode","toIndex","newText","closing","extraLinebreak","close","addText","walk","cmText","markerID","isBlock","nodeName","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","readOnlyChanged","resetPosition","helpers","TextareaInput","prevInput","pollingFast","createField","textarea","prepareCopyCut","fastPoll","_display","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldCSS","oldWrapperCSS","oldScrollY","wrapperBox","scrollY","scrollTo","detectingSelectAll","prepareSelectAllHack","mouseup","rehide","extval","disabled","deflt","notOnInit","defineOption","newBreaks","refresh","getInputField","detach","attach","integer","defineOptions","getDoc","addKeyMap","removeKeyMap","addOverlay","score","priority","insertSorted","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelpers","help","_global","getStateAfter","lineAtHeight","heightAtLine","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","findPosH","amount","rtlMoveVisually","findPosV","goalColumn","goals","startChar","check","getScrollInfo","interpret","startOperation","endOperation","swapDoc","phrase","phraseText","phrases","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","dontDelegate","method","contenteditable","dependencies","defineMIME","mime","defineExtension","func","defineDocExtension","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","cmpPos","version","12","keySet","parserConfig","inline","propertyKeywords","tokenHooks","documentTypes","mediaTypes","mediaFeatures","mediaValueKeywords","nonStandardPropertyKeywords","fontProperties","counterDescriptors","colorKeywords","valueKeywords","allowNested","supportsAtComponent","ret","tp","tokenString","quote","escaped","tokenize","tokenParenthesized","pushContext","popContext","pass","popAndPass","wordAsValue","stateArg","block","maybeprop","propBlock","_stream","parens","pseudo","atBlock","atComponentBlock","atBlock_parens","restricted_atBlock_before","restricted_atBlock","keyframes","interpolation","cx","blockCommentStart","blockCommentEnd","blockCommentContinue","fold","documentTypes_","mediaTypes_","mediaFeatures_","mediaValueKeywords_","propertyKeywords_","nonStandardPropertyKeywords_","colorKeywords_","valueKeywords_","allWords","tokenCComment","maybeEnd","/",":","$","#","@","&","defaultTags","attrRegexpCache","getAttrValue","getTagRegexp","tagName","anchored","addTags","htmlMode","multilineTagIndentFactor","multilineTagIndentPastTag","tags","configTags","configScript","scriptTypes","html","htmlState","inTag","tagInfo","tagText","findMatchingMode","endTagA","endTag","localMode","pat","../css/css","../javascript/javascript","../xml/xml","14","statementIndent","jsonldMode","jsonld","jsonMode","json","isTS","typescript","wordRE","wordCharacters","keywords","kw","A","B","C","D","operator","atom","if","while","with","else","do","try","finally","break","continue","new","delete","void","throw","debugger","var","const","let","function","catch","for","switch","case","in","typeof","instanceof","true","false","class","super","yield","export","import","extends","await","isOperatorChar","isJsonldKeyword","cont","tokenBase","tokenComment","expressionAllowed","inSet","readRegexp","tokenQuasi","lexical","lastType","propertyIsEnumerable","brackets","findFatArrow","fatArrowAt","arrow","depth","sawSomething","bracket","atomicTypes","number","variable","regexp","jsonld-keyword","JSLexical","inScope","varname","localVars","vars","marked","cc","inList","register","newContext","registerVarScoped","Var","globalVars","isModifier","defaultVars","pushcontext","pushblockcontext","popcontext","pushlex","lex","poplex","expect","wanted","exp","statement","vardef","parenExpr","maybeexpression","maybeelse","functiondef","forspec","enumdef","typeexpr","expression","maybelabel","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","expressionNoComma","noComma","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","arrayLiteral","contCommasep","objprop","quasi","targetNoComma","maybeTypeArgs","expr","property","continueQuasi","_","getterSetter","afterprop","maybetype","what","sep","proceed","mayberettype","isKW","afterType","typeprop","typearg","maybeReturnType","typeparam","maybeTypeDefault","maybeAssign","vardefCont","eltpattern","proppattern","_type","forspec1","forspec2","formaybeinof","forspec3","classNameAfter","classBody","classfield","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","basecolumn","parseJS","firstChar","doubleIndentSwitch","closeBrackets","skipExpression","15","htmlConfig","autoSelfClosers","area","br","command","embed","frame","hr","keygen","link","param","track","wbr","menuitem","implicitlyClosed","dd","li","optgroup","rp","tbody","td","tfoot","tr","contextGrabbers","dt","address","article","aside","blockquote","dl","fieldset","footer","h1","h2","h3","h4","h5","h6","header","hgroup","nav","ol","section","table","ul","thead","doNotIndent","allowUnquoted","allowMissing","caseFold","xmlConfig","allowMissingTagName","editorConf","config_","setStyle","inText","chain","parser","inBlock","doctype","closure","isInAttribute","stringStartCol","baseState","tagStart","terminator","startOfLine","noIndent","maybePopContext","nextTagName","parentTagName","tagNameState","closeTagNameState","attrState","closeState","closeStateErr","matchClosing","attrEqState","attrValueState","attrContinuedState","isInText","baseIndent","fullLine","alignCDATA","tagAfter","grabbers","configuration","skipAttribute"],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.update_script = exports.add_script = exports.delete_script = void 0;\n\nvar _types = require(\"./types\");\n\nvar _output = _interopRequireDefault(require(\"../reducers/output\"));\n\nvar _menu = _interopRequireDefault(require(\"../reducers/menu\"));\n\nvar _data = _interopRequireDefault(require(\"../reducers/data\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar delete_script = function delete_script(scripts, props) {\n  var type = _types.DELETE_SCRIPT;\n  var id = props.id,\n      inputs = props.inputs,\n      menuItem = props.menuItem;\n  (0, _data.default)({\n    type: type,\n    scripts: scripts,\n    id: id\n  });\n  (0, _output.default)({\n    type: type,\n    inputs: inputs\n  });\n  (0, _menu.default)({\n    type: type,\n    menuItem: menuItem\n  });\n};\n\nexports.delete_script = delete_script;\n\nvar add_script = function add_script(scripts, newScript, dest) {\n  var type = _types.ADD_SCRIPT;\n  var data = (0, _data.default)({\n    type: type,\n    scripts: scripts,\n    data: newScript\n  });\n  (0, _menu.default)({\n    type: type,\n    data: data,\n    dest: dest.menu\n  });\n  (0, _output.default)({\n    type: type,\n    data: data,\n    dest: dest.output\n  });\n};\n\nexports.add_script = add_script;\n\nvar update_script = function update_script(script, data, dest) {\n  var type = _types.UPDATE_SCRIPT;\n  var value = (0, _data.default)({\n    type: type,\n    script: script,\n    data: data\n  });\n  (0, _output.default)({\n    type: type,\n    value: value,\n    dest: dest.input\n  });\n  if (dest.menuItem) (0, _menu.default)({\n    type: type,\n    attr: data.attr,\n    value: value,\n    dest: dest.menuItem\n  });\n};\n\nexports.update_script = update_script;\n\n},{\"../reducers/data\":7,\"../reducers/menu\":8,\"../reducers/output\":9,\"./types\":2}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UPDATE_SCRIPT = exports.ADD_SCRIPT = exports.DELETE_SCRIPT = void 0;\nvar DELETE_SCRIPT = 'DELETE_SCRIPT';\nexports.DELETE_SCRIPT = DELETE_SCRIPT;\nvar ADD_SCRIPT = 'ADD_SCRIPT';\nexports.ADD_SCRIPT = ADD_SCRIPT;\nvar UPDATE_SCRIPT = 'UPDATE_SCRIPT';\nexports.UPDATE_SCRIPT = UPDATE_SCRIPT;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nvar _dataset = _interopRequireDefault(require(\"./modules/dataset\"));\n\nvar _utilities = require(\"./modules/utilities\");\n\nvar _scriptActions = require(\"./actions/scriptActions\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nrequire('../../../codemirror/mode/xml/xml');\n\nrequire('../../../codemirror/mode/javascript/javascript');\n\nrequire('../../../codemirror/mode/css/css');\n\nrequire('../../../codemirror/mode/htmlmixed/htmlmixed');\n\nrequire('../../../codemirror/addon/mode/simple');\n\nrequire('./modes/enhanced');\n\n// Initialise Data\nvar content = new _dataset.default();\nvar scripts = content.scripts,\n    options = content.options; // Setup Editor\n\nvar CodeMirror = require('../../../codemirror/lib/codemirror');\n\nvar editor = CodeMirror.fromTextArea(document.getElementById('savantEditor'), {\n  lineNumbers: true,\n  mode: options.mode.javascript,\n  theme: options.theme,\n  tabSize: 2\n});\nvar core = {\n  // Cache DOM\n  elements: {\n    _svt: document.getElementById('savant_meta'),\n    menu: document.querySelector('.savant-tab ul'),\n    output: document.querySelector('.savant-data'),\n    settings: document.querySelectorAll('.savant-settings .settings-field'),\n    icons: document.querySelectorAll('.controls i.icon')\n  },\n  // Initialise User Interface\n  init: function init() {\n    !(0, _utilities.isEmpty)(scripts) ? this.setActiveScript((0, _utilities.getFirstScript)(scripts)) : this.newSession(true);\n    this.events();\n  },\n  events: function events() {\n    var _this = this;\n\n    var _this$elements = this.elements,\n        _svt = _this$elements._svt,\n        menu = _this$elements.menu,\n        settings = _this$elements.settings,\n        icons = _this$elements.icons; // Select Item from Nav\n\n    menu.addEventListener('click', this.selectScript.bind(this)); // Update data object and inputs field on editor input\n\n    editor.on('change', this.codeUpdate.bind(this)); // Settings Fields\n\n    settings.forEach(function (setting) {\n      return setting.addEventListener('input', _this.attrUpdate.bind(_this));\n    }); // Bin Item\n\n    _svt.querySelector('i.trash').addEventListener('click', this.deleteScript.bind(this)); // Submits new script form\n\n\n    _svt.querySelector('button.btn[type=\"submit\"]').addEventListener('click', this.newScript.bind(this)); // Icon Buttons\n\n\n    icons.forEach(function (btn) {\n      return btn.addEventListener('click', _this.toggleMenu.bind(_this));\n    }); // Toggles radio input buttons\n\n    _svt.querySelectorAll('.btn.radio').forEach(function (btn) {\n      return btn.addEventListener('click', _this.toggleButtons);\n    }); // WP uploader\n\n\n    _svt.querySelector('.file .upload').addEventListener('click', this.uploadFile.bind(this));\n  },\n  selectScript: function selectScript(e) {\n    if (!e.target.classList.contains('button-language')) return;\n    var id = e.target.getAttribute('data-id');\n    var temp = (0, _utilities.uniqueID)(scripts); // Set Active Script\n\n    this.setActiveScript(id);\n  },\n  setActiveScript: function setActiveScript(id) {\n    // Set activeScript object value\n    this.activeScript = {\n      id: id,\n      codeOutput: this.elements.output.querySelector(\"input[data-id=\\\"\".concat(id, \"\\\"][data-attribute=\\\"code\\\"]\"))\n    }; // Set Value in editor\n\n    editor.setValue(scripts[id].code);\n    editor.setOption('mode', options.mode[scripts[id].language]);\n    document.querySelector('.savant-window').dataset['type'] = scripts[id].type; // Add Active class to button\n\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = this.elements.menu.children[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var a = _step.value;\n        a.classList[a.dataset['id'] == id ? 'add' : 'remove']('active');\n      } // Set settings values\n\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    var _scripts$id = scripts[id],\n        label = _scripts$id.label,\n        type = _scripts$id.type,\n        language = _scripts$id.language,\n        file = _scripts$id.file;\n\n    var _arr = Object.entries({\n      label: label,\n      type: type,\n      language: language\n    });\n\n    for (var _i = 0; _i < _arr.length; _i++) {\n      var _arr$_i = _slicedToArray(_arr[_i], 2),\n          key = _arr$_i[0],\n          value = _arr$_i[1];\n\n      document.querySelector(\".settings-field[data-attribute=\\\"\".concat(key, \"\\\"]\")).value = value;\n    } // Set the editor or file window\n\n\n    document.querySelector('.savant-window').dataset['type'] = type; // Set the file tag name\n\n    document.querySelector('.file div span').textContent = (0, _utilities.getFileName)(file);\n  },\n  newSession: function newSession(toggle) {\n    document.querySelector('.savant-config').classList[toggle ? 'add' : 'remove']('new', 'expand');\n    document.querySelector('.savant.side-bar').classList[toggle ? 'add' : 'remove']('new', 'expand');\n  },\n  deleteScript: function deleteScript() {\n    var id = this.activeScript.id;\n    var menuItem = document.querySelector(\".savant-tab [data-id=\\\"\".concat(id, \"\\\"]\")); // Delete item from Data Object and DOM\n\n    (0, _scriptActions.delete_script)(scripts, {\n      id: id,\n      inputs: document.querySelectorAll(\".savant-data input[data-id=\\\"\".concat(id, \"\\\"]\")),\n      menuItem: menuItem\n    }); // If Scripts Object is not empty set Active Script to first item else set New Session Window\n\n    if (!(0, _utilities.isEmpty)(scripts)) {\n      this.setActiveScript((0, _utilities.getFirstScript)(scripts));\n    } else {\n      this.newSession(true);\n      editor.setValue('');\n    }\n  },\n  attrUpdate: function attrUpdate(e) {\n    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var id = this.activeScript.id;\n    var _this$elements2 = this.elements,\n        output = _this$elements2.output,\n        menu = _this$elements2.menu;\n    var attr = data.attr || e.target.dataset['attribute'];\n    var value = data.value || e.target.value;\n    var dest = {\n      input: output.querySelector(\"[data-id=\\\"\".concat(id, \"\\\"][data-attribute=\\\"\").concat(attr, \"\\\"]\")),\n      menuItem: menu.querySelector(\"[data-id=\\\"\".concat(id, \"\\\"]\"))\n    }; // Update Object, Menu and input fields\n\n    (0, _scriptActions.update_script)(scripts[id], {\n      attr: attr,\n      value: value\n    }, dest); // Set the editor to new Mode\n\n    if (attr === 'language') editor.setOption('mode', options.mode[scripts[id].language]); // Set the editor or file window\n\n    if (attr === 'type') document.querySelector('.savant-window').dataset['type'] = value; // Set file name under button\n\n    if (attr === 'file') {\n      document.querySelector('.file div span').textContent = (0, _utilities.getFileName)(value);\n    }\n  },\n  codeUpdate: function codeUpdate() {\n    var _this$activeScript = this.activeScript,\n        id = _this$activeScript.id,\n        codeOutput = _this$activeScript.codeOutput; // Get the editor input, update Object and output to <input> data inputFields\n\n    (0, _scriptActions.update_script)(scripts[id], {\n      attr: 'code',\n      value: editor.getValue()\n    }, {\n      input: codeOutput\n    });\n  },\n  newScript: function newScript(e) {\n    e.preventDefault();\n    var n = document.querySelector('div.savant-config'); // Get new data from input form\n\n    var language = n.querySelector('.language input:checked').value;\n    var label = n.querySelector('.label input').value || language.toUpperCase();\n    var type = n.querySelector('.type input:checked').value;\n    var id = (0, _utilities.uniqueID)(scripts); // Add new script to Scripts Object\n\n    var data = {\n      id: id,\n      language: language,\n      type: type,\n      label: label,\n      code: options.boilerplate[language],\n      file: ''\n    };\n    (0, _scriptActions.add_script)(scripts, data, this.elements); // Reset Menu Toggle Icon\n\n    this.toggleMenu(this.elements._svt.querySelector('i.icon.add-new')); // Reset fields\n\n    this.newSession(false); // Set new active script\n\n    this.setActiveScript(scripts[id].id);\n  },\n  toggleMenu: function toggleMenu(e) {\n    var element = e.target || e;\n    var target = element.getAttribute('menu-target');\n\n    this.elements._svt.querySelector(\".\".concat(target)).classList.toggle('expand');\n\n    element.classList.toggle('open');\n  },\n  toggleButtons: function toggleButtons() {\n    // Add Active class to button\n    var _iteratorNormalCompletion2 = true;\n    var _didIteratorError2 = false;\n    var _iteratorError2 = undefined;\n\n    try {\n      for (var _iterator2 = this.parentNode.children[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n        var btn = _step2.value;\n        btn.classList[this == btn ? 'add' : 'remove']('active');\n        btn.children[0].checked = this == btn ? true : false;\n      }\n    } catch (err) {\n      _didIteratorError2 = true;\n      _iteratorError2 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n          _iterator2.return();\n        }\n      } finally {\n        if (_didIteratorError2) {\n          throw _iteratorError2;\n        }\n      }\n    }\n  },\n  uploadFile: function uploadFile(e) {\n    var _this2 = this;\n\n    e.preventDefault();\n    var mediaUploader = (0, _utilities.uploader)();\n    var attachment;\n    mediaUploader.on('select', function () {\n      attachment = mediaUploader.state().get('selection').first().toJSON();\n\n      _this2.attrUpdate(e, {\n        attr: 'file',\n        value: attachment.url\n      });\n    });\n    mediaUploader.open();\n  }\n};\ncore.init();\n\n},{\"../../../codemirror/addon/mode/simple\":10,\"../../../codemirror/lib/codemirror\":11,\"../../../codemirror/mode/css/css\":12,\"../../../codemirror/mode/htmlmixed/htmlmixed\":13,\"../../../codemirror/mode/javascript/javascript\":14,\"../../../codemirror/mode/xml/xml\":15,\"./actions/scriptActions\":1,\"./modes/enhanced\":4,\"./modules/dataset\":5,\"./modules/utilities\":6}],4:[function(require,module,exports){\n\"use strict\";\n\nvar CodeMirror = require('../../../../codemirror/lib/codemirror');\n\nCodeMirror.defineSimpleMode('enhancedJS', {\n  // The start state contains the rules that are intially used\n  start: [// String\n  {\n    regex: /[\\'\"`](.*?)[\\'\"`]/,\n    token: 'string'\n  }, // Keywords\n  {\n    regex: /(?:function|var|do|this|const|let)\\b|=>/,\n    token: 'keyword'\n  }, {\n    regex: /(?:return|if|for|while|else)\\b|=>/,\n    token: 'keyword2'\n  }, // Atom\n  {\n    regex: /true|false|null|undefined/,\n    token: 'atom'\n  }, // Builtins\n  {\n    regex: /(?:Date|Math|Number|Object|Function|Boolean|Symbol|Error|EvalError|InternalError|RangeError|ReferenceError|SyntaxError|TypeError|URIError|String|RegExp|Array|Map|Set|WeakMap|WeakSet|JSON|console)\\b/,\n    token: 'object'\n  }, {\n    regex: /\\.|\\(|\\)/,\n    token: 'punctuation'\n  }, // Classes\n  {\n    regex: /(\\s)([A-Z]\\w*)/,\n    token: [null, 'class']\n  }, // Functions\n  {\n    regex: /(\\w*)\\b(?=\\()/,\n    token: 'function'\n  }, // Numbers\n  {\n    regex: /0x[a-f\\d]+|[-+]?(?:\\.\\d+|\\d+\\.?\\d*)(?:e[-+]?\\d+)?/i,\n    token: 'number'\n  }, // Properties\n  {\n    regex: /(\\w*)\\b(?=;|\\.|\\t|\\;|\\r|\\n|\\s|,|$|\\))/,\n    token: 'property'\n  }, {\n    regex: /\\/\\/.*/,\n    token: 'comment'\n  }, {\n    regex: /\\/(?:[^\\\\]|\\\\.)*?\\//,\n    token: 'variable-3'\n  }, // A next property will cause the mode to move to a different state\n  {\n    regex: /\\/\\*/,\n    token: 'comment',\n    next: 'comment'\n  }, {\n    regex: /[-+\\/*=<>!]+/,\n    token: 'operator'\n  }, // indent and dedent properties guide autoindentation\n  {\n    regex: /[\\{\\[\\(]/,\n    indent: true\n  }, {\n    regex: /[\\}\\]\\)]/,\n    dedent: true\n  }, {\n    regex: /[a-z$][\\w$]*/,\n    token: 'variable'\n  }],\n  comment: [{\n    regex: /.*?\\*\\//,\n    token: 'comment',\n    next: 'start'\n  }, {\n    regex: /.*/,\n    token: 'comment'\n  }],\n  meta: {\n    dontIndentStates: ['comment'],\n    lineComment: '//'\n  }\n});\n\n},{\"../../../../codemirror/lib/codemirror\":11}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Savant =\n/*#__PURE__*/\nfunction () {\n  function Savant() {\n    _classCallCheck(this, Savant);\n\n    // Get Scripts Object\n    this.scripts = this.getInitialScripts(); // Get Options Object\n\n    this.options = this.getOptions();\n  }\n\n  _createClass(Savant, [{\n    key: \"getInitialScripts\",\n    value: function getInitialScripts() {\n      var x = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = document.querySelectorAll('.savant-data input')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var input = _step.value;\n          var id = input.getAttribute('data-id');\n          var attr = input.getAttribute('data-attribute');\n          if (!x[id]) x[id] = {};\n          x[id][attr] = input.value;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return x;\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      var inputs = Array.from(document.querySelectorAll('.savant-options input'));\n      return inputs.reduce(function (acc, curr) {\n        var type = curr.dataset['attribute'];\n        var attr = curr.dataset['language'] || false;\n        if (!acc[type]) acc[type] = {};\n\n        if (attr) {\n          acc[type][attr] = curr.value;\n        } else {\n          acc[type] = curr.value;\n        }\n\n        return acc;\n      }, {});\n    }\n  }]);\n\n  return Savant;\n}();\n\nexports.default = Savant;\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploader = exports.getFileName = exports.getFirstScript = exports.uniqueID = exports.isEmpty = void 0;\n\nvar getUniqueID = function getUniqueID() {\n  return Math.floor(Math.random() * 9999999 + 1);\n};\n\nvar isEmpty = function isEmpty(obj) {\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) return false;\n  }\n\n  return true;\n};\n\nexports.isEmpty = isEmpty;\n\nvar uniqueID = function uniqueID(obj) {\n  var id = getUniqueID();\n  var unique = true;\n\n  var _arr = Object.keys(obj);\n\n  for (var _i = 0; _i < _arr.length; _i++) {\n    var num = _arr[_i];\n    if (id == num) unique = false;\n  }\n\n  if (!unique) {\n    uniqueID(obj);\n  } else {\n    return id;\n  }\n};\n\nexports.uniqueID = uniqueID;\n\nvar getFirstScript = function getFirstScript(obj) {\n  return Object.keys(obj)[0];\n};\n\nexports.getFirstScript = getFirstScript;\n\nvar getFileName = function getFileName(str) {\n  return str.replace(/(.*)wp-content/g, '....');\n};\n\nexports.getFileName = getFileName;\n\nvar uploader = function uploader() {\n  var mediaUploader;\n  mediaUploader = wp.media.frames.file_frame = wp.media({\n    title: 'Choose a File',\n    button: {\n      text: 'Choose File'\n    },\n    multiple: false\n  });\n  return mediaUploader;\n};\n\nexports.uploader = uploader;\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _default = function _default(action) {\n  switch (action.type) {\n    case 'ADD_SCRIPT':\n      var data = action.data,\n          scripts = action.scripts;\n      scripts[data.id] = data;\n      return scripts[data.id];\n\n    case 'UPDATE_SCRIPT':\n      var script = action.script;\n      var _action$data = action.data,\n          attr = _action$data.attr,\n          value = _action$data.value;\n      script[attr] = value;\n      return script[attr];\n\n    case 'DELETE_SCRIPT':\n      var id = action.id;\n      delete action.scripts[id];\n      break;\n\n    default:\n      return;\n  }\n};\n\nexports.default = _default;\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _default = function _default(action) {\n  switch (action.type) {\n    case 'ADD_SCRIPT':\n      var _action$data = action.data,\n          id = _action$data.id,\n          language = _action$data.language,\n          label = _action$data.label;\n      var node = document.createElement('li');\n      node.dataset['attribute'] = language;\n      node.dataset['id'] = id;\n      node.classList.add('button-language');\n      node.textContent = label;\n      action.dest.appendChild(node);\n      break;\n\n    case 'UPDATE_SCRIPT':\n      var attr = action.attr,\n          value = action.value,\n          dest = action.dest;\n\n      if (attr === 'label') {\n        dest.textContent = value;\n      } else if (attr === 'language') {\n        dest.dataset['attribute'] = value;\n      }\n\n      break;\n\n    case 'DELETE_SCRIPT':\n      action.menuItem.remove();\n      break;\n\n    default:\n      return;\n  }\n};\n\nexports.default = _default;\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar _default = function _default(action) {\n  switch (action.type) {\n    case 'DELETE_SCRIPT':\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = action.inputs[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var input = _step.value;\n          input.remove();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      break;\n\n    case 'ADD_SCRIPT':\n      var id = action.data.id;\n\n      var _arr = Object.entries(action.data);\n\n      for (var _i = 0; _i < _arr.length; _i++) {\n        var _arr$_i = _slicedToArray(_arr[_i], 2),\n            key = _arr$_i[0],\n            _value = _arr$_i[1];\n\n        var node = document.createElement('input');\n        node.dataset['attribute'] = key;\n        node.dataset['id'] = id;\n        node.name = \"savant_field[\".concat(id, \"][\").concat(key, \"]\");\n        node.type = 'hidden';\n        node.value = _value;\n        action.dest.appendChild(node);\n      }\n\n      break;\n\n    case 'UPDATE_SCRIPT':\n      var dest = action.dest,\n          value = action.value;\n      dest.value = value;\n      break;\n\n    default:\n      return;\n  }\n};\n\nexports.default = _default;\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) == \"object\" && (typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineSimpleMode = function (name, states) {\n    CodeMirror.defineMode(name, function (config) {\n      return CodeMirror.simpleMode(config, states);\n    });\n  };\n\n  CodeMirror.simpleMode = function (config, states) {\n    ensureState(states, \"start\");\n    var states_ = {},\n        meta = states.meta || {},\n        hasIndentation = false;\n\n    for (var state in states) {\n      if (state != meta && states.hasOwnProperty(state)) {\n        var list = states_[state] = [],\n            orig = states[state];\n\n        for (var i = 0; i < orig.length; i++) {\n          var data = orig[i];\n          list.push(new Rule(data, states));\n          if (data.indent || data.dedent) hasIndentation = true;\n        }\n      }\n    }\n\n    var mode = {\n      startState: function startState() {\n        return {\n          state: \"start\",\n          pending: null,\n          local: null,\n          localState: null,\n          indent: hasIndentation ? [] : null\n        };\n      },\n      copyState: function copyState(state) {\n        var s = {\n          state: state.state,\n          pending: state.pending,\n          local: state.local,\n          localState: null,\n          indent: state.indent && state.indent.slice(0)\n        };\n        if (state.localState) s.localState = CodeMirror.copyState(state.local.mode, state.localState);\n        if (state.stack) s.stack = state.stack.slice(0);\n\n        for (var pers = state.persistentStates; pers; pers = pers.next) {\n          s.persistentStates = {\n            mode: pers.mode,\n            spec: pers.spec,\n            state: pers.state == state.localState ? s.localState : CodeMirror.copyState(pers.mode, pers.state),\n            next: s.persistentStates\n          };\n        }\n\n        return s;\n      },\n      token: tokenFunction(states_, config),\n      innerMode: function innerMode(state) {\n        return state.local && {\n          mode: state.local.mode,\n          state: state.localState\n        };\n      },\n      indent: indentFunction(states_, meta)\n    };\n    if (meta) for (var prop in meta) {\n      if (meta.hasOwnProperty(prop)) mode[prop] = meta[prop];\n    }\n    return mode;\n  };\n\n  function ensureState(states, name) {\n    if (!states.hasOwnProperty(name)) throw new Error(\"Undefined state \" + name + \" in simple mode\");\n  }\n\n  function toRegex(val, caret) {\n    if (!val) return /(?:)/;\n    var flags = \"\";\n\n    if (val instanceof RegExp) {\n      if (val.ignoreCase) flags = \"i\";\n      val = val.source;\n    } else {\n      val = String(val);\n    }\n\n    return new RegExp((caret === false ? \"\" : \"^\") + \"(?:\" + val + \")\", flags);\n  }\n\n  function asToken(val) {\n    if (!val) return null;\n    if (val.apply) return val;\n    if (typeof val == \"string\") return val.replace(/\\./g, \" \");\n    var result = [];\n\n    for (var i = 0; i < val.length; i++) {\n      result.push(val[i] && val[i].replace(/\\./g, \" \"));\n    }\n\n    return result;\n  }\n\n  function Rule(data, states) {\n    if (data.next || data.push) ensureState(states, data.next || data.push);\n    this.regex = toRegex(data.regex);\n    this.token = asToken(data.token);\n    this.data = data;\n  }\n\n  function tokenFunction(states, config) {\n    return function (stream, state) {\n      if (state.pending) {\n        var pend = state.pending.shift();\n        if (state.pending.length == 0) state.pending = null;\n        stream.pos += pend.text.length;\n        return pend.token;\n      }\n\n      if (state.local) {\n        if (state.local.end && stream.match(state.local.end)) {\n          var tok = state.local.endToken || null;\n          state.local = state.localState = null;\n          return tok;\n        } else {\n          var tok = state.local.mode.token(stream, state.localState),\n              m;\n          if (state.local.endScan && (m = state.local.endScan.exec(stream.current()))) stream.pos = stream.start + m.index;\n          return tok;\n        }\n      }\n\n      var curState = states[state.state];\n\n      for (var i = 0; i < curState.length; i++) {\n        var rule = curState[i];\n        var matches = (!rule.data.sol || stream.sol()) && stream.match(rule.regex);\n\n        if (matches) {\n          if (rule.data.next) {\n            state.state = rule.data.next;\n          } else if (rule.data.push) {\n            (state.stack || (state.stack = [])).push(state.state);\n            state.state = rule.data.push;\n          } else if (rule.data.pop && state.stack && state.stack.length) {\n            state.state = state.stack.pop();\n          }\n\n          if (rule.data.mode) enterLocalMode(config, state, rule.data.mode, rule.token);\n          if (rule.data.indent) state.indent.push(stream.indentation() + config.indentUnit);\n          if (rule.data.dedent) state.indent.pop();\n          var token = rule.token;\n          if (token && token.apply) token = token(matches);\n\n          if (matches.length > 2 && rule.token && typeof rule.token != \"string\") {\n            state.pending = [];\n\n            for (var j = 2; j < matches.length; j++) {\n              if (matches[j]) state.pending.push({\n                text: matches[j],\n                token: rule.token[j - 1]\n              });\n            }\n\n            stream.backUp(matches[0].length - (matches[1] ? matches[1].length : 0));\n            return token[0];\n          } else if (token && token.join) {\n            return token[0];\n          } else {\n            return token;\n          }\n        }\n      }\n\n      stream.next();\n      return null;\n    };\n  }\n\n  function cmp(a, b) {\n    if (a === b) return true;\n    if (!a || _typeof(a) != \"object\" || !b || _typeof(b) != \"object\") return false;\n    var props = 0;\n\n    for (var prop in a) {\n      if (a.hasOwnProperty(prop)) {\n        if (!b.hasOwnProperty(prop) || !cmp(a[prop], b[prop])) return false;\n        props++;\n      }\n    }\n\n    for (var prop in b) {\n      if (b.hasOwnProperty(prop)) props--;\n    }\n\n    return props == 0;\n  }\n\n  function enterLocalMode(config, state, spec, token) {\n    var pers;\n    if (spec.persistent) for (var p = state.persistentStates; p && !pers; p = p.next) {\n      if (spec.spec ? cmp(spec.spec, p.spec) : spec.mode == p.mode) pers = p;\n    }\n    var mode = pers ? pers.mode : spec.mode || CodeMirror.getMode(config, spec.spec);\n    var lState = pers ? pers.state : CodeMirror.startState(mode);\n    if (spec.persistent && !pers) state.persistentStates = {\n      mode: mode,\n      spec: spec.spec,\n      state: lState,\n      next: state.persistentStates\n    };\n    state.localState = lState;\n    state.local = {\n      mode: mode,\n      end: spec.end && toRegex(spec.end),\n      endScan: spec.end && spec.forceEnd !== false && toRegex(spec.end, false),\n      endToken: token && token.join ? token[token.length - 1] : token\n    };\n  }\n\n  function indexOf(val, arr) {\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i] === val) return true;\n    }\n  }\n\n  function indentFunction(states, meta) {\n    return function (state, textAfter, line) {\n      if (state.local && state.local.mode.indent) return state.local.mode.indent(state.localState, textAfter, line);\n      if (state.indent == null || state.local || meta.dontIndentStates && indexOf(state.state, meta.dontIndentStates) > -1) return CodeMirror.Pass;\n      var pos = state.indent.length - 1,\n          rules = states[state.state];\n\n      scan: for (;;) {\n        for (var i = 0; i < rules.length; i++) {\n          var rule = rules[i];\n\n          if (rule.data.dedent && rule.data.dedentIfLineStart !== false) {\n            var m = rule.regex.exec(textAfter);\n\n            if (m && m[0]) {\n              pos--;\n              if (rule.next || rule.push) rules = states[rule.next || rule.push];\n              textAfter = textAfter.slice(m[0].length);\n              continue scan;\n            }\n          }\n        }\n\n        break;\n      }\n\n      return pos < 0 ? 0 : state.indent[pos];\n    };\n  }\n});\n\n},{\"../../lib/codemirror\":11}],11:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n(function (global, factory) {\n  (typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.CodeMirror = factory();\n})(void 0, function () {\n  'use strict'; // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent); // This is woefully incomplete. Suggestions for alternative methods welcome.\n\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n\n  if (presto_version) {\n    presto_version = Number(presto_version[1]);\n  }\n\n  if (presto_version && presto_version >= 15) {\n    presto = false;\n    webkit = true;\n  } // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n\n\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || ie && ie_version >= 9;\n\n  function classTest(cls) {\n    return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\");\n  }\n\n  var rmClass = function rmClass(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count) {\n      e.removeChild(e.firstChild);\n    }\n\n    return e;\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e);\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n\n    if (className) {\n      e.className = className;\n    }\n\n    if (style) {\n      e.style.cssText = style;\n    }\n\n    if (typeof content == \"string\") {\n      e.appendChild(document.createTextNode(content));\n    } else if (content) {\n      for (var i = 0; i < content.length; ++i) {\n        e.appendChild(content[i]);\n      }\n    }\n\n    return e;\n  } // wrapper for elt, which removes the elt from the accessibility tree\n\n\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e;\n  }\n\n  var range;\n\n  if (document.createRange) {\n    range = function range(node, start, end, endNode) {\n      var r = document.createRange();\n      r.setEnd(endNode || node, end);\n      r.setStart(node, start);\n      return r;\n    };\n  } else {\n    range = function range(node, start, end) {\n      var r = document.body.createTextRange();\n\n      try {\n        r.moveToElementText(node.parentNode);\n      } catch (e) {\n        return r;\n      }\n\n      r.collapse(true);\n      r.moveEnd(\"character\", end);\n      r.moveStart(\"character\", start);\n      return r;\n    };\n  }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      {\n        child = child.parentNode;\n      }\n\n    if (parent.contains) {\n      return parent.contains(child);\n    }\n\n    do {\n      if (child.nodeType == 11) {\n        child = child.host;\n      }\n\n      if (child == parent) {\n        return true;\n      }\n    } while (child = child.parentNode);\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n\n    try {\n      activeElement = document.activeElement;\n    } catch (e) {\n      activeElement = document.body || null;\n    }\n\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement) {\n      activeElement = activeElement.shadowRoot.activeElement;\n    }\n\n    return activeElement;\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n\n    if (!classTest(cls).test(current)) {\n      node.className += (current ? \" \" : \"\") + cls;\n    }\n  }\n\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n\n    for (var i = 0; i < as.length; i++) {\n      if (as[i] && !classTest(as[i]).test(b)) {\n        b += \" \" + as[i];\n      }\n    }\n\n    return b;\n  }\n\n  var selectInput = function selectInput(node) {\n    node.select();\n  };\n\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    {\n      selectInput = function selectInput(node) {\n        node.selectionStart = 0;\n        node.selectionEnd = node.value.length;\n      };\n    } else if (ie) // Suppress mysterious IE10 errors\n    {\n      selectInput = function selectInput(node) {\n        try {\n          node.select();\n        } catch (_e) {}\n      };\n    }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function () {\n      return f.apply(null, args);\n    };\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) {\n      target = {};\n    }\n\n    for (var prop in obj) {\n      if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop))) {\n        target[prop] = obj[prop];\n      }\n    }\n\n    return target;\n  } // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n\n\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n\n      if (end == -1) {\n        end = string.length;\n      }\n    }\n\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n\n      if (nextTab < 0 || nextTab >= end) {\n        return n + (end - i);\n      }\n\n      n += nextTab - i;\n      n += tabSize - n % tabSize;\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function Delayed() {\n    this.id = null;\n  };\n\n  Delayed.prototype.set = function (ms, f) {\n    clearTimeout(this.id);\n    this.id = setTimeout(f, ms);\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i) {\n      if (array[i] == elt) {\n        return i;\n      }\n    }\n\n    return -1;\n  } // Number of pixels added to scroller and sizer to hide scrollbar\n\n\n  var scrollerGap = 30; // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n\n  var Pass = {\n    toString: function toString() {\n      return \"CodeMirror.Pass\";\n    } // Reused option objects for setSelection & friends\n\n  };\n  var sel_dontScroll = {\n    scroll: false\n  };\n  var sel_mouse = {\n    origin: \"*mouse\"\n  };\n  var sel_move = {\n    origin: \"+move\"\n  }; // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n\n      if (nextTab == -1) {\n        nextTab = string.length;\n      }\n\n      var skipped = nextTab - pos;\n\n      if (nextTab == string.length || col + skipped >= goal) {\n        return pos + Math.min(skipped, goal - col);\n      }\n\n      col += nextTab - pos;\n      col += tabSize - col % tabSize;\n      pos = nextTab + 1;\n\n      if (col >= goal) {\n        return pos;\n      }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n\n  function spaceStr(n) {\n    while (spaceStrs.length <= n) {\n      spaceStrs.push(lst(spaceStrs) + \" \");\n    }\n\n    return spaceStrs[n];\n  }\n\n  function lst(arr) {\n    return arr[arr.length - 1];\n  }\n\n  function map(array, f) {\n    var out = [];\n\n    for (var i = 0; i < array.length; i++) {\n      out[i] = f(array[i], i);\n    }\n\n    return out;\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0,\n        priority = score(value);\n\n    while (pos < array.length && score(array[pos]) <= priority) {\n      pos++;\n    }\n\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n\n    if (props) {\n      copyObj(props, inst);\n    }\n\n    return inst;\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" && (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch));\n  }\n\n  function isWordChar(ch, helper) {\n    if (!helper) {\n      return isWordCharBasic(ch);\n    }\n\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) {\n      return true;\n    }\n\n    return helper.test(ch);\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) {\n      if (obj.hasOwnProperty(n) && obj[n]) {\n        return false;\n      }\n    }\n\n    return true;\n  } // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n\n\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n\n  function isExtendingChar(ch) {\n    return ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n  } // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n\n\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) {\n      pos += dir;\n    }\n\n    return pos;\n  } // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n\n\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n\n    for (;;) {\n      if (from == to) {\n        return from;\n      }\n\n      var midF = (from + to) / 2,\n          mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n\n      if (mid == from) {\n        return pred(mid) ? from : to;\n      }\n\n      if (pred(mid)) {\n        to = mid;\n      } else {\n        from = mid + dir;\n      }\n    }\n  } // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n\n  function Display(place, doc, input) {\n    var d = this;\n    this.input = input; // Covers bottom-right square when both scrollbars are present.\n\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\"); // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\"); // Will contain the actual code, positioned to cover the viewport.\n\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\"); // Elements are added to these to represent selection and cursors.\n\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\"); // A visibility: hidden element used to find the size of things.\n\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\"); // When lines outside of the viewport are measured, they are drawn in this.\n\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\"); // Wraps everything that needs to exist inside the vertically-padded coordinate system\n\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv], null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\"); // Moved around its parent to cover visible view.\n\n    d.mover = elt(\"div\", [lines], null, \"position: relative\"); // Set to the height of the document, allowing scrolling.\n\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null; // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\"); // Will contain the gutters, if any.\n\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null; // Actual scrollable element.\n\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\"); // The element in which the editor lives.\n\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\"); // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n\n    if (ie && ie_version < 8) {\n      d.gutters.style.zIndex = -1;\n      d.scroller.style.paddingRight = 0;\n    }\n\n    if (!webkit && !(gecko && mobile)) {\n      d.scroller.draggable = true;\n    }\n\n    if (place) {\n      if (place.appendChild) {\n        place.appendChild(d.wrapper);\n      } else {\n        place(d.wrapper);\n      }\n    } // Current rendered range (may be bigger than the view window).\n\n\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first; // Information about the rendered lines.\n\n    d.view = [];\n    d.renderedView = null; // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n\n    d.externalMeasured = null; // Empty space (in pixels) above the view\n\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false; // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null; // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n\n    d.alignWidgets = false;\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null; // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false; // Used for measuring wheel scrolling granularity\n\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null; // True when shift is held down.\n\n    d.shift = false; // Used to track whether anything happened since the context menu\n    // was opened.\n\n    d.selForContextMenu = null;\n    d.activeTouch = null;\n    input.init(d);\n  } // Find the line object corresponding to the given line number.\n\n\n  function getLine(doc, n) {\n    n -= doc.first;\n\n    if (n < 0 || n >= doc.size) {\n      throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\");\n    }\n\n    var chunk = doc;\n\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i],\n            sz = child.chunkSize();\n\n        if (n < sz) {\n          chunk = child;\n          break;\n        }\n\n        n -= sz;\n      }\n    }\n\n    return chunk.lines[n];\n  } // Get the part of a document between two positions, as an array of\n  // strings.\n\n\n  function getBetween(doc, start, end) {\n    var out = [],\n        n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n\n      if (n == end.line) {\n        text = text.slice(0, end.ch);\n      }\n\n      if (n == start.line) {\n        text = text.slice(start.ch);\n      }\n\n      out.push(text);\n      ++n;\n    });\n    return out;\n  } // Get the lines between from and to, as array of strings.\n\n\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) {\n      out.push(line.text);\n    }); // iter aborts when callback returns truthy value\n\n    return out;\n  } // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n\n\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n\n    if (diff) {\n      for (var n = line; n; n = n.parent) {\n        n.height += diff;\n      }\n    }\n  } // Given a line object, find its line number by walking up through\n  // its parent links.\n\n\n  function lineNo(line) {\n    if (line.parent == null) {\n      return null;\n    }\n\n    var cur = line.parent,\n        no = indexOf(cur.lines, line);\n\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) {\n          break;\n        }\n\n        no += chunk.children[i].chunkSize();\n      }\n    }\n\n    return no + cur.first;\n  } // Find the line at the given vertical position, using the height\n  // information in the document tree.\n\n\n  function _lineAtHeight(chunk, h) {\n    var n = chunk.first;\n\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1],\n            ch = child.height;\n\n        if (h < ch) {\n          chunk = child;\n          continue outer;\n        }\n\n        h -= ch;\n        n += child.chunkSize();\n      }\n\n      return n;\n    } while (!chunk.lines);\n\n    var i = 0;\n\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i],\n          lh = line.height;\n\n      if (h < lh) {\n        break;\n      }\n\n      h -= lh;\n    }\n\n    return n + i;\n  }\n\n  function isLine(doc, l) {\n    return l >= doc.first && l < doc.first + doc.size;\n  }\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber));\n  } // A Pos instance represents a position within the text.\n\n\n  function Pos(line, ch, sticky) {\n    if (sticky === void 0) sticky = null;\n\n    if (!(this instanceof Pos)) {\n      return new Pos(line, ch, sticky);\n    }\n\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  } // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n\n\n  function cmp(a, b) {\n    return a.line - b.line || a.ch - b.ch;\n  }\n\n  function equalCursorPos(a, b) {\n    return a.sticky == b.sticky && cmp(a, b) == 0;\n  }\n\n  function copyPos(x) {\n    return Pos(x.line, x.ch);\n  }\n\n  function maxPos(a, b) {\n    return cmp(a, b) < 0 ? b : a;\n  }\n\n  function minPos(a, b) {\n    return cmp(a, b) < 0 ? a : b;\n  } // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n\n\n  function clipLine(doc, n) {\n    return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));\n  }\n\n  function _clipPos(doc, pos) {\n    if (pos.line < doc.first) {\n      return Pos(doc.first, 0);\n    }\n\n    var last = doc.first + doc.size - 1;\n\n    if (pos.line > last) {\n      return Pos(last, getLine(doc, last).text.length);\n    }\n\n    return clipToLen(pos, getLine(doc, pos.line).text.length);\n  }\n\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n\n    if (ch == null || ch > linelen) {\n      return Pos(pos.line, linelen);\n    } else if (ch < 0) {\n      return Pos(pos.line, 0);\n    } else {\n      return pos;\n    }\n  }\n\n  function clipPosArray(doc, array) {\n    var out = [];\n\n    for (var i = 0; i < array.length; i++) {\n      out[i] = _clipPos(doc, array[i]);\n    }\n\n    return out;\n  } // Optimize some code when these features are not used.\n\n\n  var sawReadOnlySpans = false;\n  var sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  } // TEXTMARKER SPANS\n\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from;\n    this.to = to;\n  } // Search an array of spans for a span matching the given marker.\n\n\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) {\n      for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n\n        if (span.marker == marker) {\n          return span;\n        }\n      }\n    }\n  } // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n\n\n  function removeMarkedSpan(spans, span) {\n    var r;\n\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i] != span) {\n        (r || (r = [])).push(spans[i]);\n      }\n    }\n\n    return r;\n  } // Add a span to a line.\n\n\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  } // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n\n\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n\n    if (old) {\n      for (var i = 0; i < old.length; ++i) {\n        var span = old[i],\n            marker = span.marker;\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n\n        if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n          var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);\n          (nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n        }\n      }\n    }\n\n    return nw;\n  }\n\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n\n    if (old) {\n      for (var i = 0; i < old.length; ++i) {\n        var span = old[i],\n            marker = span.marker;\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n\n        if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n          var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);\n          (nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh, span.to == null ? null : span.to - endCh));\n        }\n      }\n    }\n\n    return nw;\n  } // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n\n\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) {\n      return null;\n    }\n\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n\n    if (!oldFirst && !oldLast) {\n      return null;\n    }\n\n    var startCh = change.from.ch,\n        endCh = change.to.ch,\n        isInsert = cmp(change.from, change.to) == 0; // Get the spans that 'stick out' on both sides\n\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert); // Next, merge those two ends\n\n    var sameLine = change.text.length == 1,\n        offset = lst(change.text).length + (sameLine ? startCh : 0);\n\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n\n          if (!found) {\n            span.to = startCh;\n          } else if (sameLine) {\n            span.to = found.to == null ? null : found.to + offset;\n          }\n        }\n      }\n    }\n\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n\n        if (span$1.to != null) {\n          span$1.to += offset;\n        }\n\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n\n          if (!found$1) {\n            span$1.from = offset;\n\n            if (sameLine) {\n              (first || (first = [])).push(span$1);\n            }\n          }\n        } else {\n          span$1.from += offset;\n\n          if (sameLine) {\n            (first || (first = [])).push(span$1);\n          }\n        }\n      }\n    } // Make sure we didn't create any zero-length spans\n\n\n    if (first) {\n      first = clearEmptySpans(first);\n    }\n\n    if (last && last != first) {\n      last = clearEmptySpans(last);\n    }\n\n    var newMarkers = [first];\n\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2,\n          gapMarkers;\n\n      if (gap > 0 && first) {\n        for (var i$2 = 0; i$2 < first.length; ++i$2) {\n          if (first[i$2].to == null) {\n            (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null));\n          }\n        }\n      }\n\n      for (var i$3 = 0; i$3 < gap; ++i$3) {\n        newMarkers.push(gapMarkers);\n      }\n\n      newMarkers.push(last);\n    }\n\n    return newMarkers;\n  } // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n\n\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false) {\n        spans.splice(i--, 1);\n      }\n    }\n\n    if (!spans.length) {\n      return null;\n    }\n\n    return spans;\n  } // Used to 'clip' out readOnly ranges when making a change.\n\n\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) {\n        for (var i = 0; i < line.markedSpans.length; ++i) {\n          var mark = line.markedSpans[i].marker;\n\n          if (mark.readOnly && (!markers || indexOf(markers, mark) == -1)) {\n            (markers || (markers = [])).push(mark);\n          }\n        }\n      }\n    });\n\n    if (!markers) {\n      return null;\n    }\n\n    var parts = [{\n      from: from,\n      to: to\n    }];\n\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i],\n          m = mk.find(0);\n\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) {\n          continue;\n        }\n\n        var newParts = [j, 1],\n            dfrom = cmp(p.from, m.from),\n            dto = cmp(p.to, m.to);\n\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom) {\n          newParts.push({\n            from: p.from,\n            to: m.from\n          });\n        }\n\n        if (dto > 0 || !mk.inclusiveRight && !dto) {\n          newParts.push({\n            from: m.to,\n            to: p.to\n          });\n        }\n\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n\n    return parts;\n  } // Connect or disconnect spans from a line.\n\n\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n\n    if (!spans) {\n      return;\n    }\n\n    for (var i = 0; i < spans.length; ++i) {\n      spans[i].marker.detachLine(line);\n    }\n\n    line.markedSpans = null;\n  }\n\n  function attachMarkedSpans(line, spans) {\n    if (!spans) {\n      return;\n    }\n\n    for (var i = 0; i < spans.length; ++i) {\n      spans[i].marker.attachLine(line);\n    }\n\n    line.markedSpans = spans;\n  } // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n\n\n  function extraLeft(marker) {\n    return marker.inclusiveLeft ? -1 : 0;\n  }\n\n  function extraRight(marker) {\n    return marker.inclusiveRight ? 1 : 0;\n  } // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n\n\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n\n    if (lenDiff != 0) {\n      return lenDiff;\n    }\n\n    var aPos = a.find(),\n        bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n\n    if (fromCmp) {\n      return -fromCmp;\n    }\n\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n\n    if (toCmp) {\n      return toCmp;\n    }\n\n    return b.id - a.id;\n  } // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n\n\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans,\n        found;\n\n    if (sps) {\n      for (var sp = void 0, i = 0; i < sps.length; ++i) {\n        sp = sps[i];\n\n        if (sp.marker.collapsed && (start ? sp.from : sp.to) == null && (!found || compareCollapsedMarkers(found, sp.marker) < 0)) {\n          found = sp.marker;\n        }\n      }\n    }\n\n    return found;\n  }\n\n  function collapsedSpanAtStart(line) {\n    return collapsedSpanAtSide(line, true);\n  }\n\n  function collapsedSpanAtEnd(line) {\n    return collapsedSpanAtSide(line, false);\n  }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans,\n        found;\n\n    if (sps) {\n      for (var i = 0; i < sps.length; ++i) {\n        var sp = sps[i];\n\n        if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) && (!found || compareCollapsedMarkers(found, sp.marker) < 0)) {\n          found = sp.marker;\n        }\n      }\n    }\n\n    return found;\n  } // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n\n\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n\n    if (sps) {\n      for (var i = 0; i < sps.length; ++i) {\n        var sp = sps[i];\n\n        if (!sp.marker.collapsed) {\n          continue;\n        }\n\n        var found = sp.marker.find(0);\n        var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n        var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n\n        if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) {\n          continue;\n        }\n\n        if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) || fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0)) {\n          return true;\n        }\n      }\n    }\n  } // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n\n\n  function visualLine(line) {\n    var merged;\n\n    while (merged = collapsedSpanAtStart(line)) {\n      line = merged.find(-1, true).line;\n    }\n\n    return line;\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n    }\n\n    return line;\n  } // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n\n\n  function visualLineContinued(line) {\n    var merged, lines;\n\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n      (lines || (lines = [])).push(line);\n    }\n\n    return lines;\n  } // Get the line number of the start of the visual line that the\n  // given line number is part of.\n\n\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN),\n        vis = visualLine(line);\n\n    if (line == vis) {\n      return lineN;\n    }\n\n    return lineNo(vis);\n  } // Get the line number of the start of the next visual line after\n  // the given line.\n\n\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) {\n      return lineN;\n    }\n\n    var line = getLine(doc, lineN),\n        merged;\n\n    if (!lineIsHidden(doc, line)) {\n      return lineN;\n    }\n\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n    }\n\n    return lineNo(line) + 1;\n  } // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n\n\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n\n    if (sps) {\n      for (var sp = void 0, i = 0; i < sps.length; ++i) {\n        sp = sps[i];\n\n        if (!sp.marker.collapsed) {\n          continue;\n        }\n\n        if (sp.from == null) {\n          return true;\n        }\n\n        if (sp.marker.widgetNode) {\n          continue;\n        }\n\n        if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker));\n    }\n\n    if (span.marker.inclusiveRight && span.to == line.text.length) {\n      return true;\n    }\n\n    for (var sp = void 0, i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to && (sp.to == null || sp.to != span.from) && (sp.marker.inclusiveLeft || span.marker.inclusiveRight) && lineIsHiddenInner(doc, line, sp)) {\n        return true;\n      }\n    }\n  } // Find the height above the given line.\n\n\n  function _heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n    var h = 0,\n        chunk = lineObj.parent;\n\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n\n      if (line == lineObj) {\n        break;\n      } else {\n        h += line.height;\n      }\n    }\n\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n\n        if (cur == chunk) {\n          break;\n        } else {\n          h += cur.height;\n        }\n      }\n    }\n\n    return h;\n  } // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n\n\n  function lineLength(line) {\n    if (line.height == 0) {\n      return 0;\n    }\n\n    var len = line.text.length,\n        merged,\n        cur = line;\n\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n\n    cur = line;\n\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n\n    return len;\n  } // Find the longest line in the document.\n\n\n  function findMaxLine(cm) {\n    var d = cm.display,\n        doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  } // BIDI HELPERS\n\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) {\n      return f(from, to, \"ltr\", 0);\n    }\n\n    var found = false;\n\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n\n    if (!found) {\n      f(from, to, \"ltr\");\n    }\n  }\n\n  var bidiOther = null;\n\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n\n      if (cur.from < ch && cur.to > ch) {\n        return i;\n      }\n\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") {\n          found = i;\n        } else {\n          bidiOther = i;\n        }\n      }\n\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") {\n          found = i;\n        } else {\n          bidiOther = i;\n        }\n      }\n    }\n\n    return found != null ? found : bidiOther;\n  } // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n\n\n  var bidiOrdering = function () {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\"; // Character types for codepoints 0x600 to 0x6f9\n\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n\n    function charType(code) {\n      if (code <= 0xf7) {\n        return lowTypes.charAt(code);\n      } else if (0x590 <= code && code <= 0x5f4) {\n        return \"R\";\n      } else if (0x600 <= code && code <= 0x6f9) {\n        return arabicTypes.charAt(code - 0x600);\n      } else if (0x6ee <= code && code <= 0x8ac) {\n        return \"r\";\n      } else if (0x2000 <= code && code <= 0x200b) {\n        return \"w\";\n      } else if (code == 0x200c) {\n        return \"b\";\n      } else {\n        return \"L\";\n      }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/,\n        isStrong = /[LRr]/,\n        countsAsLeft = /[Lb1n]/,\n        countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from;\n      this.to = to;\n    }\n\n    return function (str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) {\n        return false;\n      }\n\n      var len = str.length,\n          types = [];\n\n      for (var i = 0; i < len; ++i) {\n        types.push(charType(str.charCodeAt(i)));\n      } // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n\n\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n\n        if (type == \"m\") {\n          types[i$1] = prev;\n        } else {\n          prev = type;\n        }\n      } // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n\n\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n\n        if (type$1 == \"1\" && cur == \"r\") {\n          types[i$2] = \"n\";\n        } else if (isStrong.test(type$1)) {\n          cur = type$1;\n\n          if (type$1 == \"r\") {\n            types[i$2] = \"R\";\n          }\n        }\n      } // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n\n\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3 + 1] == \"1\") {\n          types[i$3] = \"1\";\n        } else if (type$2 == \",\" && prev$1 == types[i$3 + 1] && (prev$1 == \"1\" || prev$1 == \"n\")) {\n          types[i$3] = prev$1;\n        }\n\n        prev$1 = type$2;\n      } // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n\n\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n\n        if (type$3 == \",\") {\n          types[i$4] = \"N\";\n        } else if (type$3 == \"%\") {\n          var end = void 0;\n\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n\n          var replace = i$4 && types[i$4 - 1] == \"!\" || end < len && types[end] == \"1\" ? \"1\" : \"N\";\n\n          for (var j = i$4; j < end; ++j) {\n            types[j] = replace;\n          }\n\n          i$4 = end - 1;\n        }\n      } // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n\n\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n\n        if (cur$1 == \"L\" && type$4 == \"1\") {\n          types[i$5] = \"L\";\n        } else if (isStrong.test(type$4)) {\n          cur$1 = type$4;\n        }\n      } // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n\n\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = void 0;\n\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n\n          var before = (i$6 ? types[i$6 - 1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? before ? \"L\" : \"R\" : outerType;\n\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) {\n            types[j$1] = replace$1;\n          }\n\n          i$6 = end$1 - 1;\n        }\n      } // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n\n\n      var order = [],\n          m;\n\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7,\n              at = order.length;\n\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) {\n                order.splice(at, 0, new BidiSpan(1, pos, j$2));\n              }\n\n              var nstart = j$2;\n\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              pos = j$2;\n            } else {\n              ++j$2;\n            }\n          }\n\n          if (pos < i$7) {\n            order.splice(at, 0, new BidiSpan(1, pos, i$7));\n          }\n        }\n      }\n\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order;\n    };\n  }(); // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n\n\n  function getOrder(line, direction) {\n    var order = line.order;\n\n    if (order == null) {\n      order = line.order = bidiOrdering(line.text, direction);\n    }\n\n    return order;\n  } // EVENT HANDLING\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n\n  var noHandlers = [];\n\n  var on = function on(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers;\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers,\n          arr = map && map[type];\n\n      if (arr) {\n        var index = indexOf(arr, f);\n\n        if (index > -1) {\n          map[type] = arr.slice(0, index).concat(arr.slice(index + 1));\n        }\n      }\n    }\n  }\n\n  function signal(emitter, type\n  /*, values...*/\n  ) {\n    var handlers = getHandlers(emitter, type);\n\n    if (!handlers.length) {\n      return;\n    }\n\n    var args = Array.prototype.slice.call(arguments, 2);\n\n    for (var i = 0; i < handlers.length; ++i) {\n      handlers[i].apply(null, args);\n    }\n  } // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n\n\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\") {\n      e = {\n        type: e,\n        preventDefault: function preventDefault() {\n          this.defaultPrevented = true;\n        }\n      };\n    }\n\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore;\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n\n    if (!arr) {\n      return;\n    }\n\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n\n    for (var i = 0; i < arr.length; ++i) {\n      if (indexOf(set, arr[i]) == -1) {\n        set.push(arr[i]);\n      }\n    }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0;\n  } // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n\n\n  function eventMixin(ctor) {\n    ctor.prototype.on = function (type, f) {\n      on(this, type, f);\n    };\n\n    ctor.prototype.off = function (type, f) {\n      off(this, type, f);\n    };\n  } // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) {\n      e.preventDefault();\n    } else {\n      e.returnValue = false;\n    }\n  }\n\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) {\n      e.stopPropagation();\n    } else {\n      e.cancelBubble = true;\n    }\n  }\n\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n  }\n\n  function e_stop(e) {\n    e_preventDefault(e);\n    e_stopPropagation(e);\n  }\n\n  function e_target(e) {\n    return e.target || e.srcElement;\n  }\n\n  function e_button(e) {\n    var b = e.which;\n\n    if (b == null) {\n      if (e.button & 1) {\n        b = 1;\n      } else if (e.button & 2) {\n        b = 3;\n      } else if (e.button & 4) {\n        b = 2;\n      }\n    }\n\n    if (mac && e.ctrlKey && b == 1) {\n      b = 3;\n    }\n\n    return b;\n  } // Detect drag-and-drop\n\n\n  var dragAndDrop = function () {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) {\n      return false;\n    }\n\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div;\n  }();\n\n  var zwspSupported;\n\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200B\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n\n      if (measure.firstChild.offsetHeight != 0) {\n        zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8);\n      }\n    }\n\n    var node = zwspSupported ? elt(\"span\", \"\\u200B\") : elt(\"span\", \"\\xA0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node;\n  } // Feature-detect IE's crummy client rect reporting for bidi text\n\n\n  var badBidiRects;\n\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) {\n      return badBidiRects;\n    }\n\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062EA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n\n    if (!r0 || r0.left == r0.right) {\n      return false;\n    } // Safari returns null in some cases (#2780)\n\n\n    return badBidiRects = r1.right - r0.right < 3;\n  } // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n\n\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0,\n        result = [],\n        l = string.length;\n\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n\n      if (nl == -1) {\n        nl = string.length;\n      }\n\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n\n    return result;\n  } : function (string) {\n    return string.split(/\\r\\n?|\\n/);\n  };\n  var hasSelection = window.getSelection ? function (te) {\n    try {\n      return te.selectionStart != te.selectionEnd;\n    } catch (e) {\n      return false;\n    }\n  } : function (te) {\n    var range;\n\n    try {\n      range = te.ownerDocument.selection.createRange();\n    } catch (e) {}\n\n    if (!range || range.parentElement() != te) {\n      return false;\n    }\n\n    return range.compareEndPoints(\"StartToEnd\", range) != 0;\n  };\n\n  var hasCopyEvent = function () {\n    var e = elt(\"div\");\n\n    if (\"oncopy\" in e) {\n      return true;\n    }\n\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\";\n  }();\n\n  var badZoomedRects = null;\n\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) {\n      return badZoomedRects;\n    }\n\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1;\n  }\n\n  var modes = {};\n  var mimeModes = {}; // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n\n  function defineMode(name, mode) {\n    if (arguments.length > 2) {\n      mode.dependencies = Array.prototype.slice.call(arguments, 2);\n    }\n\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  } // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n\n\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n\n      if (typeof found == \"string\") {\n        found = {\n          name: found\n        };\n      }\n\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\");\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\");\n    }\n\n    if (typeof spec == \"string\") {\n      return {\n        name: spec\n      };\n    } else {\n      return spec || {\n        name: \"null\"\n      };\n    }\n  } // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n\n\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n\n    if (!mfactory) {\n      return getMode(options, \"text/plain\");\n    }\n\n    var modeObj = mfactory(options, spec);\n\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) {\n          continue;\n        }\n\n        if (modeObj.hasOwnProperty(prop)) {\n          modeObj[\"_\" + prop] = modeObj[prop];\n        }\n\n        modeObj[prop] = exts[prop];\n      }\n    }\n\n    modeObj.name = spec.name;\n\n    if (spec.helperType) {\n      modeObj.helperType = spec.helperType;\n    }\n\n    if (spec.modeProps) {\n      for (var prop$1 in spec.modeProps) {\n        modeObj[prop$1] = spec.modeProps[prop$1];\n      }\n    }\n\n    return modeObj;\n  } // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n\n\n  var modeExtensions = {};\n\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : modeExtensions[mode] = {};\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) {\n      return state;\n    }\n\n    if (mode.copyState) {\n      return mode.copyState(state);\n    }\n\n    var nstate = {};\n\n    for (var n in state) {\n      var val = state[n];\n\n      if (val instanceof Array) {\n        val = val.concat([]);\n      }\n\n      nstate[n] = val;\n    }\n\n    return nstate;\n  } // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n\n\n  function innerMode(mode, state) {\n    var info;\n\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n\n      if (!info || info.mode == mode) {\n        break;\n      }\n\n      state = info.state;\n      mode = info.mode;\n    }\n\n    return info || {\n      mode: mode,\n      state: state\n    };\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true;\n  } // STRING STREAM\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n\n  var StringStream = function StringStream(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {\n    return this.pos >= this.string.length;\n  };\n\n  StringStream.prototype.sol = function () {\n    return this.pos == this.lineStart;\n  };\n\n  StringStream.prototype.peek = function () {\n    return this.string.charAt(this.pos) || undefined;\n  };\n\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length) {\n      return this.string.charAt(this.pos++);\n    }\n  };\n\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n\n    if (typeof match == \"string\") {\n      ok = ch == match;\n    } else {\n      ok = ch && (match.test ? match.test(ch) : match(ch));\n    }\n\n    if (ok) {\n      ++this.pos;\n      return ch;\n    }\n  };\n\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n\n    while (this.eat(match)) {}\n\n    return this.pos > start;\n  };\n\n  StringStream.prototype.eatSpace = function () {\n    var this$1 = this;\n    var start = this.pos;\n\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) {\n      ++this$1.pos;\n    }\n\n    return this.pos > start;\n  };\n\n  StringStream.prototype.skipToEnd = function () {\n    this.pos = this.string.length;\n  };\n\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n\n    if (found > -1) {\n      this.pos = found;\n      return true;\n    }\n  };\n\n  StringStream.prototype.backUp = function (n) {\n    this.pos -= n;\n  };\n\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n  };\n\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n  };\n\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function cased(str) {\n        return caseInsensitive ? str.toLowerCase() : str;\n      };\n\n      var substr = this.string.substr(this.pos, pattern.length);\n\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) {\n          this.pos += pattern.length;\n        }\n\n        return true;\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n\n      if (match && match.index > 0) {\n        return null;\n      }\n\n      if (match && consume !== false) {\n        this.pos += match[0].length;\n      }\n\n      return match;\n    }\n  };\n\n  StringStream.prototype.current = function () {\n    return this.string.slice(this.start, this.pos);\n  };\n\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n\n    try {\n      return inner();\n    } finally {\n      this.lineStart -= n;\n    }\n  };\n\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n);\n  };\n\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos);\n  };\n\n  var SavedContext = function SavedContext(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function Context(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n\n    if (line != null && n > this.maxLookAhead) {\n      this.maxLookAhead = n;\n    }\n\n    return line;\n  };\n\n  Context.prototype.baseToken = function (n) {\n    var this$1 = this;\n\n    if (!this.baseTokens) {\n      return null;\n    }\n\n    while (this.baseTokens[this.baseTokenPos] <= n) {\n      this$1.baseTokenPos += 2;\n    }\n\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {\n      type: type && type.replace(/( |^)overlay .*/, \"\"),\n      size: this.baseTokens[this.baseTokenPos] - n\n    };\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n\n    if (this.maxLookAhead > 0) {\n      this.maxLookAhead--;\n    }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext) {\n      return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead);\n    } else {\n      return new Context(doc, copyState(doc.mode, saved), line);\n    }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state;\n  }; // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n\n\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen],\n        lineClasses = {}; // Compute the base array of styles\n\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) {\n      return st.push(end, style);\n    }, lineClasses, forceToEnd);\n    var state = context.state; // Run overlays, adjust style array.\n\n    var loop = function loop(o) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o],\n          i = 1,\n          at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i; // Ensure there's a token end at the current position, and that i points at it\n\n        while (at < end) {\n          var i_end = st[i];\n\n          if (i_end > end) {\n            st.splice(i, 1, end, st[i + 1], i_end);\n          }\n\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n\n        if (!style) {\n          return;\n        }\n\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start + 1];\n            st[start + 1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) {\n      loop(o);\n    }\n\n    return {\n      styles: st,\n      classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null\n    };\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n\n      if (resetState) {\n        context.state = resetState;\n      }\n\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n\n      if (result.classes) {\n        line.styleClasses = result.classes;\n      } else if (line.styleClasses) {\n        line.styleClasses = null;\n      }\n\n      if (updateFrontier === cm.doc.highlightFrontier) {\n        cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier);\n      }\n    }\n\n    return line.styles;\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc,\n        display = cm.display;\n\n    if (!doc.mode.startState) {\n      return new Context(doc, true, n);\n    }\n\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n\n    if (precise) {\n      doc.modeFrontier = context.line;\n    }\n\n    return context;\n  } // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n\n\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n\n    if (text == \"\") {\n      callBlankLine(mode, context.state);\n    }\n\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) {\n      return mode.blankLine(state);\n    }\n\n    if (!mode.innerMode) {\n      return;\n    }\n\n    var inner = innerMode(mode, state);\n\n    if (inner.mode.blankLine) {\n      return inner.mode.blankLine(inner.state);\n    }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) {\n        inner[0] = innerMode(mode, state).mode;\n      }\n\n      var style = mode.token(stream, state);\n\n      if (stream.pos > stream.start) {\n        return style;\n      }\n    }\n\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\");\n  }\n\n  var Token = function Token(stream, type, state) {\n    this.start = stream.start;\n    this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  }; // Utility for getTokenAt and getLineTokens\n\n\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc,\n        mode = doc.mode,\n        style;\n    pos = _clipPos(doc, pos);\n    var line = getLine(doc, pos.line),\n        context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context),\n        tokens;\n\n    if (asArray) {\n      tokens = [];\n    }\n\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n\n      if (asArray) {\n        tokens.push(new Token(stream, style, copyState(doc.mode, context.state)));\n      }\n    }\n\n    return asArray ? tokens : new Token(stream, style, context.state);\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) {\n      for (;;) {\n        var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n\n        if (!lineClass) {\n          break;\n        }\n\n        type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n        var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n\n        if (output[prop] == null) {\n          output[prop] = lineClass[2];\n        } else if (!new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\").test(output[prop])) {\n          output[prop] += \" \" + lineClass[2];\n        }\n      }\n    }\n\n    return type;\n  } // Run the given mode's parser over a line, calling f for each token.\n\n\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n\n    if (flattenSpans == null) {\n      flattenSpans = cm.options.flattenSpans;\n    }\n\n    var curStart = 0,\n        curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context),\n        style;\n    var inner = cm.options.addModeClass && [null];\n\n    if (text == \"\") {\n      extractLineClasses(callBlankLine(mode, context.state), lineClasses);\n    }\n\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n\n        if (forceToEnd) {\n          processLine(cm, text, context, stream.pos);\n        }\n\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n\n      if (inner) {\n        var mName = inner[0].name;\n\n        if (mName) {\n          style = \"m-\" + (style ? mName + \" \" + style : mName);\n        }\n      }\n\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n\n        curStyle = style;\n      }\n\n      stream.start = stream.pos;\n    }\n\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  } // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n\n\n  function findStartLine(cm, n, precise) {\n    var minindent,\n        minline,\n        doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) {\n        return doc.first;\n      }\n\n      var line = getLine(doc, search - 1),\n          after = line.stateAfter;\n\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier)) {\n        return search;\n      }\n\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n\n    return minline;\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n\n    if (doc.highlightFrontier < n - 10) {\n      return;\n    }\n\n    var start = doc.first;\n\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter; // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break;\n      }\n    }\n\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  } // LINE DATA STRUCTURE\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n\n\n  var Line = function Line(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () {\n    return lineNo(this);\n  };\n\n  eventMixin(Line); // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n\n    if (line.stateAfter) {\n      line.stateAfter = null;\n    }\n\n    if (line.styles) {\n      line.styles = null;\n    }\n\n    if (line.order != null) {\n      line.order = null;\n    }\n\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n\n    if (estHeight != line.height) {\n      updateLineHeight(line, estHeight);\n    }\n  } // Detach a line from the document tree and its markers.\n\n\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  } // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n\n\n  var styleToClassCache = {};\n  var styleToClassCacheWithMode = {};\n\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) {\n      return null;\n    }\n\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] || (cache[style] = style.replace(/\\S+/g, \"cm-$&\"));\n  } // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n\n\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {\n      pre: eltP(\"pre\", [content], \"CodeMirror-line\"),\n      content: content,\n      col: 0,\n      pos: 0,\n      cm: cm,\n      trailingSpace: false,\n      splitSpaces: cm.getOption(\"lineWrapping\")\n    };\n    lineView.measure = {}; // Iterate over the logical lines that make up this visual line.\n\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line,\n          order = void 0;\n      builder.pos = 0;\n      builder.addToken = buildToken; // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction))) {\n        builder.addToken = buildTokenBadBidi(builder.addToken, order);\n      }\n\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass) {\n          builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\");\n        }\n\n        if (line.styleClasses.textClass) {\n          builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\");\n        }\n      } // Ensure at least a single node is present, for measuring.\n\n\n      if (builder.map.length == 0) {\n        builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure)));\n      } // Store the map and a cache object for the current logical line\n\n\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n        ;\n        (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map);\n        (lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    } // See issue #2901\n\n\n    if (webkit) {\n      var last = builder.content.lastChild;\n\n      if (/\\bcm-tab\\b/.test(last.className) || last.querySelector && last.querySelector(\".cm-tab\")) {\n        builder.content.className = \"cm-tab-wrap-hack\";\n      }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n\n    if (builder.pre.className) {\n      builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\");\n    }\n\n    return builder;\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token;\n  } // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n\n\n  function buildToken(builder, text, style, startStyle, endStyle, title, css) {\n    if (!text) {\n      return;\n    }\n\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars,\n        mustWrap = false;\n    var content;\n\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n\n      if (ie && ie_version < 9) {\n        mustWrap = true;\n      }\n\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n\n          if (ie && ie_version < 9) {\n            content.appendChild(elt(\"span\", [txt]));\n          } else {\n            content.appendChild(txt);\n          }\n\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n\n        if (!m) {\n          break;\n        }\n\n        pos += skipped + 1;\n        var txt$1 = void 0;\n\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize,\n              tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240D\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n\n          if (ie && ie_version < 9) {\n            content.appendChild(elt(\"span\", [txt$1]));\n          } else {\n            content.appendChild(txt$1);\n          }\n\n          builder.col += 1;\n        }\n\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n\n      if (startStyle) {\n        fullStyle += startStyle;\n      }\n\n      if (endStyle) {\n        fullStyle += endStyle;\n      }\n\n      var token = elt(\"span\", [content], fullStyle, css);\n\n      if (title) {\n        token.title = title;\n      }\n\n      return builder.content.appendChild(token);\n    }\n\n    builder.content.appendChild(content);\n  } // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n\n\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) {\n      return text;\n    }\n\n    var spaceBefore = trailingBefore,\n        result = \"\";\n\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32)) {\n        ch = \"\\xA0\";\n      }\n\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n\n    return result;\n  } // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n\n\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, title, css) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos,\n          end = start + text.length;\n\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = void 0;\n\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n\n          if (part.to > start && part.from <= start) {\n            break;\n          }\n        }\n\n        if (part.to >= end) {\n          return inner(builder, text, style, startStyle, endStyle, title, css);\n        }\n\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    };\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n\n    if (widget) {\n      builder.map.push(builder.pos, builder.pos + size, widget);\n    }\n\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget) {\n        widget = builder.content.appendChild(document.createElement(\"span\"));\n      }\n\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n\n    builder.pos += size;\n    builder.trailingSpace = false;\n  } // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n\n\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans,\n        allText = line.text,\n        at = 0;\n\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1 += 2) {\n        builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1 + 1], builder.cm.options));\n      }\n\n      return;\n    }\n\n    var len = allText.length,\n        pos = 0,\n        i = 1,\n        text = \"\",\n        style,\n        css;\n    var nextChange = 0,\n        spanStyle,\n        spanEndStyle,\n        spanStartStyle,\n        title,\n        collapsed;\n\n    for (;;) {\n      if (nextChange == pos) {\n        // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n        collapsed = null;\n        nextChange = Infinity;\n        var foundBookmarks = [],\n            endStyles = void 0;\n\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j],\n              m = sp.marker;\n\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n\n            if (m.className) {\n              spanStyle += \" \" + m.className;\n            }\n\n            if (m.css) {\n              css = (css ? css + \";\" : \"\") + m.css;\n            }\n\n            if (m.startStyle && sp.from == pos) {\n              spanStartStyle += \" \" + m.startStyle;\n            }\n\n            if (m.endStyle && sp.to == nextChange) {\n              (endStyles || (endStyles = [])).push(m.endStyle, sp.to);\n            }\n\n            if (m.title && !title) {\n              title = m.title;\n            }\n\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0)) {\n              collapsed = sp;\n            }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n\n        if (endStyles) {\n          for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2) {\n            if (endStyles[j$1 + 1] == nextChange) {\n              spanEndStyle += \" \" + endStyles[j$1];\n            }\n          }\n        }\n\n        if (!collapsed || collapsed.from == pos) {\n          for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2) {\n            buildCollapsedSpan(builder, 0, foundBookmarks[j$2]);\n          }\n        }\n\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos, collapsed.marker, collapsed.from == null);\n\n          if (collapsed.to == null) {\n            return;\n          }\n\n          if (collapsed.to == pos) {\n            collapsed = false;\n          }\n        }\n      }\n\n      if (pos >= len) {\n        break;\n      }\n\n      var upto = Math.min(len, nextChange);\n\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle, spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n          }\n\n          if (end >= upto) {\n            text = text.slice(upto - pos);\n            pos = upto;\n            break;\n          }\n\n          pos = end;\n          spanStartStyle = \"\";\n        }\n\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  } // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n\n\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line; // Continuing lines, if any\n\n    this.rest = visualLineContinued(line); // Number of logical lines in this visual line\n\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  } // Create a range of LineView objects for the given lines.\n\n\n  function buildViewArray(cm, from, to) {\n    var array = [],\n        nextPos;\n\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n\n    return array;\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks,\n        i = 0;\n\n    do {\n      for (; i < callbacks.length; i++) {\n        callbacks[i].call(null);\n      }\n\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n\n        if (op.cursorActivityHandlers) {\n          while (op.cursorActivityCalled < op.cursorActivityHandlers.length) {\n            op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm);\n          }\n        }\n      }\n    } while (i < callbacks.length);\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n\n    if (!group) {\n      return;\n    }\n\n    try {\n      fireCallbacksForOps(group);\n    } finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null; // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n\n  function signalLater(emitter, type\n  /*, values...*/\n  ) {\n    var arr = getHandlers(emitter, type);\n\n    if (!arr.length) {\n      return;\n    }\n\n    var args = Array.prototype.slice.call(arguments, 2),\n        list;\n\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n\n    var loop = function loop(i) {\n      list.push(function () {\n        return arr[i].apply(null, args);\n      });\n    };\n\n    for (var i = 0; i < arr.length; ++i) {\n      loop(i);\n    }\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n\n    for (var i = 0; i < delayed.length; ++i) {\n      delayed[i]();\n    }\n  } // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n\n\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n\n      if (type == \"text\") {\n        updateLineText(cm, lineView);\n      } else if (type == \"gutter\") {\n        updateLineGutter(cm, lineView, lineN, dims);\n      } else if (type == \"class\") {\n        updateLineClasses(cm, lineView);\n      } else if (type == \"widget\") {\n        updateLineWidgets(cm, lineView, dims);\n      }\n    }\n\n    lineView.changes = null;\n  } // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n\n\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n\n      if (lineView.text.parentNode) {\n        lineView.text.parentNode.replaceChild(lineView.node, lineView.text);\n      }\n\n      lineView.node.appendChild(lineView.text);\n\n      if (ie && ie_version < 8) {\n        lineView.node.style.zIndex = 2;\n      }\n    }\n\n    return lineView.node;\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n\n    if (cls) {\n      cls += \" CodeMirror-linebackground\";\n    }\n\n    if (lineView.background) {\n      if (cls) {\n        lineView.background.className = cls;\n      } else {\n        lineView.background.parentNode.removeChild(lineView.background);\n        lineView.background = null;\n      }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  } // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n\n\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built;\n    }\n\n    return buildLineContent(cm, lineView);\n  } // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n\n\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n\n    if (lineView.text == lineView.node) {\n      lineView.node = built.pre;\n    }\n\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n\n    if (lineView.line.wrapClass) {\n      ensureLineWrapped(lineView).className = lineView.line.wrapClass;\n    } else if (lineView.node != lineView.text) {\n      lineView.node.className = \"\";\n    }\n\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass, \"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + dims.gutterTotalWidth + \"px\");\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n\n    var markers = lineView.line.gutterMarkers;\n\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", \"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\");\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n\n      if (lineView.line.gutterClass) {\n        gutterWrap.className += \" \" + lineView.line.gutterClass;\n      }\n\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"])) {\n        lineView.lineNumber = gutterWrap.appendChild(elt(\"div\", lineNumberFor(cm.options, lineN), \"CodeMirror-linenumber CodeMirror-gutter-elt\", \"left: \" + dims.gutterLeft[\"CodeMirror-linenumbers\"] + \"px; width: \" + cm.display.lineNumInnerWidth + \"px\"));\n      }\n\n      if (markers) {\n        for (var k = 0; k < cm.options.gutters.length; ++k) {\n          var id = cm.options.gutters[k],\n              found = markers.hasOwnProperty(id) && markers[id];\n\n          if (found) {\n            gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\", \"left: \" + dims.gutterLeft[id] + \"px; width: \" + dims.gutterWidth[id] + \"px\"));\n          }\n        }\n      }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) {\n      lineView.alignable = null;\n    }\n\n    for (var node = lineView.node.firstChild, next = void 0; node; node = next) {\n      next = node.nextSibling;\n\n      if (node.className == \"CodeMirror-linewidget\") {\n        lineView.node.removeChild(node);\n      }\n    }\n\n    insertLineWidgets(cm, lineView, dims);\n  } // Build a line's DOM representation from scratch\n\n\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n\n    if (built.bgClass) {\n      lineView.bgClass = built.bgClass;\n    }\n\n    if (built.textClass) {\n      lineView.textClass = built.textClass;\n    }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node;\n  } // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n\n\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n\n    if (lineView.rest) {\n      for (var i = 0; i < lineView.rest.length; i++) {\n        insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false);\n      }\n    }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) {\n      return;\n    }\n\n    var wrap = ensureLineWrapped(lineView);\n\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i],\n          node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n\n      if (!widget.handleMouseEvents) {\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n      }\n\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n\n      if (allowAbove && widget.above) {\n        wrap.insertBefore(node, lineView.gutter || lineView.text);\n      } else {\n        wrap.appendChild(node);\n      }\n\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n      ;\n      (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n\n      node.style.width = width + \"px\";\n    }\n\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n\n      if (!widget.noHScroll) {\n        node.style.marginLeft = -dims.gutterTotalWidth + \"px\";\n      }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) {\n      return widget.height;\n    }\n\n    var cm = widget.doc.cm;\n\n    if (!cm) {\n      return 0;\n    }\n\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n\n      if (widget.coverGutter) {\n        parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\";\n      }\n\n      if (widget.noHScroll) {\n        parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\";\n      }\n\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n\n    return widget.height = widget.node.parentNode.offsetHeight;\n  } // Return true when the given mouse event happened in a widget\n\n\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\" || n.parentNode == display.sizer && n != display.mover) {\n        return true;\n      }\n    }\n  } // POSITION MEASUREMENT\n\n\n  function paddingTop(display) {\n    return display.lineSpace.offsetTop;\n  }\n\n  function paddingVert(display) {\n    return display.mover.offsetHeight - display.lineSpace.offsetHeight;\n  }\n\n  function paddingH(display) {\n    if (display.cachedPaddingH) {\n      return display.cachedPaddingH;\n    }\n\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {\n      left: parseInt(style.paddingLeft),\n      right: parseInt(style.paddingRight)\n    };\n\n    if (!isNaN(data.left) && !isNaN(data.right)) {\n      display.cachedPaddingH = data;\n    }\n\n    return data;\n  }\n\n  function scrollGap(cm) {\n    return scrollerGap - cm.display.nativeBarWidth;\n  }\n\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth;\n  }\n\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight;\n  } // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n\n\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i],\n              next = rects[i + 1];\n\n          if (Math.abs(cur.bottom - next.bottom) > 2) {\n            heights.push((cur.bottom + next.top) / 2 - rect.top);\n          }\n        }\n      }\n\n      heights.push(rect.bottom - rect.top);\n    }\n  } // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n\n\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line) {\n      return {\n        map: lineView.measure.map,\n        cache: lineView.measure.cache\n      };\n    }\n\n    for (var i = 0; i < lineView.rest.length; i++) {\n      if (lineView.rest[i] == line) {\n        return {\n          map: lineView.measure.maps[i],\n          cache: lineView.measure.caches[i]\n        };\n      }\n    }\n\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++) {\n      if (lineNo(lineView.rest[i$1]) > lineN) {\n        return {\n          map: lineView.measure.maps[i$1],\n          cache: lineView.measure.caches[i$1],\n          before: true\n        };\n      }\n    }\n  } // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n\n\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view;\n  } // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n\n\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias);\n  } // Find a line view that corresponds to the given line number.\n\n\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo) {\n      return cm.display.view[findViewIndex(cm, lineN)];\n    }\n\n    var ext = cm.display.externalMeasured;\n\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size) {\n      return ext;\n    }\n  } // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n\n\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n\n    if (!view) {\n      view = updateExternalMeasurement(cm, line);\n    }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line,\n      view: view,\n      rect: null,\n      map: info.map,\n      cache: info.cache,\n      before: info.before,\n      hasHeights: false\n    };\n  } // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n\n\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) {\n      ch = -1;\n    }\n\n    var key = ch + (bias || \"\"),\n        found;\n\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect) {\n        prepared.rect = prepared.view.text.getBoundingClientRect();\n      }\n\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n\n      found = measureCharInner(cm, prepared, ch, bias);\n\n      if (!found.bogus) {\n        prepared.cache[key] = found;\n      }\n    }\n\n    return {\n      left: found.left,\n      right: found.right,\n      top: varHeight ? found.rtop : found.top,\n      bottom: varHeight ? found.rbottom : found.bottom\n    };\n  }\n\n  var nullRect = {\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0\n  };\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd; // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n\n      if (ch < mStart) {\n        start = 0;\n        end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n\n        if (ch >= mEnd) {\n          collapse = \"right\";\n        }\n      }\n\n      if (start != null) {\n        node = map[i + 2];\n\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\")) {\n          collapse = bias;\n        }\n\n        if (bias == \"left\" && start == 0) {\n          while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          }\n        }\n\n        if (bias == \"right\" && start == mEnd - mStart) {\n          while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          }\n        }\n\n        break;\n      }\n    }\n\n    return {\n      node: node,\n      start: start,\n      end: end,\n      collapse: collapse,\n      coverStart: mStart,\n      coverEnd: mEnd\n    };\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n\n    if (bias == \"left\") {\n      for (var i = 0; i < rects.length; i++) {\n        if ((rect = rects[i]).left != rect.right) {\n          break;\n        }\n      }\n    } else {\n      for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n        if ((rect = rects[i$1]).left != rect.right) {\n          break;\n        }\n      }\n    }\n\n    return rect;\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node,\n        start = place.start,\n        end = place.end,\n        collapse = place.collapse;\n    var rect;\n\n    if (node.nodeType == 3) {\n      // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) {\n        // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) {\n          --start;\n        }\n\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) {\n          ++end;\n        }\n\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart) {\n          rect = node.parentNode.getBoundingClientRect();\n        } else {\n          rect = getUsefulRect(range(node, start, end).getClientRects(), bias);\n        }\n\n        if (rect.left || rect.right || start == 0) {\n          break;\n        }\n\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n\n      if (ie && ie_version < 11) {\n        rect = maybeUpdateRectForZooming(cm.display.measure, rect);\n      }\n    } else {\n      // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) {\n        collapse = bias = \"right\";\n      }\n\n      var rects;\n\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1) {\n        rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n      } else {\n        rect = node.getBoundingClientRect();\n      }\n    }\n\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n\n      if (rSpan) {\n        rect = {\n          left: rSpan.left,\n          right: rSpan.left + charWidth(cm.display),\n          top: rSpan.top,\n          bottom: rSpan.bottom\n        };\n      } else {\n        rect = nullRect;\n      }\n    }\n\n    var rtop = rect.top - prepared.rect.top,\n        rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n\n    for (; i < heights.length - 1; i++) {\n      if (mid < heights[i]) {\n        break;\n      }\n    }\n\n    var top = i ? heights[i - 1] : 0,\n        bot = heights[i];\n    var result = {\n      left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n      right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n      top: top,\n      bottom: bot\n    };\n\n    if (!rect.left && !rect.right) {\n      result.bogus = true;\n    }\n\n    if (!cm.options.singleCursorHeightPerLine) {\n      result.rtop = rtop;\n      result.rbottom = rbot;\n    }\n\n    return result;\n  } // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n\n\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null || screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure)) {\n      return rect;\n    }\n\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {\n      left: rect.left * scaleX,\n      right: rect.right * scaleX,\n      top: rect.top * scaleY,\n      bottom: rect.bottom * scaleY\n    };\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n\n      if (lineView.rest) {\n        for (var i = 0; i < lineView.rest.length; i++) {\n          lineView.measure.caches[i] = {};\n        }\n      }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n\n    for (var i = 0; i < cm.display.view.length; i++) {\n      clearLineMeasurementCacheFor(cm.display.view[i]);\n    }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n\n    if (!cm.options.lineWrapping) {\n      cm.display.maxLineChanged = true;\n    }\n\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) {\n      return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft));\n    }\n\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft;\n  }\n\n  function pageScrollY() {\n    if (chrome && android) {\n      return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop));\n    }\n\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop;\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n\n    if (lineObj.widgets) {\n      for (var i = 0; i < lineObj.widgets.length; ++i) {\n        if (lineObj.widgets[i].above) {\n          height += widgetHeight(lineObj.widgets[i]);\n        }\n      }\n    }\n\n    return height;\n  } // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n\n\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height;\n      rect.bottom += height;\n    }\n\n    if (context == \"line\") {\n      return rect;\n    }\n\n    if (!context) {\n      context = \"local\";\n    }\n\n    var yOff = _heightAtLine(lineObj);\n\n    if (context == \"local\") {\n      yOff += paddingTop(cm.display);\n    } else {\n      yOff -= cm.display.viewOffset;\n    }\n\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff;\n      rect.right += xOff;\n    }\n\n    rect.top += yOff;\n    rect.bottom += yOff;\n    return rect;\n  } // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n\n\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") {\n      return coords;\n    }\n\n    var left = coords.left,\n        top = coords.top; // First move into \"page\" coordinate system\n\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {\n      left: left - lineSpaceBox.left,\n      top: top - lineSpaceBox.top\n    };\n  }\n\n  function _charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) {\n      lineObj = getLine(cm.doc, pos.line);\n    }\n\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context);\n  } // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n\n\n  function _cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n\n    if (!preparedMeasure) {\n      preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    }\n\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n\n      if (right) {\n        m.left = m.right;\n      } else {\n        m.right = m.left;\n      }\n\n      return intoCoordSystem(cm, lineObj, m, context);\n    }\n\n    var order = getOrder(lineObj, cm.doc.direction),\n        ch = pos.ch,\n        sticky = pos.sticky;\n\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n\n    if (!order) {\n      return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\");\n    }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos],\n          right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert);\n    }\n\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n\n    if (other != null) {\n      val.other = getBidi(ch, other, sticky != \"before\");\n    }\n\n    return val;\n  } // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n\n\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = _clipPos(cm.doc, pos);\n\n    if (!cm.options.lineWrapping) {\n      left = charWidth(cm.display) * pos.ch;\n    }\n\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = _heightAtLine(lineObj) + paddingTop(cm.display);\n    return {\n      left: left,\n      right: left,\n      top: top,\n      bottom: top + lineObj.height\n    };\n  } // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n\n\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n\n    if (outside) {\n      pos.outside = true;\n    }\n\n    return pos;\n  } // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n\n\n  function _coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n\n    if (y < 0) {\n      return PosWithInfo(doc.first, 0, null, true, -1);\n    }\n\n    var lineN = _lineAtHeight(doc, y),\n        last = doc.first + doc.size - 1;\n\n    if (lineN > last) {\n      return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1);\n    }\n\n    if (x < 0) {\n      x = 0;\n    }\n\n    var lineObj = getLine(doc, lineN);\n\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 ? 1 : 0));\n\n      if (!collapsed) {\n        return found;\n      }\n\n      var rangeEnd = collapsed.find(1);\n\n      if (rangeEnd.line == lineN) {\n        return rangeEnd;\n      }\n\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) {\n      return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y;\n    }, end, 0);\n    end = findFirst(function (ch) {\n      return measureCharPrepared(cm, preparedMeasure, ch).top > y;\n    }, begin, end);\n    return {\n      begin: begin,\n      end: end\n    };\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) {\n      preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    }\n\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop);\n  } // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n\n\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x;\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= _heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj); // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0,\n        end = lineObj.text.length,\n        ltr = true;\n    var order = getOrder(lineObj, cm.doc.direction); // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)(cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1; // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    } // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n\n\n    var chAround = null,\n        boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight;\n      box.bottom += widgetHeight;\n\n      if (!boxIsAfter(box, x, y, false)) {\n        return false;\n      }\n\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n\n      return true;\n    }, begin, end);\n    var baseX,\n        sticky,\n        outside = false; // If a box around the coordinates was found, use that\n\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x,\n          atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) {\n        ch++;\n      } // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n\n\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" : measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y == ltr ? \"after\" : \"before\"; // Now get accurate coordinates for this place, in order to get a\n      // base X position\n\n      var coords = _cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n\n      baseX = coords.left;\n      outside = y < coords.top || y >= coords.bottom;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX);\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i],\n          ltr = part.level != 1;\n      return boxIsAfter(_cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"), \"line\", lineObj, preparedMeasure), x, y, true);\n    }, 0, order.length - 1);\n    var part = order[index]; // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n\n    if (index > 0) {\n      var ltr = part.level != 1;\n\n      var start = _cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"), \"line\", lineObj, preparedMeasure);\n\n      if (boxIsAfter(start, x, y, true) && start.top > y) {\n        part = order[index - 1];\n      }\n    }\n\n    return part;\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) {\n      end--;\n    }\n\n    var part = null,\n        closestDist = null;\n\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n\n      if (p.from >= end || p.to <= begin) {\n        continue;\n      }\n\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right; // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n\n    if (!part) {\n      part = order[order.length - 1];\n    } // Clip the part to the wrapped line.\n\n\n    if (part.from < begin) {\n      part = {\n        from: begin,\n        to: part.to,\n        level: part.level\n      };\n    }\n\n    if (part.to > end) {\n      part = {\n        from: part.from,\n        to: end,\n        level: part.level\n      };\n    }\n\n    return part;\n  }\n\n  var measureText; // Compute the default text height.\n\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) {\n      return display.cachedTextHeight;\n    }\n\n    if (measureText == null) {\n      measureText = elt(\"pre\"); // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n\n    if (height > 3) {\n      display.cachedTextHeight = height;\n    }\n\n    removeChildren(display.measure);\n    return height || 1;\n  } // Compute the default character width.\n\n\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) {\n      return display.cachedCharWidth;\n    }\n\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(),\n        width = (rect.right - rect.left) / 10;\n\n    if (width > 2) {\n      display.cachedCharWidth = width;\n    }\n\n    return width || 10;\n  } // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n\n\n  function getDimensions(cm) {\n    var d = cm.display,\n        left = {},\n        width = {};\n    var gutterLeft = d.gutters.clientLeft;\n\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[cm.options.gutters[i]] = n.clientWidth;\n    }\n\n    return {\n      fixedPos: compensateForHScroll(d),\n      gutterTotalWidth: d.gutters.offsetWidth,\n      gutterLeft: left,\n      gutterWidth: width,\n      wrapperWidth: d.wrapper.clientWidth\n    };\n  } // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n\n\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left;\n  } // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n\n\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display),\n        wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) {\n        return 0;\n      }\n\n      var widgetsHeight = 0;\n\n      if (line.widgets) {\n        for (var i = 0; i < line.widgets.length; i++) {\n          if (line.widgets[i].height) {\n            widgetsHeight += line.widgets[i].height;\n          }\n        }\n      }\n\n      if (wrapping) {\n        return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th;\n      } else {\n        return widgetsHeight + th;\n      }\n    };\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc,\n        est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n\n      if (estHeight != line.height) {\n        updateLineHeight(line, estHeight);\n      }\n    });\n  } // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n\n\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") {\n      return null;\n    }\n\n    var x,\n        y,\n        space = display.lineSpace.getBoundingClientRect(); // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n\n    try {\n      x = e.clientX - space.left;\n      y = e.clientY - space.top;\n    } catch (e) {\n      return null;\n    }\n\n    var coords = _coordsChar(cm, x, y),\n        line;\n\n    if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n\n    return coords;\n  } // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n\n\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) {\n      return null;\n    }\n\n    n -= cm.display.viewFrom;\n\n    if (n < 0) {\n      return null;\n    }\n\n    var view = cm.display.view;\n\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n\n      if (n < 0) {\n        return i;\n      }\n    }\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if (primary === void 0) primary = true;\n    var doc = cm.doc,\n        result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) {\n        continue;\n      }\n\n      var range = doc.sel.ranges[i];\n\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) {\n        continue;\n      }\n\n      var collapsed = range.empty();\n\n      if (collapsed || cm.options.showCursorWhenSelecting) {\n        drawSelectionCursor(cm, range.head, curFragment);\n      }\n\n      if (!collapsed) {\n        drawSelectionRange(cm, range, selFragment);\n      }\n    }\n\n    return result;\n  } // Draws a cursor for the given range\n\n\n  function drawSelectionCursor(cm, head, output) {\n    var pos = _cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\xA0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\xA0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) {\n    return a.top - b.top || a.left - b.left;\n  } // Draws the given range as a highlighted selection\n\n\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display,\n        doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display),\n        leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) {\n        top = 0;\n      }\n\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", \"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\"));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n\n      function coords(ch, bias) {\n        return _charCoords(cm, Pos(line, ch), \"div\", lineObj, bias);\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = dir == \"ltr\" == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop];\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n        var openStart = fromArg == null && from == 0,\n            openEnd = toArg == null && to == lineLen;\n        var first = i == 0,\n            last = !order || i == order.length - 1;\n\n        if (toPos.top - fromPos.top <= 3) {\n          // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else {\n          // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n\n          if (fromPos.bottom < toPos.top) {\n            add(leftSide, fromPos.bottom, null, toPos.top);\n          }\n\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) {\n          start = fromPos;\n        }\n\n        if (cmpCoords(toPos, start) < 0) {\n          start = toPos;\n        }\n\n        if (!end || cmpCoords(fromPos, end) < 0) {\n          end = fromPos;\n        }\n\n        if (cmpCoords(toPos, end) < 0) {\n          end = toPos;\n        }\n      });\n      return {\n        start: start,\n        end: end\n      };\n    }\n\n    var sFrom = range.from(),\n        sTo = range.to();\n\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line),\n          toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n\n      if (leftEnd.bottom < rightStart.top) {\n        add(leftSide, leftEnd.bottom, null, rightStart.top);\n      }\n    }\n\n    output.appendChild(fragment);\n  } // Cursor-blinking\n\n\n  function restartBlink(cm) {\n    if (!cm.state.focused) {\n      return;\n    }\n\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n\n    if (cm.options.cursorBlinkRate > 0) {\n      display.blinker = setInterval(function () {\n        return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate);\n    } else if (cm.options.cursorBlinkRate < 0) {\n      display.cursorDiv.style.visibility = \"hidden\";\n    }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) {\n      cm.display.input.focus();\n      onFocus(cm);\n    }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () {\n      if (cm.state.delayingBlurEvent) {\n        cm.state.delayingBlurEvent = false;\n        onBlur(cm);\n      }\n    }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n    }\n\n    if (cm.options.readOnly == \"nocursor\") {\n      return;\n    }\n\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\"); // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n\n        if (webkit) {\n          setTimeout(function () {\n            return cm.display.input.reset(true);\n          }, 20);\n        } // Issue #1730\n\n      }\n\n      cm.display.input.receivedFocus();\n    }\n\n    restartBlink(cm);\n  }\n\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) {\n      return;\n    }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n\n    clearInterval(cm.display.blinker);\n    setTimeout(function () {\n      if (!cm.state.focused) {\n        cm.display.shift = false;\n      }\n    }, 150);\n  } // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n\n\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i],\n          height = void 0;\n\n      if (cur.hidden) {\n        continue;\n      }\n\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n      }\n\n      var diff = cur.line.height - height;\n\n      if (height < 2) {\n        height = textHeight(display);\n      }\n\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n\n        if (cur.rest) {\n          for (var j = 0; j < cur.rest.length; j++) {\n            updateWidgetHeight(cur.rest[j]);\n          }\n        }\n      }\n    }\n  } // Read and store the height of line widgets associated with the\n  // given line.\n\n\n  function updateWidgetHeight(line) {\n    if (line.widgets) {\n      for (var i = 0; i < line.widgets.length; ++i) {\n        var w = line.widgets[i],\n            parent = w.node.parentNode;\n\n        if (parent) {\n          w.height = parent.offsetHeight;\n        }\n      }\n    }\n  } // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n\n\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = _lineAtHeight(doc, top),\n        to = _lineAtHeight(doc, bottom); // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n\n\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line,\n          ensureTo = viewport.ensure.to.line;\n\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = _lineAtHeight(doc, _heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = _lineAtHeight(doc, _heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n\n    return {\n      from: from,\n      to: Math.max(to, from + 1)\n    };\n  } // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n\n\n  function alignHorizontally(cm) {\n    var display = cm.display,\n        view = display.view;\n\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) {\n      return;\n    }\n\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth,\n        left = comp + \"px\";\n\n    for (var i = 0; i < view.length; i++) {\n      if (!view[i].hidden) {\n        if (cm.options.fixedGutter) {\n          if (view[i].gutter) {\n            view[i].gutter.style.left = left;\n          }\n\n          if (view[i].gutterBackground) {\n            view[i].gutterBackground.style.left = left;\n          }\n        }\n\n        var align = view[i].alignable;\n\n        if (align) {\n          for (var j = 0; j < align.length; j++) {\n            align[j].style.left = left;\n          }\n        }\n      }\n    }\n\n    if (cm.options.fixedGutter) {\n      display.gutters.style.left = comp + gutterW + \"px\";\n    }\n  } // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n\n\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) {\n      return false;\n    }\n\n    var doc = cm.doc,\n        last = lineNumberFor(cm.options, doc.first + doc.size - 1),\n        display = cm.display;\n\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)], \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth,\n          padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm);\n      return true;\n    }\n\n    return false;\n  } // SCROLLING THINGS INTO VIEW\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n\n\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) {\n      return;\n    }\n\n    var display = cm.display,\n        box = display.sizer.getBoundingClientRect(),\n        doScroll = null;\n\n    if (rect.top + box.top < 0) {\n      doScroll = true;\n    } else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) {\n      doScroll = false;\n    }\n\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200B\", null, \"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + rect.left + \"px; width: \" + Math.max(2, rect.right - rect.left) + \"px;\");\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  } // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n\n\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) {\n      margin = 0;\n    }\n\n    var rect;\n\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n\n      var coords = _cursorCoords(cm, pos);\n\n      var endCoords = !end || end == pos ? coords : _cursorCoords(cm, end);\n      rect = {\n        left: Math.min(coords.left, endCoords.left),\n        top: Math.min(coords.top, endCoords.top) - margin,\n        right: Math.max(coords.left, endCoords.left),\n        bottom: Math.max(coords.bottom, endCoords.bottom) + margin\n      };\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop,\n          startLeft = cm.doc.scrollLeft;\n\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) {\n          changed = true;\n        }\n      }\n\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) {\n          changed = true;\n        }\n      }\n\n      if (!changed) {\n        break;\n      }\n    }\n\n    return rect;\n  } // Scroll a given set of coordinates into view (immediately).\n\n\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n\n    if (scrollPos.scrollTop != null) {\n      updateScrollTop(cm, scrollPos.scrollTop);\n    }\n\n    if (scrollPos.scrollLeft != null) {\n      setScrollLeft(cm, scrollPos.scrollLeft);\n    }\n  } // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n\n\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display,\n        snapMargin = textHeight(cm.display);\n\n    if (rect.top < 0) {\n      rect.top = 0;\n    }\n\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm),\n        result = {};\n\n    if (rect.bottom - rect.top > screen) {\n      rect.bottom = rect.top + screen;\n    }\n\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin,\n        atBottom = rect.bottom > docBottom - snapMargin;\n\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n\n      if (newTop != screentop) {\n        result.scrollTop = newTop;\n      }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n\n    if (tooWide) {\n      rect.right = rect.left + screenw;\n    }\n\n    if (rect.left < 10) {\n      result.scrollLeft = 0;\n    } else if (rect.left < screenleft) {\n      result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10));\n    } else if (rect.right > screenw + screenleft - 3) {\n      result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw;\n    }\n\n    return result;\n  } // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n\n\n  function addToScrollTop(cm, top) {\n    if (top == null) {\n      return;\n    }\n\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  } // Make sure that at the end of the operation the current cursor is\n  // shown.\n\n\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {\n      from: cur,\n      to: cur,\n      margin: cm.options.cursorScrollMargin\n    };\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) {\n      resolveScrollToPos(cm);\n    }\n\n    if (x != null) {\n      cm.curOp.scrollLeft = x;\n    }\n\n    if (y != null) {\n      cm.curOp.scrollTop = y;\n    }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  } // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n\n\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from),\n          to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  } // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n\n\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) {\n      return;\n    }\n\n    if (!gecko) {\n      updateDisplaySimple(cm, {\n        top: val\n      });\n    }\n\n    setScrollTop(cm, val, true);\n\n    if (gecko) {\n      updateDisplaySimple(cm);\n    }\n\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n\n    if (cm.display.scroller.scrollTop == val && !forceScroll) {\n      return;\n    }\n\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n\n    if (cm.display.scroller.scrollTop != val) {\n      cm.display.scroller.scrollTop = val;\n    }\n  } // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n\n\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) {\n      return;\n    }\n\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n\n    if (cm.display.scroller.scrollLeft != val) {\n      cm.display.scroller.scrollLeft = val;\n    }\n\n    cm.display.scrollbars.setScrollLeft(val);\n  } // SCROLLBARS\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n\n\n  function measureForScrollbars(cm) {\n    var d = cm.display,\n        gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth,\n      clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    };\n  }\n\n  var NativeScrollbars = function NativeScrollbars(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert);\n    place(horiz);\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) {\n        scroll(vert.scrollTop, \"vertical\");\n      }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) {\n        scroll(horiz.scrollLeft, \"horizontal\");\n      }\n    });\n    this.checkedZeroWidth = false; // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n\n    if (ie && ie_version < 8) {\n      this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\";\n    }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0); // A bug in IE8 can cause this value to be negative, so guard it.\n\n      this.vert.firstChild.style.height = Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width = Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) {\n        this.zeroWidthHack();\n      }\n\n      this.checkedZeroWidth = true;\n    }\n\n    return {\n      right: needsV ? sWidth : 0,\n      bottom: needsH ? sWidth : 0\n    };\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) {\n      this.horiz.scrollLeft = pos;\n    }\n\n    if (this.disableHoriz) {\n      this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\");\n    }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) {\n      this.vert.scrollTop = pos;\n    }\n\n    if (this.disableVert) {\n      this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\");\n    }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed();\n    this.disableVert = new Delayed();\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2) : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n\n      if (elt != bar) {\n        bar.style.pointerEvents = \"none\";\n      } else {\n        delay.set(1000, maybeDisable);\n      }\n    }\n\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function NullScrollbars() {};\n\n  NullScrollbars.prototype.update = function () {\n    return {\n      bottom: 0,\n      right: 0\n    };\n  };\n\n  NullScrollbars.prototype.setScrollLeft = function () {};\n\n  NullScrollbars.prototype.setScrollTop = function () {};\n\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) {\n      measure = measureForScrollbars(cm);\n    }\n\n    var startWidth = cm.display.barWidth,\n        startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping) {\n        updateHeightsInViewport(cm);\n      }\n\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth;\n      startHeight = cm.display.barHeight;\n    }\n  } // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n\n\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else {\n      d.scrollbarFiller.style.display = \"\";\n    }\n\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else {\n      d.gutterFiller.style.display = \"\";\n    }\n  }\n\n  var scrollbarModel = {\n    \"native\": NativeScrollbars,\n    \"null\": NullScrollbars\n  };\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n\n      if (cm.display.scrollbars.addClass) {\n        rmClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n      }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller); // Prevent clicks in the scrollbars from killing focus\n\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) {\n          setTimeout(function () {\n            return cm.display.input.focus();\n          }, 0);\n        }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") {\n        setScrollLeft(cm, pos);\n      } else {\n        updateScrollTop(cm, pos);\n      }\n    }, cm);\n\n    if (cm.display.scrollbars.addClass) {\n      addClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n    }\n  } // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n\n  var nextOpId = 0; // Start a new operation.\n\n  function _startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,\n      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height,\n      // Used to detect need to update scrollbar\n      forceUpdate: false,\n      // Used to force a redraw\n      updateInput: null,\n      // Whether to reset the input textarea\n      typing: false,\n      // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,\n      // Accumulated changes, for firing change events\n      cursorActivityHandlers: null,\n      // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0,\n      // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false,\n      // Whether the selection needs to be redrawn\n      updateMaxLine: false,\n      // Set when the widest line needs to be determined anew\n      scrollLeft: null,\n      scrollTop: null,\n      // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,\n      // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId // Unique ID\n\n    };\n    pushOperation(cm.curOp);\n  } // Finish an operation, updating the display and signalling delayed events\n\n\n  function _endOperation(cm) {\n    var op = cm.curOp;\n    finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++) {\n        group.ops[i].cm.curOp = null;\n      }\n\n      endOperations(group);\n    });\n  } // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n\n\n  function endOperations(group) {\n    var ops = group.ops;\n\n    for (var i = 0; i < ops.length; i++) // Read DOM\n    {\n      endOperation_R1(ops[i]);\n    }\n\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n    {\n      endOperation_W1(ops[i$1]);\n    }\n\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n    {\n      endOperation_R2(ops[i$2]);\n    }\n\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n    {\n      endOperation_W2(ops[i$3]);\n    }\n\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n    {\n      endOperation_finish(ops[i$4]);\n    }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm,\n        display = cm.display;\n    maybeClipScrollbars(cm);\n\n    if (op.updateMaxLine) {\n      findMaxLine(cm);\n    }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null || op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom || op.scrollToPos.to.line >= display.viewTo) || display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate && new DisplayUpdate(cm, op.mustUpdate && {\n      top: op.scrollTop,\n      ensure: op.scrollToPos\n    }, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm,\n        display = cm.display;\n\n    if (op.updatedDisplay) {\n      updateHeightsInViewport(cm);\n    }\n\n    op.barMeasure = measureForScrollbars(cm); // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth = Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged) {\n      op.preparedSelection = display.input.prepareSelection();\n    }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n\n      if (op.maxScrollLeft < cm.doc.scrollLeft) {\n        setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true);\n      }\n\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n\n    if (op.preparedSelection) {\n      cm.display.input.showSelection(op.preparedSelection, takeFocus);\n    }\n\n    if (op.updatedDisplay || op.startHeight != cm.doc.height) {\n      updateScrollbars(cm, op.barMeasure);\n    }\n\n    if (op.updatedDisplay) {\n      setDocumentHeight(cm, op.barMeasure);\n    }\n\n    if (op.selectionChanged) {\n      restartBlink(cm);\n    }\n\n    if (cm.state.focused && op.updateInput) {\n      cm.display.input.reset(op.typing);\n    }\n\n    if (takeFocus) {\n      ensureFocus(op.cm);\n    }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm,\n        display = cm.display,\n        doc = cm.doc;\n\n    if (op.updatedDisplay) {\n      postUpdateDisplay(cm, op.update);\n    } // Abort mouse wheel delta measurement, when scrolling explicitly\n\n\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos)) {\n      display.wheelStartX = display.wheelStartY = null;\n    } // Propagate the scroll position to the actual DOM scroller\n\n\n    if (op.scrollTop != null) {\n      setScrollTop(cm, op.scrollTop, op.forceScroll);\n    }\n\n    if (op.scrollLeft != null) {\n      setScrollLeft(cm, op.scrollLeft, true, true);\n    } // If we need to scroll a specific position into view, do so.\n\n\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, _clipPos(doc, op.scrollToPos.from), _clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    } // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n\n\n    var hidden = op.maybeHiddenMarkers,\n        unhidden = op.maybeUnhiddenMarkers;\n\n    if (hidden) {\n      for (var i = 0; i < hidden.length; ++i) {\n        if (!hidden[i].lines.length) {\n          signal(hidden[i], \"hide\");\n        }\n      }\n    }\n\n    if (unhidden) {\n      for (var i$1 = 0; i$1 < unhidden.length; ++i$1) {\n        if (unhidden[i$1].lines.length) {\n          signal(unhidden[i$1], \"unhide\");\n        }\n      }\n    }\n\n    if (display.wrapper.offsetHeight) {\n      doc.scrollTop = cm.display.scroller.scrollTop;\n    } // Fire change events, and delayed event handlers\n\n\n    if (op.changeObjs) {\n      signal(cm, \"changes\", cm, op.changeObjs);\n    }\n\n    if (op.update) {\n      op.update.finish();\n    }\n  } // Run the given function in an operation\n\n\n  function runInOp(cm, f) {\n    if (cm.curOp) {\n      return f();\n    }\n\n    _startOperation(cm);\n\n    try {\n      return f();\n    } finally {\n      _endOperation(cm);\n    }\n  } // Wraps a function in an operation. Returns the wrapped function.\n\n\n  function operation(cm, f) {\n    return function () {\n      if (cm.curOp) {\n        return f.apply(cm, arguments);\n      }\n\n      _startOperation(cm);\n\n      try {\n        return f.apply(cm, arguments);\n      } finally {\n        _endOperation(cm);\n      }\n    };\n  } // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n\n\n  function methodOp(f) {\n    return function () {\n      if (this.curOp) {\n        return f.apply(this, arguments);\n      }\n\n      _startOperation(this);\n\n      try {\n        return f.apply(this, arguments);\n      } finally {\n        _endOperation(this);\n      }\n    };\n  }\n\n  function docMethodOp(f) {\n    return function () {\n      var cm = this.cm;\n\n      if (!cm || cm.curOp) {\n        return f.apply(this, arguments);\n      }\n\n      _startOperation(cm);\n\n      try {\n        return f.apply(this, arguments);\n      } finally {\n        _endOperation(cm);\n      }\n    };\n  } // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n\n\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) {\n      from = cm.doc.first;\n    }\n\n    if (to == null) {\n      to = cm.doc.first + cm.doc.size;\n    }\n\n    if (!lendiff) {\n      lendiff = 0;\n    }\n\n    var display = cm.display;\n\n    if (lendiff && to < display.viewTo && (display.updateLineNumbers == null || display.updateLineNumbers > from)) {\n      display.updateLineNumbers = from;\n    }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) {\n      // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo) {\n        resetView(cm);\n      }\n    } else if (to <= display.viewFrom) {\n      // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) {\n      // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) {\n      // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) {\n      // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else {\n      // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index).concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN)).concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n\n    if (ext) {\n      if (to < ext.lineN) {\n        ext.lineN += lendiff;\n      } else if (from < ext.lineN + ext.size) {\n        display.externalMeasured = null;\n      }\n    }\n  } // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n\n\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display,\n        ext = cm.display.externalMeasured;\n\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size) {\n      display.externalMeasured = null;\n    }\n\n    if (line < display.viewFrom || line >= display.viewTo) {\n      return;\n    }\n\n    var lineView = display.view[findViewIndex(cm, line)];\n\n    if (lineView.node == null) {\n      return;\n    }\n\n    var arr = lineView.changes || (lineView.changes = []);\n\n    if (indexOf(arr, type) == -1) {\n      arr.push(type);\n    }\n  } // Clear the view.\n\n\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN),\n        diff,\n        view = cm.display.view;\n\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size) {\n      return {\n        index: index,\n        lineN: newN\n      };\n    }\n\n    var n = cm.display.viewFrom;\n\n    for (var i = 0; i < index; i++) {\n      n += view[i].size;\n    }\n\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) {\n          return null;\n        }\n\n        diff = n + view[index].size - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n\n      oldN += diff;\n      newN += diff;\n    }\n\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) {\n        return null;\n      }\n\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n\n    return {\n      index: index,\n      lineN: newN\n    };\n  } // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n\n\n  function adjustView(cm, from, to) {\n    var display = cm.display,\n        view = display.view;\n\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from) {\n        display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view);\n      } else if (display.viewFrom < from) {\n        display.view = display.view.slice(findViewIndex(cm, from));\n      }\n\n      display.viewFrom = from;\n\n      if (display.viewTo < to) {\n        display.view = display.view.concat(buildViewArray(cm, display.viewTo, to));\n      } else if (display.viewTo > to) {\n        display.view = display.view.slice(0, findViewIndex(cm, to));\n      }\n    }\n\n    display.viewTo = to;\n  } // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n\n\n  function countDirtyView(cm) {\n    var view = cm.display.view,\n        dirty = 0;\n\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) {\n        ++dirty;\n      }\n    }\n\n    return dirty;\n  } // HIGHLIGHT WORKER\n\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo) {\n      cm.state.highlight.set(time, bind(highlightWorker, cm));\n    }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n\n    if (doc.highlightFrontier >= cm.display.viewTo) {\n      return;\n    }\n\n    var end = +new Date() + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) {\n        // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n\n        if (resetState) {\n          context.state = resetState;\n        }\n\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses,\n            newCls = highlighted.classes;\n\n        if (newCls) {\n          line.styleClasses = newCls;\n        } else if (oldCls) {\n          line.styleClasses = null;\n        }\n\n        var ischange = !oldStyles || oldStyles.length != line.styles.length || oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) {\n          ischange = oldStyles[i] != line.styles[i];\n        }\n\n        if (ischange) {\n          changedLines.push(context.line);\n        }\n\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength) {\n          processLine(cm, line.text, context);\n        }\n\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n\n      if (+new Date() > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true;\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n\n    if (changedLines.length) {\n      runInOp(cm, function () {\n        for (var i = 0; i < changedLines.length; i++) {\n          regLineChange(cm, changedLines[i], \"text\");\n        }\n      });\n    }\n  } // DISPLAY DRAWING\n\n\n  var DisplayUpdate = function DisplayUpdate(cm, viewport, force) {\n    var display = cm.display;\n    this.viewport = viewport; // Store some values that we'll need later (but don't want to force a relayout for)\n\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type)) {\n      this.events.push(arguments);\n    }\n  };\n\n  DisplayUpdate.prototype.finish = function () {\n    var this$1 = this;\n\n    for (var i = 0; i < this.events.length; i++) {\n      signal.apply(null, this$1.events[i]);\n    }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) {\n      return null;\n    }\n\n    var active = activeElt();\n\n    if (!active || !contains(cm.display.lineDiv, active)) {\n      return null;\n    }\n\n    var result = {\n      activeElt: active\n    };\n\n    if (window.getSelection) {\n      var sel = window.getSelection();\n\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n\n    return result;\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) {\n      return;\n    }\n\n    snapshot.activeElt.focus();\n\n    if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(),\n          range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  } // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n\n\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display,\n        doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false;\n    } // Bail out if the visible area is already rendered and nothing changed.\n\n\n    if (!update.force && update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo && (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) && display.renderedView == display.view && countDirtyView(cm) == 0) {\n      return false;\n    }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    } // Compute a suitable new viewport (from & to)\n\n\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n\n    if (display.viewFrom < from && from - display.viewFrom < 20) {\n      from = Math.max(doc.first, display.viewFrom);\n    }\n\n    if (display.viewTo > to && display.viewTo - to < 20) {\n      to = Math.min(end, display.viewTo);\n    }\n\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo || display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n    display.viewOffset = _heightAtLine(getLine(cm.doc, display.viewFrom)); // Position the mover div to align with the current scroll position\n\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n    var toUpdate = countDirtyView(cm);\n\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view && (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo)) {\n      return false;\n    } // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n\n\n    var selSnapshot = selectionSnapshot(cm);\n\n    if (toUpdate > 4) {\n      display.lineDiv.style.display = \"none\";\n    }\n\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n\n    if (toUpdate > 4) {\n      display.lineDiv.style.display = \"\";\n    }\n\n    display.renderedView = display.view; // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n\n    restoreSelection(selSnapshot); // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n    return true;\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null) {\n          viewport = {\n            top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)\n          };\n        } // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n\n\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo) {\n          break;\n        }\n      }\n\n      if (!updateDisplayIfNeeded(cm, update)) {\n        break;\n      }\n\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom;\n      cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  } // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n\n\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display,\n        lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv,\n        cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling; // Works around a throw-scroll bug in OS X Webkit\n\n      if (webkit && mac && cm.display.currentWheelTarget == node) {\n        node.style.display = \"none\";\n      } else {\n        node.parentNode.removeChild(node);\n      }\n\n      return next;\n    }\n\n    var view = display.view,\n        lineN = display.viewFrom; // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n\n      if (lineView.hidden) {} else if (!lineView.node || lineView.node.parentNode != container) {\n        // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else {\n        // Already drawn\n        while (cur != lineView.node) {\n          cur = rm(cur);\n        }\n\n        var updateNumber = lineNumbers && updateNumbersFrom != null && updateNumbersFrom <= lineN && lineView.lineNumber;\n\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) {\n            updateNumber = false;\n          }\n\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n\n        cur = lineView.node.nextSibling;\n      }\n\n      lineN += lineView.size;\n    }\n\n    while (cur) {\n      cur = rm(cur);\n    }\n  }\n\n  function updateGutterSpace(cm) {\n    var width = cm.display.gutters.offsetWidth;\n    cm.display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = measure.docHeight + cm.display.barHeight + scrollGap(cm) + \"px\";\n  } // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n\n\n  function updateGutters(cm) {\n    var gutters = cm.display.gutters,\n        specs = cm.options.gutters;\n    removeChildren(gutters);\n    var i = 0;\n\n    for (; i < specs.length; ++i) {\n      var gutterClass = specs[i];\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n\n      if (gutterClass == \"CodeMirror-linenumbers\") {\n        cm.display.lineGutter = gElt;\n        gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n      }\n    }\n\n    gutters.style.display = i ? \"\" : \"none\";\n    updateGutterSpace(cm);\n  } // Make sure the gutters options contains the element\n  // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n\n\n  function setGuttersForLineNumbers(options) {\n    var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n\n    if (found == -1 && options.lineNumbers) {\n      options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n    } else if (found > -1 && !options.lineNumbers) {\n      options.gutters = options.gutters.slice(0);\n      options.gutters.splice(found, 1);\n    }\n  }\n\n  var wheelSamples = 0;\n  var wheelPixelsPerUnit = null; // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n\n  if (ie) {\n    wheelPixelsPerUnit = -.53;\n  } else if (gecko) {\n    wheelPixelsPerUnit = 15;\n  } else if (chrome) {\n    wheelPixelsPerUnit = -.7;\n  } else if (safari) {\n    wheelPixelsPerUnit = -1 / 3;\n  }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX,\n        dy = e.wheelDeltaY;\n\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) {\n      dx = e.detail;\n    }\n\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) {\n      dy = e.detail;\n    } else if (dy == null) {\n      dy = e.wheelDelta;\n    }\n\n    return {\n      x: dx,\n      y: dy\n    };\n  }\n\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta;\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e),\n        dx = delta.x,\n        dy = delta.y;\n    var display = cm.display,\n        scroll = display.scroller; // Quit if there's nothing to scroll here\n\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n\n    if (!(dx && canScrollX || dy && canScrollY)) {\n      return;\n    } // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n\n\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer;\n          }\n        }\n      }\n    } // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n\n\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY) {\n        updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit));\n      }\n\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit)); // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n\n      if (!dy || dy && canScrollY) {\n        e_preventDefault(e);\n      }\n\n      display.wheelStartX = null; // Abort measurement, if in progress\n\n      return;\n    } // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n\n\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop,\n          bot = top + display.wrapper.clientHeight;\n\n      if (pixels < 0) {\n        top = Math.max(0, top + pixels - 50);\n      } else {\n        bot = Math.min(cm.doc.height, bot + pixels + 50);\n      }\n\n      updateDisplaySimple(cm, {\n        top: top,\n        bottom: bot\n      });\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft;\n        display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx;\n        display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) {\n            return;\n          }\n\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = movedY && display.wheelDY && movedY / display.wheelDY || movedX && display.wheelDX && movedX / display.wheelDX;\n          display.wheelStartX = display.wheelStartY = null;\n\n          if (!sample) {\n            return;\n          }\n\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx;\n        display.wheelDY += dy;\n      }\n    }\n  } // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n\n\n  var Selection = function Selection(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () {\n    return this.ranges[this.primIndex];\n  };\n\n  Selection.prototype.equals = function (other) {\n    var this$1 = this;\n\n    if (other == this) {\n      return true;\n    }\n\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) {\n      return false;\n    }\n\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this$1.ranges[i],\n          there = other.ranges[i];\n\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var this$1 = this;\n    var out = [];\n\n    for (var i = 0; i < this.ranges.length; i++) {\n      out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head));\n    }\n\n    return new Selection(out, this.primIndex);\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    var this$1 = this;\n\n    for (var i = 0; i < this.ranges.length; i++) {\n      if (!this$1.ranges[i].empty()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    var this$1 = this;\n\n    if (!end) {\n      end = pos;\n    }\n\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this$1.ranges[i];\n\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var Range = function Range(anchor, head) {\n    this.anchor = anchor;\n    this.head = head;\n  };\n\n  Range.prototype.from = function () {\n    return minPos(this.anchor, this.head);\n  };\n\n  Range.prototype.to = function () {\n    return maxPos(this.anchor, this.head);\n  };\n\n  Range.prototype.empty = function () {\n    return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch;\n  }; // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n\n\n  function normalizeSelection(ranges, primIndex) {\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) {\n      return cmp(a.from(), b.from());\n    });\n    primIndex = indexOf(ranges, prim);\n\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i],\n          prev = ranges[i - 1];\n\n      if (cmp(prev.to(), cur.from()) >= 0) {\n        var from = minPos(prev.from(), cur.from()),\n            to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n\n        if (i <= primIndex) {\n          --primIndex;\n        }\n\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n\n    return new Selection(ranges, primIndex);\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0);\n  } // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n\n\n  function changeEnd(change) {\n    if (!change.text) {\n      return change.to;\n    }\n\n    return Pos(change.from.line + change.text.length - 1, lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));\n  } // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n\n\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) {\n      return pos;\n    }\n\n    if (cmp(pos, change.to) <= 0) {\n      return changeEnd(change);\n    }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1,\n        ch = pos.ch;\n\n    if (pos.line == change.to.line) {\n      ch += changeEnd(change).ch - change.to.ch;\n    }\n\n    return Pos(line, ch);\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change), adjustForChange(range.head, change)));\n    }\n\n    return normalizeSelection(out, doc.sel.primIndex);\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line) {\n      return Pos(nw.line, pos.ch - old.ch + nw.ch);\n    } else {\n      return Pos(nw.line + (pos.line - old.line), pos.ch);\n    }\n  } // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n\n\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0),\n        newPrev = oldPrev;\n\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i],\n            inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n\n    return new Selection(out, doc.sel.primIndex);\n  } // Used to get the editor into a consistent state again when options change.\n\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) {\n        line.stateAfter = null;\n      }\n\n      if (line.styles) {\n        line.styles = null;\n      }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n\n    if (cm.curOp) {\n      regChange(cm);\n    }\n  } // DOCUMENT DATA STRUCTURE\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n\n\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" && (!doc.cm || doc.cm.options.wholeLineUpdateBefore);\n  } // Perform a change on the document data structure.\n\n\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {\n      return markedSpans ? markedSpans[n] : null;\n    }\n\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n\n    function linesFor(start, end) {\n      var result = [];\n\n      for (var i = start; i < end; ++i) {\n        result.push(new Line(text[i], spansFor(i), estimateHeight));\n      }\n\n      return result;\n    }\n\n    var from = change.from,\n        to = change.to,\n        text = change.text;\n    var firstLine = getLine(doc, from.line),\n        lastLine = getLine(doc, to.line);\n    var lastText = lst(text),\n        lastSpans = spansFor(text.length - 1),\n        nlines = to.line - from.line; // Adjust the line structure\n\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n\n      if (nlines) {\n        doc.remove(from.line, nlines);\n      }\n\n      if (added.length) {\n        doc.insert(from.line, added);\n      }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n\n      if (nlines > 1) {\n        doc.remove(from.line + 1, nlines - 1);\n      }\n\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  } // Call f for all linked documents.\n\n\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) {\n        for (var i = 0; i < doc.linked.length; ++i) {\n          var rel = doc.linked[i];\n\n          if (rel.doc == skip) {\n            continue;\n          }\n\n          var shared = sharedHist && rel.sharedHist;\n\n          if (sharedHistOnly && !shared) {\n            continue;\n          }\n\n          f(rel.doc, shared);\n          propagate(rel.doc, doc, shared);\n        }\n      }\n    }\n\n    propagate(doc, null, true);\n  } // Attach a document to an editor.\n\n\n  function attachDoc(cm, doc) {\n    if (doc.cm) {\n      throw new Error(\"This document is already in use.\");\n    }\n\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n\n    if (!cm.options.lineWrapping) {\n      findMaxLine(cm);\n    }\n\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n    ;\n    (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = [];\n    this.undone = [];\n    this.undoDepth = Infinity; // Used to track when changes can be merged into a single undo\n    // event\n\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null; // Used by the isClean() method\n\n    this.generation = this.maxGeneration = startGen || 1;\n  } // Create a history change event from an updateDoc-style change\n  // object.\n\n\n  function historyChangeFromChange(doc, change) {\n    var histChange = {\n      from: copyPos(change.from),\n      to: changeEnd(change),\n      text: getBetween(doc, change.from, change.to)\n    };\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) {\n      return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    }, true);\n    return histChange;\n  } // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n\n\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n\n      if (last.ranges) {\n        array.pop();\n      } else {\n        break;\n      }\n    }\n  } // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n\n\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done);\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done);\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done);\n    }\n  } // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n\n\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date(),\n        cur;\n    var last;\n\n    if ((hist.lastOp == opId || hist.lastOrigin == change.origin && change.origin && (change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500) || change.origin.charAt(0) == \"*\")) && (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n\n      if (!before || !before.ranges) {\n        pushSelectionToHistory(doc.sel, hist.done);\n      }\n\n      cur = {\n        changes: [historyChangeFromChange(doc, change)],\n        generation: hist.generation\n      };\n      hist.done.push(cur);\n\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n\n        if (!hist.done[0].ranges) {\n          hist.done.shift();\n        }\n      }\n    }\n\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) {\n      signal(doc, \"historyAdded\");\n    }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" || ch == \"+\" && prev.ranges.length == sel.ranges.length && prev.somethingSelected() == sel.somethingSelected() && new Date() - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500);\n  } // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n\n\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history,\n        origin = options && options.origin; // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n\n    if (opId == hist.lastSelOp || origin && hist.lastSelOrigin == origin && (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin || selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))) {\n      hist.done[hist.done.length - 1] = sel;\n    } else {\n      pushSelectionToHistory(sel, hist.done);\n    }\n\n    hist.lastSelTime = +new Date();\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n\n    if (options && options.clearRedo !== false) {\n      clearSelectionEvents(hist.undone);\n    }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n\n    if (!(top && top.ranges && top.equals(sel))) {\n      dest.push(sel);\n    }\n  } // Used to store marked span information in the history.\n\n\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id],\n        n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans) {\n        (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans;\n      }\n\n      ++n;\n    });\n  } // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n\n\n  function removeClearedSpans(spans) {\n    if (!spans) {\n      return null;\n    }\n\n    var out;\n\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) {\n        if (!out) {\n          out = spans.slice(0, i);\n        }\n      } else if (out) {\n        out.push(spans[i]);\n      }\n    }\n\n    return !out ? spans : out.length ? out : null;\n  } // Retrieve and filter the old marked spans stored in a change event.\n\n\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n\n    if (!found) {\n      return null;\n    }\n\n    var nw = [];\n\n    for (var i = 0; i < change.text.length; ++i) {\n      nw.push(removeClearedSpans(found[i]));\n    }\n\n    return nw;\n  } // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n\n\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n\n    if (!old) {\n      return stretched;\n    }\n\n    if (!stretched) {\n      return old;\n    }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i],\n          stretchCur = stretched[i];\n\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n\n          for (var k = 0; k < oldCur.length; ++k) {\n            if (oldCur[k].marker == span.marker) {\n              continue spans;\n            }\n          }\n\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n\n    return old;\n  } // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n\n\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue;\n      }\n\n      var changes = event.changes,\n          newChanges = [];\n      copy.push({\n        changes: newChanges\n      });\n\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j],\n            m = void 0;\n        newChanges.push({\n          from: change.from,\n          to: change.to,\n          text: change.text\n        });\n\n        if (newGroup) {\n          for (var prop in change) {\n            if (m = prop.match(/^spans_(\\d+)$/)) {\n              if (indexOf(newGroup, Number(m[1])) > -1) {\n                lst(newChanges)[prop] = change[prop];\n                delete change[prop];\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return copy;\n  } // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n\n\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n\n        if (posBefore != cmp(other, anchor) < 0) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != cmp(head, other) < 0) {\n          head = other;\n        }\n      }\n\n      return new Range(anchor, head);\n    } else {\n      return new Range(other || head, head);\n    }\n  } // Extend the primary selection range, discard the rest.\n\n\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) {\n      extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    }\n\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  } // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n\n\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend);\n    }\n\n    var newSel = normalizeSelection(out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  } // Updates a single range in the selection.\n\n\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n  } // Reset the selection to a single range.\n\n\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  } // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n\n\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function update(ranges) {\n        var this$1 = this;\n        this.ranges = [];\n\n        for (var i = 0; i < ranges.length; i++) {\n          this$1.ranges[i] = new Range(_clipPos(doc, ranges[i].anchor), _clipPos(doc, ranges[i].head));\n        }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n\n    if (doc.cm) {\n      signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj);\n    }\n\n    if (obj.ranges != sel.ranges) {\n      return normalizeSelection(obj.ranges, obj.ranges.length - 1);\n    } else {\n      return sel;\n    }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done,\n        last = lst(done);\n\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  } // Set a new selection.\n\n\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\")) {\n      sel = filterSelectionChange(doc, sel, options);\n    }\n\n    var bias = options && options.bias || (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm) {\n      ensureCursorVisible(doc.cm);\n    }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) {\n      return;\n    }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n\n    signalLater(doc, \"cursorActivity\", doc);\n  } // Verify that the selection does not partially select any atomic\n  // marked ranges.\n\n\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  } // Return a selection that does not partially select any atomic\n  // ranges.\n\n\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) {\n          out = sel.ranges.slice(0, i);\n        }\n\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n\n    return out ? normalizeSelection(out, sel.primIndex) : sel;\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n\n    if (line.markedSpans) {\n      for (var i = 0; i < line.markedSpans.length; ++i) {\n        var sp = line.markedSpans[i],\n            m = sp.marker;\n\n        if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) && (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n          if (mayClear) {\n            signal(m, \"beforeCursorEnter\");\n\n            if (m.explicitlyCleared) {\n              if (!line.markedSpans) {\n                break;\n              } else {\n                --i;\n                continue;\n              }\n            }\n          }\n\n          if (!m.atomic) {\n            continue;\n          }\n\n          if (oldPos) {\n            var near = m.find(dir < 0 ? 1 : -1),\n                diff = void 0;\n\n            if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft) {\n              near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null);\n            }\n\n            if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0)) {\n              return skipAtomicInner(doc, near, pos, dir, mayClear);\n            }\n          }\n\n          var far = m.find(dir < 0 ? -1 : 1);\n\n          if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight) {\n            far = movePos(doc, far, dir, far.line == pos.line ? line : null);\n          }\n\n          return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null;\n        }\n      }\n    }\n\n    return pos;\n  } // Ensure a given position is not inside an atomic range.\n\n\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) || !mayClear && skipAtomicInner(doc, pos, oldPos, dir, true) || skipAtomicInner(doc, pos, oldPos, -dir, mayClear) || !mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true);\n\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0);\n    }\n\n    return found;\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) {\n        return _clipPos(doc, Pos(pos.line - 1));\n      } else {\n        return null;\n      }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) {\n        return Pos(pos.line + 1, 0);\n      } else {\n        return null;\n      }\n    } else {\n      return new Pos(pos.line, pos.ch + dir);\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  } // UPDATING\n  // Allow \"beforeChange\" event handlers to influence a change\n\n\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function cancel() {\n        return obj.canceled = true;\n      }\n    };\n\n    if (update) {\n      obj.update = function (from, to, text, origin) {\n        if (from) {\n          obj.from = _clipPos(doc, from);\n        }\n\n        if (to) {\n          obj.to = _clipPos(doc, to);\n        }\n\n        if (text) {\n          obj.text = text;\n        }\n\n        if (origin !== undefined) {\n          obj.origin = origin;\n        }\n      };\n    }\n\n    signal(doc, \"beforeChange\", doc, obj);\n\n    if (doc.cm) {\n      signal(doc.cm, \"beforeChange\", doc.cm, obj);\n    }\n\n    if (obj.canceled) {\n      return null;\n    }\n\n    return {\n      from: obj.from,\n      to: obj.to,\n      text: obj.text,\n      origin: obj.origin\n    };\n  } // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n\n\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) {\n        return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly);\n      }\n\n      if (doc.cm.state.suppressEdits) {\n        return;\n      }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n\n      if (!change) {\n        return;\n      }\n    } // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n\n\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i) {\n        makeChangeInner(doc, {\n          from: split[i].from,\n          to: split[i].to,\n          text: i ? [\"\"] : change.text,\n          origin: change.origin\n        });\n      }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) {\n      return;\n    }\n\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  } // Revert a change stored in a document's history.\n\n\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n\n    if (suppress && !allowSelectionOnly) {\n      return;\n    }\n\n    var hist = doc.history,\n        event,\n        selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone,\n        dest = type == \"undo\" ? hist.undone : hist.done; // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n\n    var i = 0;\n\n    for (; i < source.length; i++) {\n      event = source[i];\n\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges) {\n        break;\n      }\n    }\n\n    if (i == source.length) {\n      return;\n    }\n\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {\n            clearRedo: false\n          });\n          return;\n        }\n\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return;\n      } else {\n        break;\n      }\n    } // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n\n\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({\n      changes: antiChanges,\n      generation: hist.generation\n    });\n    hist.generation = event.generation || ++hist.maxGeneration;\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function loop(i) {\n      var change = event.changes[i];\n      change.origin = type;\n\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {};\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n\n      if (!i && doc.cm) {\n        doc.cm.scrollIntoView({\n          from: change.from,\n          to: changeEnd(change)\n        });\n      }\n\n      var rebased = []; // Propagate to the linked documents\n\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop(i$1);\n      if (returned) return returned.v;\n    }\n  } // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n\n\n  function shiftDoc(doc, distance) {\n    if (distance == 0) {\n      return;\n    }\n\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) {\n      return new Range(Pos(range.anchor.line + distance, range.anchor.ch), Pos(range.head.line + distance, range.head.ch));\n    }), doc.sel.primIndex);\n\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++) {\n        regLineChange(doc.cm, l, \"gutter\");\n      }\n    }\n  } // More lower-level change function, handling only a single document\n  // (not linked ones).\n\n\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp) {\n      return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);\n    }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return;\n    }\n\n    if (change.from.line > doc.lastLine()) {\n      return;\n    } // Clip the change to the size of this doc\n\n\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {\n        from: Pos(doc.first, 0),\n        to: Pos(change.to.line + shift, change.to.ch),\n        text: [lst(change.text)],\n        origin: change.origin\n      };\n    }\n\n    var last = doc.lastLine();\n\n    if (change.to.line > last) {\n      change = {\n        from: change.from,\n        to: Pos(last, getLine(doc, last).text.length),\n        text: [change.text[0]],\n        origin: change.origin\n      };\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) {\n      selAfter = computeSelAfterChange(doc, change);\n    }\n\n    if (doc.cm) {\n      makeChangeSingleDocInEditor(doc.cm, change, spans);\n    } else {\n      updateDoc(doc, change, spans);\n    }\n\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n  } // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n\n\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc,\n        display = cm.display,\n        from = change.from,\n        to = change.to;\n    var recomputeMaxLength = false,\n        checkWidthStart = from.line;\n\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true;\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1) {\n      signalCursorActivity(cm);\n    }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n\n      if (recomputeMaxLength) {\n        cm.curOp.updateMaxLine = true;\n      }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n    var lendiff = change.text.length - (to.line - from.line) - 1; // Remember that these lines changed, for updating the display\n\n    if (change.full) {\n      regChange(cm);\n    } else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change)) {\n      regLineChange(cm, from.line, \"text\");\n    } else {\n      regChange(cm, from.line, to.line + 1, lendiff);\n    }\n\n    var changesHandler = hasHandler(cm, \"changes\"),\n        changeHandler = hasHandler(cm, \"change\");\n\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from,\n        to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n\n      if (changeHandler) {\n        signalLater(cm, \"change\", cm, obj);\n      }\n\n      if (changesHandler) {\n        (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj);\n      }\n    }\n\n    cm.display.selForContextMenu = null;\n  }\n\n  function _replaceRange(doc, code, from, to, origin) {\n    if (!to) {\n      to = from;\n    }\n\n    if (cmp(to, from) < 0) {\n      var assign;\n      assign = [to, from], from = assign[0], to = assign[1], assign;\n    }\n\n    if (typeof code == \"string\") {\n      code = doc.splitLines(code);\n    }\n\n    makeChange(doc, {\n      from: from,\n      to: to,\n      text: code,\n      origin: origin\n    });\n  } // Rebasing/resetting history to deal with externally-sourced changes\n\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  } // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n\n\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i],\n          ok = true;\n\n      if (sub.ranges) {\n        if (!sub.copied) {\n          sub = array[i] = sub.deepCopy();\n          sub.copied = true;\n        }\n\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n\n        continue;\n      }\n\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break;\n        }\n      }\n\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line,\n        to = change.to.line,\n        diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  } // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n\n\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle,\n        line = handle;\n\n    if (typeof handle == \"number\") {\n      line = getLine(doc, clipLine(doc, handle));\n    } else {\n      no = lineNo(handle);\n    }\n\n    if (no == null) {\n      return null;\n    }\n\n    if (op(line, no) && doc.cm) {\n      regLineChange(doc.cm, no, changeType);\n    }\n\n    return line;\n  } // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n\n  function LeafChunk(lines) {\n    var this$1 = this;\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this$1;\n      height += lines[i].height;\n    }\n\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function chunkSize() {\n      return this.lines.length;\n    },\n    // Remove the n lines at offset 'at'.\n    removeInner: function removeInner(at, n) {\n      var this$1 = this;\n\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this$1.lines[i];\n        this$1.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n\n      this.lines.splice(at, n);\n    },\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function collapse(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function insertInner(at, lines, height) {\n      var this$1 = this;\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n\n      for (var i = 0; i < lines.length; ++i) {\n        lines[i].parent = this$1;\n      }\n    },\n    // Used to iterate over a part of the tree.\n    iterN: function iterN(at, n, op) {\n      var this$1 = this;\n\n      for (var e = at + n; at < e; ++at) {\n        if (op(this$1.lines[at])) {\n          return true;\n        }\n      }\n    }\n  };\n\n  function BranchChunk(children) {\n    var this$1 = this;\n    this.children = children;\n    var size = 0,\n        height = 0;\n\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize();\n      height += ch.height;\n      ch.parent = this$1;\n    }\n\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function chunkSize() {\n      return this.size;\n    },\n    removeInner: function removeInner(at, n) {\n      var this$1 = this;\n      this.size -= n;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i],\n            sz = child.chunkSize();\n\n        if (at < sz) {\n          var rm = Math.min(n, sz - at),\n              oldHeight = child.height;\n          child.removeInner(at, rm);\n          this$1.height -= oldHeight - child.height;\n\n          if (sz == rm) {\n            this$1.children.splice(i--, 1);\n            child.parent = null;\n          }\n\n          if ((n -= rm) == 0) {\n            break;\n          }\n\n          at = 0;\n        } else {\n          at -= sz;\n        }\n      } // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n\n\n      if (this.size - n < 25 && (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n    collapse: function collapse(lines) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        this$1.children[i].collapse(lines);\n      }\n    },\n    insertInner: function insertInner(at, lines, height) {\n      var this$1 = this;\n      this.size += lines.length;\n      this.height += height;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i],\n            sz = child.chunkSize();\n\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this$1.children.splice(++i, 0, leaf);\n              leaf.parent = this$1;\n            }\n\n            child.lines = child.lines.slice(0, remaining);\n            this$1.maybeSpill();\n          }\n\n          break;\n        }\n\n        at -= sz;\n      }\n    },\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function maybeSpill() {\n      if (this.children.length <= 10) {\n        return;\n      }\n\n      var me = this;\n\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n\n        if (!me.parent) {\n          // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n        } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n\n        sibling.parent = me.parent;\n      } while (me.children.length > 10);\n\n      me.parent.maybeSpill();\n    },\n    iterN: function iterN(at, n, op) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i],\n            sz = child.chunkSize();\n\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n\n          if (child.iterN(at, used, op)) {\n            return true;\n          }\n\n          if ((n -= used) == 0) {\n            break;\n          }\n\n          at = 0;\n        } else {\n          at -= sz;\n        }\n      }\n    } // Line widgets are block elements displayed above or below a line.\n\n  };\n\n  var LineWidget = function LineWidget(doc, node, options) {\n    var this$1 = this;\n\n    if (options) {\n      for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n          this$1[opt] = options[opt];\n        }\n      }\n    }\n\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var this$1 = this;\n    var cm = this.doc.cm,\n        ws = this.line.widgets,\n        line = this.line,\n        no = lineNo(line);\n\n    if (no == null || !ws) {\n      return;\n    }\n\n    for (var i = 0; i < ws.length; ++i) {\n      if (ws[i] == this$1) {\n        ws.splice(i--, 1);\n      }\n    }\n\n    if (!ws.length) {\n      line.widgets = null;\n    }\n\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n    var this$1 = this;\n    var oldH = this.height,\n        cm = this.doc.cm,\n        line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n\n    if (!diff) {\n      return;\n    }\n\n    if (!lineIsHidden(this.doc, line)) {\n      updateLineHeight(line, line.height + diff);\n    }\n\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (_heightAtLine(line) < (cm.curOp && cm.curOp.scrollTop || cm.doc.scrollTop)) {\n      addToScrollTop(cm, diff);\n    }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n\n    if (cm && widget.noHScroll) {\n      cm.display.alignWidgets = true;\n    }\n\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n\n      if (widget.insertAt == null) {\n        widgets.push(widget);\n      } else {\n        widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget);\n      }\n\n      widget.line = line;\n\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = _heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n\n        if (aboveVisible) {\n          addToScrollTop(cm, widget.height);\n        }\n\n        cm.curOp.forceUpdate = true;\n      }\n\n      return true;\n    });\n\n    if (cm) {\n      signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle));\n    }\n\n    return widget;\n  } // TEXTMARKERS\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n\n\n  var nextMarkerId = 0;\n\n  var TextMarker = function TextMarker(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  }; // Clear the marker.\n\n\n  TextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n    if (this.explicitlyCleared) {\n      return;\n    }\n\n    var cm = this.doc.cm,\n        withOp = cm && !cm.curOp;\n\n    if (withOp) {\n      _startOperation(cm);\n    }\n\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n\n      if (found) {\n        signalLater(this, \"clear\", found.from, found.to);\n      }\n    }\n\n    var min = null,\n        max = null;\n\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n\n      if (cm && !this$1.collapsed) {\n        regLineChange(cm, lineNo(line), \"text\");\n      } else if (cm) {\n        if (span.to != null) {\n          max = lineNo(line);\n        }\n\n        if (span.from != null) {\n          min = lineNo(line);\n        }\n      }\n\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n\n      if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm) {\n        updateLineHeight(line, textHeight(cm.display));\n      }\n    }\n\n    if (cm && this.collapsed && !cm.options.lineWrapping) {\n      for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n        var visual = visualLine(this$1.lines[i$1]),\n            len = lineLength(visual);\n\n        if (len > cm.display.maxLineLength) {\n          cm.display.maxLine = visual;\n          cm.display.maxLineLength = len;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n\n    if (min != null && cm && this.collapsed) {\n      regChange(cm, min, max + 1);\n    }\n\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n\n      if (cm) {\n        reCheckSelection(cm.doc);\n      }\n    }\n\n    if (cm) {\n      signalLater(cm, \"markerCleared\", cm, this, min, max);\n    }\n\n    if (withOp) {\n      _endOperation(cm);\n    }\n\n    if (this.parent) {\n      this.parent.clear();\n    }\n  }; // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n\n\n  TextMarker.prototype.find = function (side, lineObj) {\n    var this$1 = this;\n\n    if (side == null && this.type == \"bookmark\") {\n      side = 1;\n    }\n\n    var from, to;\n\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n\n        if (side == -1) {\n          return from;\n        }\n      }\n\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n\n        if (side == 1) {\n          return to;\n        }\n      }\n    }\n\n    return from && {\n      from: from,\n      to: to\n    };\n  }; // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n\n\n  TextMarker.prototype.changed = function () {\n    var this$1 = this;\n    var pos = this.find(-1, true),\n        widget = this,\n        cm = this.doc.cm;\n\n    if (!pos || !cm) {\n      return;\n    }\n\n    runInOp(cm, function () {\n      var line = pos.line,\n          lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n\n      cm.curOp.updateMaxLine = true;\n\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n\n        if (dHeight) {\n          updateLineHeight(line, line.height + dHeight);\n        }\n      }\n\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1) {\n        (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this);\n      }\n    }\n\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      (op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n\n  eventMixin(TextMarker); // Create a marker, wire it up to the right lines, and\n\n  function _markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) {\n      return markTextShared(doc, from, to, options, type);\n    } // Ensure we are in an operation.\n\n\n    if (doc.cm && !doc.cm.curOp) {\n      return operation(doc.cm, _markText)(doc, from, to, options, type);\n    }\n\n    var marker = new TextMarker(doc, type),\n        diff = cmp(from, to);\n\n    if (options) {\n      copyObj(options, marker, false);\n    } // Don't connect empty markers unless clearWhenEmpty is false\n\n\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false) {\n      return marker;\n    }\n\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n\n      if (!options.handleMouseEvents) {\n        marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\");\n      }\n\n      if (options.insertLeft) {\n        marker.widgetNode.insertLeft = true;\n      }\n    }\n\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) || from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker)) {\n        throw new Error(\"Inserting collapsed marker partially overlapping an existing one\");\n      }\n\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory) {\n      addChangeToHistory(doc, {\n        from: from,\n        to: to,\n        origin: \"markText\"\n      }, doc.sel, NaN);\n    }\n\n    var curLine = from.line,\n        cm = doc.cm,\n        updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine) {\n        updateMaxLine = true;\n      }\n\n      if (marker.collapsed && curLine != from.line) {\n        updateLineHeight(line, 0);\n      }\n\n      addMarkedSpan(line, new MarkedSpan(marker, curLine == from.line ? from.ch : null, curLine == to.line ? to.ch : null));\n      ++curLine;\n    }); // lineIsHidden depends on the presence of the spans, so needs a second pass\n\n    if (marker.collapsed) {\n      doc.iter(from.line, to.line + 1, function (line) {\n        if (lineIsHidden(doc, line)) {\n          updateLineHeight(line, 0);\n        }\n      });\n    }\n\n    if (marker.clearOnEnter) {\n      on(marker, \"beforeCursorEnter\", function () {\n        return marker.clear();\n      });\n    }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n\n      if (doc.history.done.length || doc.history.undone.length) {\n        doc.clearHistory();\n      }\n    }\n\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) {\n        cm.curOp.updateMaxLine = true;\n      }\n\n      if (marker.collapsed) {\n        regChange(cm, from.line, to.line + 1);\n      } else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css) {\n        for (var i = from.line; i <= to.line; i++) {\n          regLineChange(cm, i, \"text\");\n        }\n      }\n\n      if (marker.atomic) {\n        reCheckSelection(cm.doc);\n      }\n\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n\n    return marker;\n  } // SHARED TEXTMARKERS\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n\n\n  var SharedTextMarker = function SharedTextMarker(markers, primary) {\n    var this$1 = this;\n    this.markers = markers;\n    this.primary = primary;\n\n    for (var i = 0; i < markers.length; ++i) {\n      markers[i].parent = this$1;\n    }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n    if (this.explicitlyCleared) {\n      return;\n    }\n\n    this.explicitlyCleared = true;\n\n    for (var i = 0; i < this.markers.length; ++i) {\n      this$1.markers[i].clear();\n    }\n\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj);\n  };\n\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [_markText(doc, from, to, options, type)],\n        primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) {\n        options.widgetNode = widget.cloneNode(true);\n      }\n\n      markers.push(_markText(doc, _clipPos(doc, from), _clipPos(doc, to), options, type));\n\n      for (var i = 0; i < doc.linked.length; ++i) {\n        if (doc.linked[i].isParent) {\n          return;\n        }\n      }\n\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary);\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) {\n      return m.parent;\n    });\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i],\n          pos = marker.find();\n      var mFrom = doc.clipPos(pos.from),\n          mTo = doc.clipPos(pos.to);\n\n      if (cmp(mFrom, mTo)) {\n        var subMark = _markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function loop(i) {\n      var marker = markers[i],\n          linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) {\n        return linked.push(d);\n      });\n\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) {\n      loop(i);\n    }\n  }\n\n  var nextDocId = 0;\n\n  var Doc = function Doc(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) {\n      return new Doc(text, mode, firstLine, lineSep, direction);\n    }\n\n    if (firstLine == null) {\n      firstLine = 0;\n    }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = direction == \"rtl\" ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") {\n      text = this.splitLines(text);\n    }\n\n    updateDoc(this, {\n      from: start,\n      to: start,\n      text: text\n    });\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function iter(from, to, op) {\n      if (op) {\n        this.iterN(from - this.first, to - from, op);\n      } else {\n        this.iterN(this.first, this.first + this.size, from);\n      }\n    },\n    // Non-public interface for adding and removing lines.\n    insert: function insert(at, lines) {\n      var height = 0;\n\n      for (var i = 0; i < lines.length; ++i) {\n        height += lines[i].height;\n      }\n\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function remove(at, n) {\n      this.removeInner(at - this.first, n);\n    },\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n    getValue: function getValue(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n\n      if (lineSep === false) {\n        return lines;\n      }\n\n      return lines.join(lineSep || this.lineSeparator());\n    },\n    setValue: docMethodOp(function (code) {\n      var top = Pos(this.first, 0),\n          last = this.first + this.size - 1;\n      makeChange(this, {\n        from: top,\n        to: Pos(last, getLine(this, last).text.length),\n        text: this.splitLines(code),\n        origin: \"setValue\",\n        full: true\n      }, true);\n\n      if (this.cm) {\n        scrollToCoords(this.cm, 0, 0);\n      }\n\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function replaceRange(code, from, to, origin) {\n      from = _clipPos(this, from);\n      to = to ? _clipPos(this, to) : from;\n\n      _replaceRange(this, code, from, to, origin);\n    },\n    getRange: function getRange(from, to, lineSep) {\n      var lines = getBetween(this, _clipPos(this, from), _clipPos(this, to));\n\n      if (lineSep === false) {\n        return lines;\n      }\n\n      return lines.join(lineSep || this.lineSeparator());\n    },\n    getLine: function getLine(line) {\n      var l = this.getLineHandle(line);\n      return l && l.text;\n    },\n    getLineHandle: function getLineHandle(line) {\n      if (isLine(this, line)) {\n        return getLine(this, line);\n      }\n    },\n    getLineNumber: function getLineNumber(line) {\n      return lineNo(line);\n    },\n    getLineHandleVisualStart: function getLineHandleVisualStart(line) {\n      if (typeof line == \"number\") {\n        line = getLine(this, line);\n      }\n\n      return visualLine(line);\n    },\n    lineCount: function lineCount() {\n      return this.size;\n    },\n    firstLine: function firstLine() {\n      return this.first;\n    },\n    lastLine: function lastLine() {\n      return this.first + this.size - 1;\n    },\n    clipPos: function clipPos(pos) {\n      return _clipPos(this, pos);\n    },\n    getCursor: function getCursor(start) {\n      var range = this.sel.primary(),\n          pos;\n\n      if (start == null || start == \"head\") {\n        pos = range.head;\n      } else if (start == \"anchor\") {\n        pos = range.anchor;\n      } else if (start == \"end\" || start == \"to\" || start === false) {\n        pos = range.to();\n      } else {\n        pos = range.from();\n      }\n\n      return pos;\n    },\n    listSelections: function listSelections() {\n      return this.sel.ranges;\n    },\n    somethingSelected: function somethingSelected() {\n      return this.sel.somethingSelected();\n    },\n    setCursor: docMethodOp(function (line, ch, options) {\n      setSimpleSelection(this, _clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function (anchor, head, options) {\n      setSimpleSelection(this, _clipPos(this, anchor), _clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function (head, other, options) {\n      extendSelection(this, _clipPos(this, head), other && _clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function (heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function (f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function (ranges, primary, options) {\n      var this$1 = this;\n\n      if (!ranges.length) {\n        return;\n      }\n\n      var out = [];\n\n      for (var i = 0; i < ranges.length; i++) {\n        out[i] = new Range(_clipPos(this$1, ranges[i].anchor), _clipPos(this$1, ranges[i].head));\n      }\n\n      if (primary == null) {\n        primary = Math.min(ranges.length - 1, this.sel.primIndex);\n      }\n\n      setSelection(this, normalizeSelection(out, primary), options);\n    }),\n    addSelection: docMethodOp(function (anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(_clipPos(this, anchor), _clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n    }),\n    getSelection: function getSelection(lineSep) {\n      var this$1 = this;\n      var ranges = this.sel.ranges,\n          lines;\n\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n\n      if (lineSep === false) {\n        return lines;\n      } else {\n        return lines.join(lineSep || this.lineSeparator());\n      }\n    },\n    getSelections: function getSelections(lineSep) {\n      var this$1 = this;\n      var parts = [],\n          ranges = this.sel.ranges;\n\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n\n        if (lineSep !== false) {\n          sel = sel.join(lineSep || this$1.lineSeparator());\n        }\n\n        parts[i] = sel;\n      }\n\n      return parts;\n    },\n    replaceSelection: function replaceSelection(code, collapse, origin) {\n      var dup = [];\n\n      for (var i = 0; i < this.sel.ranges.length; i++) {\n        dup[i] = code;\n      }\n\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function (code, collapse, origin) {\n      var this$1 = this;\n      var changes = [],\n          sel = this.sel;\n\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {\n          from: range.from(),\n          to: range.to(),\n          text: this$1.splitLines(code[i]),\n          origin: origin\n        };\n      }\n\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--) {\n        makeChange(this$1, changes[i$1]);\n      }\n\n      if (newSel) {\n        setSelectionReplaceHistory(this, newSel);\n      } else if (this.cm) {\n        ensureCursorVisible(this.cm);\n      }\n    }),\n    undo: docMethodOp(function () {\n      makeChangeFromHistory(this, \"undo\");\n    }),\n    redo: docMethodOp(function () {\n      makeChangeFromHistory(this, \"redo\");\n    }),\n    undoSelection: docMethodOp(function () {\n      makeChangeFromHistory(this, \"undo\", true);\n    }),\n    redoSelection: docMethodOp(function () {\n      makeChangeFromHistory(this, \"redo\", true);\n    }),\n    setExtending: function setExtending(val) {\n      this.extend = val;\n    },\n    getExtending: function getExtending() {\n      return this.extend;\n    },\n    historySize: function historySize() {\n      var hist = this.history,\n          done = 0,\n          undone = 0;\n\n      for (var i = 0; i < hist.done.length; i++) {\n        if (!hist.done[i].ranges) {\n          ++done;\n        }\n      }\n\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) {\n        if (!hist.undone[i$1].ranges) {\n          ++undone;\n        }\n      }\n\n      return {\n        undo: done,\n        redo: undone\n      };\n    },\n    clearHistory: function clearHistory() {\n      this.history = new History(this.history.maxGeneration);\n    },\n    markClean: function markClean() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function changeGeneration(forceSplit) {\n      if (forceSplit) {\n        this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null;\n      }\n\n      return this.history.generation;\n    },\n    isClean: function isClean(gen) {\n      return this.history.generation == (gen || this.cleanGeneration);\n    },\n    getHistory: function getHistory() {\n      return {\n        done: copyHistoryArray(this.history.done),\n        undone: copyHistoryArray(this.history.undone)\n      };\n    },\n    setHistory: function setHistory(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n    setGutterMarker: docMethodOp(function (line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n\n        if (!value && isEmpty(markers)) {\n          line.gutterMarkers = null;\n        }\n\n        return true;\n      });\n    }),\n    clearGutter: docMethodOp(function (gutterID) {\n      var this$1 = this;\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n\n            if (isEmpty(line.gutterMarkers)) {\n              line.gutterMarkers = null;\n            }\n\n            return true;\n          });\n        }\n      });\n    }),\n    lineInfo: function lineInfo(line) {\n      var n;\n\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) {\n          return null;\n        }\n\n        n = line;\n        line = getLine(this, line);\n\n        if (!line) {\n          return null;\n        }\n      } else {\n        n = lineNo(line);\n\n        if (n == null) {\n          return null;\n        }\n      }\n\n      return {\n        line: n,\n        handle: line,\n        text: line.text,\n        gutterMarkers: line.gutterMarkers,\n        textClass: line.textClass,\n        bgClass: line.bgClass,\n        wrapClass: line.wrapClass,\n        widgets: line.widgets\n      };\n    },\n    addLineClass: docMethodOp(function (handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n\n        if (!line[prop]) {\n          line[prop] = cls;\n        } else if (classTest(cls).test(line[prop])) {\n          return false;\n        } else {\n          line[prop] += \" \" + cls;\n        }\n\n        return true;\n      });\n    }),\n    removeLineClass: docMethodOp(function (handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n\n        if (!cur) {\n          return false;\n        } else if (cls == null) {\n          line[prop] = null;\n        } else {\n          var found = cur.match(classTest(cls));\n\n          if (!found) {\n            return false;\n          }\n\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n\n        return true;\n      });\n    }),\n    addLineWidget: docMethodOp(function (handle, node, options) {\n      return addLineWidget(this, handle, node, options);\n    }),\n    removeLineWidget: function removeLineWidget(widget) {\n      widget.clear();\n    },\n    markText: function markText(from, to, options) {\n      return _markText(this, _clipPos(this, from), _clipPos(this, to), options, options && options.type || \"range\");\n    },\n    setBookmark: function setBookmark(pos, options) {\n      var realOpts = {\n        replacedWith: options && (options.nodeType == null ? options.widget : options),\n        insertLeft: options && options.insertLeft,\n        clearWhenEmpty: false,\n        shared: options && options.shared,\n        handleMouseEvents: options && options.handleMouseEvents\n      };\n      pos = _clipPos(this, pos);\n      return _markText(this, pos, pos, realOpts, \"bookmark\");\n    },\n    findMarksAt: function findMarksAt(pos) {\n      pos = _clipPos(this, pos);\n      var markers = [],\n          spans = getLine(this, pos.line).markedSpans;\n\n      if (spans) {\n        for (var i = 0; i < spans.length; ++i) {\n          var span = spans[i];\n\n          if ((span.from == null || span.from <= pos.ch) && (span.to == null || span.to >= pos.ch)) {\n            markers.push(span.marker.parent || span.marker);\n          }\n        }\n      }\n\n      return markers;\n    },\n    findMarks: function findMarks(from, to, filter) {\n      from = _clipPos(this, from);\n      to = _clipPos(this, to);\n      var found = [],\n          lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n\n        if (spans) {\n          for (var i = 0; i < spans.length; i++) {\n            var span = spans[i];\n\n            if (!(span.to != null && lineNo == from.line && from.ch >= span.to || span.from == null && lineNo != from.line || span.from != null && lineNo == to.line && span.from >= to.ch) && (!filter || filter(span.marker))) {\n              found.push(span.marker.parent || span.marker);\n            }\n          }\n        }\n\n        ++lineNo;\n      });\n      return found;\n    },\n    getAllMarks: function getAllMarks() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n\n        if (sps) {\n          for (var i = 0; i < sps.length; ++i) {\n            if (sps[i].from != null) {\n              markers.push(sps[i].marker);\n            }\n          }\n        }\n      });\n      return markers;\n    },\n    posFromIndex: function posFromIndex(off) {\n      var ch,\n          lineNo = this.first,\n          sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n\n        if (sz > off) {\n          ch = off;\n          return true;\n        }\n\n        off -= sz;\n        ++lineNo;\n      });\n      return _clipPos(this, Pos(lineNo, ch));\n    },\n    indexFromPos: function indexFromPos(coords) {\n      coords = _clipPos(this, coords);\n      var index = coords.ch;\n\n      if (coords.line < this.first || coords.ch < 0) {\n        return 0;\n      }\n\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) {\n        // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index;\n    },\n    copy: function copy(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size), this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop;\n      doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n\n      return doc;\n    },\n    linkedDoc: function linkedDoc(options) {\n      if (!options) {\n        options = {};\n      }\n\n      var from = this.first,\n          to = this.first + this.size;\n\n      if (options.from != null && options.from > from) {\n        from = options.from;\n      }\n\n      if (options.to != null && options.to < to) {\n        to = options.to;\n      }\n\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n\n      if (options.sharedHist) {\n        copy.history = this.history;\n      }\n\n      (this.linked || (this.linked = [])).push({\n        doc: copy,\n        sharedHist: options.sharedHist\n      });\n      copy.linked = [{\n        doc: this,\n        isParent: true,\n        sharedHist: options.sharedHist\n      }];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy;\n    },\n    unlinkDoc: function unlinkDoc(other) {\n      var this$1 = this;\n\n      if (other instanceof CodeMirror) {\n        other = other.doc;\n      }\n\n      if (this.linked) {\n        for (var i = 0; i < this.linked.length; ++i) {\n          var link = this$1.linked[i];\n\n          if (link.doc != other) {\n            continue;\n          }\n\n          this$1.linked.splice(i, 1);\n          other.unlinkDoc(this$1);\n          detachSharedMarkers(findSharedMarkers(this$1));\n          break;\n        }\n      } // If the histories were shared, split them again\n\n\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) {\n          return splitIds.push(doc.id);\n        }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function iterLinkedDocs(f) {\n      linkedDocs(this, f);\n    },\n    getMode: function getMode() {\n      return this.mode;\n    },\n    getEditor: function getEditor() {\n      return this.cm;\n    },\n    splitLines: function splitLines(str) {\n      if (this.lineSep) {\n        return str.split(this.lineSep);\n      }\n\n      return splitLinesAuto(str);\n    },\n    lineSeparator: function lineSeparator() {\n      return this.lineSep || \"\\n\";\n    },\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") {\n        dir = \"ltr\";\n      }\n\n      if (dir == this.direction) {\n        return;\n      }\n\n      this.direction = dir;\n      this.iter(function (line) {\n        return line.order = null;\n      });\n\n      if (this.cm) {\n        directionChanged(this.cm);\n      }\n    })\n  }); // Public alias.\n\n  Doc.prototype.eachLine = Doc.prototype.iter; // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) {\n      return;\n    }\n\n    e_preventDefault(e);\n\n    if (ie) {\n      lastDrop = +new Date();\n    }\n\n    var pos = posFromMouse(cm, e, true),\n        files = e.dataTransfer.files;\n\n    if (!pos || cm.isReadOnly()) {\n      return;\n    } // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n\n\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length,\n          text = Array(n),\n          read = 0;\n\n      var loadFile = function loadFile(file, i) {\n        if (cm.options.allowDropFileTypes && indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          return;\n        }\n\n        var reader = new FileReader();\n        reader.onload = operation(cm, function () {\n          var content = reader.result;\n\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            content = \"\";\n          }\n\n          text[i] = content;\n\n          if (++read == n) {\n            pos = _clipPos(cm.doc, pos);\n            var change = {\n              from: pos,\n              to: pos,\n              text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n              origin: \"paste\"\n            };\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n          }\n        });\n        reader.readAsText(file);\n      };\n\n      for (var i = 0; i < n; ++i) {\n        loadFile(files[i], i);\n      }\n    } else {\n      // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e); // Ensure the editor is re-focused\n\n        setTimeout(function () {\n          return cm.display.input.focus();\n        }, 20);\n        return;\n      }\n\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n\n        if (text$1) {\n          var selected;\n\n          if (cm.state.draggingText && !cm.state.draggingText.copy) {\n            selected = cm.listSelections();\n          }\n\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n\n          if (selected) {\n            for (var i$1 = 0; i$1 < selected.length; ++i$1) {\n              _replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\");\n            }\n          }\n\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      } catch (e) {}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date() - lastDrop < 100)) {\n      e_stop(e);\n      return;\n    }\n\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) {\n      return;\n    }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\"; // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img); // Force a relayout, or Opera won't use our image for some obscure reason\n\n        img._top = img.offsetTop;\n      }\n\n      e.dataTransfer.setDragImage(img, 0, 0);\n\n      if (presto) {\n        img.parentNode.removeChild(img);\n      }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n\n    if (!pos) {\n      return;\n    }\n\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  } // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) {\n      return;\n    }\n\n    var byClass = document.getElementsByClassName(\"CodeMirror\");\n\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n\n      if (cm) {\n        f(cm);\n      }\n    }\n  }\n\n  var globalsRegistered = false;\n\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) {\n      return;\n    }\n\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) {\n        resizeTimer = setTimeout(function () {\n          resizeTimer = null;\n          forEachCodeMirror(onResize);\n        }, 100);\n      }\n    }); // When the window loses focus, we want to show the editor as blurred\n\n    on(window, \"blur\", function () {\n      return forEachCodeMirror(onBlur);\n    });\n  } // Called when the window resizes\n\n\n  function onResize(cm) {\n    var d = cm.display; // Might be a text scaling operation, clear size caches.\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\",\n    8: \"Backspace\",\n    9: \"Tab\",\n    13: \"Enter\",\n    16: \"Shift\",\n    17: \"Ctrl\",\n    18: \"Alt\",\n    19: \"Pause\",\n    20: \"CapsLock\",\n    27: \"Esc\",\n    32: \"Space\",\n    33: \"PageUp\",\n    34: \"PageDown\",\n    35: \"End\",\n    36: \"Home\",\n    37: \"Left\",\n    38: \"Up\",\n    39: \"Right\",\n    40: \"Down\",\n    44: \"PrintScrn\",\n    45: \"Insert\",\n    46: \"Delete\",\n    59: \";\",\n    61: \"=\",\n    91: \"Mod\",\n    92: \"Mod\",\n    93: \"Mod\",\n    106: \"*\",\n    107: \"=\",\n    109: \"-\",\n    110: \".\",\n    111: \"/\",\n    127: \"Delete\",\n    145: \"ScrollLock\",\n    173: \"-\",\n    186: \";\",\n    187: \"=\",\n    188: \",\",\n    189: \"-\",\n    190: \".\",\n    191: \"/\",\n    192: \"`\",\n    219: \"[\",\n    220: \"\\\\\",\n    221: \"]\",\n    222: \"'\",\n    63232: \"Up\",\n    63233: \"Down\",\n    63234: \"Left\",\n    63235: \"Right\",\n    63272: \"Delete\",\n    63273: \"Home\",\n    63275: \"End\",\n    63276: \"PageUp\",\n    63277: \"PageDown\",\n    63302: \"Insert\" // Number keys\n\n  };\n\n  for (var i = 0; i < 10; i++) {\n    keyNames[i + 48] = keyNames[i + 96] = String(i);\n  } // Alphabetic keys\n\n\n  for (var i$1 = 65; i$1 <= 90; i$1++) {\n    keyNames[i$1] = String.fromCharCode(i$1);\n  } // Function keys\n\n\n  for (var i$2 = 1; i$2 <= 12; i$2++) {\n    keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2;\n  }\n\n  var keyMap = {};\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\",\n    \"Right\": \"goCharRight\",\n    \"Up\": \"goLineUp\",\n    \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\",\n    \"Home\": \"goLineStartSmart\",\n    \"PageUp\": \"goPageUp\",\n    \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\",\n    \"Backspace\": \"delCharBefore\",\n    \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\",\n    \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\",\n    \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\" // Note that the save and find-related commands aren't defined by\n    // default. User code or addons can define them. Unknown commands\n    // are simply ignored.\n\n  };\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\",\n    \"Ctrl-D\": \"deleteLine\",\n    \"Ctrl-Z\": \"undo\",\n    \"Shift-Ctrl-Z\": \"redo\",\n    \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\",\n    \"Ctrl-End\": \"goDocEnd\",\n    \"Ctrl-Up\": \"goLineUp\",\n    \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\",\n    \"Ctrl-Right\": \"goGroupRight\",\n    \"Alt-Left\": \"goLineStart\",\n    \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Delete\": \"delGroupAfter\",\n    \"Ctrl-S\": \"save\",\n    \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\",\n    \"Shift-Ctrl-G\": \"findPrev\",\n    \"Shift-Ctrl-F\": \"replace\",\n    \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\",\n    \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\",\n    \"Shift-Ctrl-U\": \"redoSelection\",\n    \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\" // Very basic readline/emacs-style bindings, which are standard on Mac.\n\n  };\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\",\n    \"Ctrl-B\": \"goCharLeft\",\n    \"Ctrl-P\": \"goLineUp\",\n    \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\",\n    \"Alt-B\": \"goWordLeft\",\n    \"Ctrl-A\": \"goLineStart\",\n    \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\",\n    \"Shift-Ctrl-V\": \"goPageUp\",\n    \"Ctrl-D\": \"delCharAfter\",\n    \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\",\n    \"Alt-Backspace\": \"delWordBefore\",\n    \"Ctrl-K\": \"killLine\",\n    \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\",\n    \"Cmd-D\": \"deleteLine\",\n    \"Cmd-Z\": \"undo\",\n    \"Shift-Cmd-Z\": \"redo\",\n    \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\",\n    \"Cmd-Up\": \"goDocStart\",\n    \"Cmd-End\": \"goDocEnd\",\n    \"Cmd-Down\": \"goDocEnd\",\n    \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\",\n    \"Cmd-Left\": \"goLineLeft\",\n    \"Cmd-Right\": \"goLineRight\",\n    \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\",\n    \"Alt-Delete\": \"delGroupAfter\",\n    \"Cmd-S\": \"save\",\n    \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\",\n    \"Shift-Cmd-G\": \"findPrev\",\n    \"Cmd-Alt-F\": \"replace\",\n    \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\",\n    \"Cmd-]\": \"indentMore\",\n    \"Cmd-Backspace\": \"delWrappedLineLeft\",\n    \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\",\n    \"Shift-Cmd-U\": \"redoSelection\",\n    \"Ctrl-Up\": \"goDocStart\",\n    \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault; // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n\n      if (/^(cmd|meta|m)$/i.test(mod)) {\n        cmd = true;\n      } else if (/^a(lt)?$/i.test(mod)) {\n        alt = true;\n      } else if (/^(c|ctrl|control)$/i.test(mod)) {\n        ctrl = true;\n      } else if (/^s(hift)?$/i.test(mod)) {\n        shift = true;\n      } else {\n        throw new Error(\"Unrecognized modifier name: \" + mod);\n      }\n    }\n\n    if (alt) {\n      name = \"Alt-\" + name;\n    }\n\n    if (ctrl) {\n      name = \"Ctrl-\" + name;\n    }\n\n    if (cmd) {\n      name = \"Cmd-\" + name;\n    }\n\n    if (shift) {\n      name = \"Shift-\" + name;\n    }\n\n    return name;\n  } // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n\n\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n\n    for (var keyname in keymap) {\n      if (keymap.hasOwnProperty(keyname)) {\n        var value = keymap[keyname];\n\n        if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) {\n          continue;\n        }\n\n        if (value == \"...\") {\n          delete keymap[keyname];\n          continue;\n        }\n\n        var keys = map(keyname.split(\" \"), normalizeKeyName);\n\n        for (var i = 0; i < keys.length; i++) {\n          var val = void 0,\n              name = void 0;\n\n          if (i == keys.length - 1) {\n            name = keys.join(\" \");\n            val = value;\n          } else {\n            name = keys.slice(0, i + 1).join(\" \");\n            val = \"...\";\n          }\n\n          var prev = copy[name];\n\n          if (!prev) {\n            copy[name] = val;\n          } else if (prev != val) {\n            throw new Error(\"Inconsistent bindings for \" + name);\n          }\n        }\n\n        delete keymap[keyname];\n      }\n    }\n\n    for (var prop in copy) {\n      keymap[prop] = copy[prop];\n    }\n\n    return keymap;\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n\n    if (found === false) {\n      return \"nothing\";\n    }\n\n    if (found === \"...\") {\n      return \"multi\";\n    }\n\n    if (found != null && handle(found)) {\n      return \"handled\";\n    }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\") {\n        return lookupKey(key, map.fallthrough, handle, context);\n      }\n\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n\n        if (result) {\n          return result;\n        }\n      }\n    }\n  } // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n\n\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\";\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n\n    if (event.altKey && base != \"Alt\") {\n      name = \"Alt-\" + name;\n    }\n\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") {\n      name = \"Ctrl-\" + name;\n    }\n\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") {\n      name = \"Cmd-\" + name;\n    }\n\n    if (!noShift && event.shiftKey && base != \"Shift\") {\n      name = \"Shift-\" + name;\n    }\n\n    return name;\n  } // Look up the name of a key as indicated by an event object.\n\n\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) {\n      return false;\n    }\n\n    var name = keyNames[event.keyCode];\n\n    if (name == null || event.altGraphKey) {\n      return false;\n    } // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n\n\n    if (event.keyCode == 3 && event.code) {\n      name = event.code;\n    }\n\n    return addModifierNames(name, event, noShift);\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val;\n  } // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n\n\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges,\n        kill = []; // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break;\n        }\n      }\n\n      kill.push(toKill);\n    } // Next, remove those actual ranges.\n\n\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--) {\n        _replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\");\n      }\n\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target;\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\");\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      var order = getOrder(lineObj, cm.doc.direction);\n\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = dir < 0 == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch; // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) {\n            return measureCharPrepared(cm, prep, ch).top == targetTop;\n          }, dir < 0 == (part.level == 1) ? part.from : part.to - 1, ch);\n\n          if (sticky == \"before\") {\n            ch = moveCharLogically(lineObj, ch, 1);\n          }\n        } else {\n          ch = dir < 0 ? part.to : part.from;\n        }\n\n        return new Pos(lineNo, ch, sticky);\n      }\n    }\n\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\");\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n\n    if (!bidi) {\n      return moveLogically(line, start, dir);\n    }\n\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky),\n        part = bidi[partPos];\n\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir);\n    }\n\n    var mv = function mv(pos, dir) {\n      return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir);\n    };\n\n    var prep;\n\n    var getWrappedLineExtent = function getWrappedLineExtent(ch) {\n      if (!cm.options.lineWrapping) {\n        return {\n          begin: 0,\n          end: line.text.length\n        };\n      }\n\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch);\n    };\n\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = part.level == 1 == dir < 0;\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky);\n      }\n    } // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n\n    var searchInVisualLine = function searchInVisualLine(partPos, dir, wrappedLineExtent) {\n      var getRes = function getRes(ch, moveInStorageOrder) {\n        return moveInStorageOrder ? new Pos(start.line, mv(ch, 1), \"before\") : new Pos(start.line, ch, \"after\");\n      };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = dir > 0 == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n\n        if (part.from <= ch && ch < part.to) {\n          return getRes(ch, moveInStorageOrder);\n        }\n\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) {\n          return getRes(ch, moveInStorageOrder);\n        }\n      }\n    }; // Case 3a: Look for other bidi parts on the same visual line\n\n\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n\n    if (res) {\n      return res;\n    } // Case 3b: Look for other bidi parts on the next visual line\n\n\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n\n      if (res) {\n        return res;\n      }\n    } // Case 4: Nowhere to move\n\n\n    return null;\n  } // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n\n\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function singleSelection(cm) {\n      return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll);\n    },\n    killLine: function killLine(cm) {\n      return deleteNearSelection(cm, function (range) {\n        if (range.empty()) {\n          var len = getLine(cm.doc, range.head.line).text.length;\n\n          if (range.head.ch == len && range.head.line < cm.lastLine()) {\n            return {\n              from: range.head,\n              to: Pos(range.head.line + 1, 0)\n            };\n          } else {\n            return {\n              from: range.head,\n              to: Pos(range.head.line, len)\n            };\n          }\n        } else {\n          return {\n            from: range.from(),\n            to: range.to()\n          };\n        }\n      });\n    },\n    deleteLine: function deleteLine(cm) {\n      return deleteNearSelection(cm, function (range) {\n        return {\n          from: Pos(range.from().line, 0),\n          to: _clipPos(cm.doc, Pos(range.to().line + 1, 0))\n        };\n      });\n    },\n    delLineLeft: function delLineLeft(cm) {\n      return deleteNearSelection(cm, function (range) {\n        return {\n          from: Pos(range.from().line, 0),\n          to: range.from()\n        };\n      });\n    },\n    delWrappedLineLeft: function delWrappedLineLeft(cm) {\n      return deleteNearSelection(cm, function (range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var leftPos = cm.coordsChar({\n          left: 0,\n          top: top\n        }, \"div\");\n        return {\n          from: leftPos,\n          to: range.from()\n        };\n      });\n    },\n    delWrappedLineRight: function delWrappedLineRight(cm) {\n      return deleteNearSelection(cm, function (range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var rightPos = cm.coordsChar({\n          left: cm.display.lineDiv.offsetWidth + 100,\n          top: top\n        }, \"div\");\n        return {\n          from: range.from(),\n          to: rightPos\n        };\n      });\n    },\n    undo: function undo(cm) {\n      return cm.undo();\n    },\n    redo: function redo(cm) {\n      return cm.redo();\n    },\n    undoSelection: function undoSelection(cm) {\n      return cm.undoSelection();\n    },\n    redoSelection: function redoSelection(cm) {\n      return cm.redoSelection();\n    },\n    goDocStart: function goDocStart(cm) {\n      return cm.extendSelection(Pos(cm.firstLine(), 0));\n    },\n    goDocEnd: function goDocEnd(cm) {\n      return cm.extendSelection(Pos(cm.lastLine()));\n    },\n    goLineStart: function goLineStart(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        return lineStart(cm, range.head.line);\n      }, {\n        origin: \"+move\",\n        bias: 1\n      });\n    },\n    goLineStartSmart: function goLineStartSmart(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        return lineStartSmart(cm, range.head);\n      }, {\n        origin: \"+move\",\n        bias: 1\n      });\n    },\n    goLineEnd: function goLineEnd(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        return lineEnd(cm, range.head.line);\n      }, {\n        origin: \"+move\",\n        bias: -1\n      });\n    },\n    goLineRight: function goLineRight(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        var top = cm.cursorCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({\n          left: cm.display.lineDiv.offsetWidth + 100,\n          top: top\n        }, \"div\");\n      }, sel_move);\n    },\n    goLineLeft: function goLineLeft(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        var top = cm.cursorCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({\n          left: 0,\n          top: top\n        }, \"div\");\n      }, sel_move);\n    },\n    goLineLeftSmart: function goLineLeftSmart(cm) {\n      return cm.extendSelectionsBy(function (range) {\n        var top = cm.cursorCoords(range.head, \"div\").top + 5;\n        var pos = cm.coordsChar({\n          left: 0,\n          top: top\n        }, \"div\");\n\n        if (pos.ch < cm.getLine(pos.line).search(/\\S/)) {\n          return lineStartSmart(cm, range.head);\n        }\n\n        return pos;\n      }, sel_move);\n    },\n    goLineUp: function goLineUp(cm) {\n      return cm.moveV(-1, \"line\");\n    },\n    goLineDown: function goLineDown(cm) {\n      return cm.moveV(1, \"line\");\n    },\n    goPageUp: function goPageUp(cm) {\n      return cm.moveV(-1, \"page\");\n    },\n    goPageDown: function goPageDown(cm) {\n      return cm.moveV(1, \"page\");\n    },\n    goCharLeft: function goCharLeft(cm) {\n      return cm.moveH(-1, \"char\");\n    },\n    goCharRight: function goCharRight(cm) {\n      return cm.moveH(1, \"char\");\n    },\n    goColumnLeft: function goColumnLeft(cm) {\n      return cm.moveH(-1, \"column\");\n    },\n    goColumnRight: function goColumnRight(cm) {\n      return cm.moveH(1, \"column\");\n    },\n    goWordLeft: function goWordLeft(cm) {\n      return cm.moveH(-1, \"word\");\n    },\n    goGroupRight: function goGroupRight(cm) {\n      return cm.moveH(1, \"group\");\n    },\n    goGroupLeft: function goGroupLeft(cm) {\n      return cm.moveH(-1, \"group\");\n    },\n    goWordRight: function goWordRight(cm) {\n      return cm.moveH(1, \"word\");\n    },\n    delCharBefore: function delCharBefore(cm) {\n      return cm.deleteH(-1, \"char\");\n    },\n    delCharAfter: function delCharAfter(cm) {\n      return cm.deleteH(1, \"char\");\n    },\n    delWordBefore: function delWordBefore(cm) {\n      return cm.deleteH(-1, \"word\");\n    },\n    delWordAfter: function delWordAfter(cm) {\n      return cm.deleteH(1, \"word\");\n    },\n    delGroupBefore: function delGroupBefore(cm) {\n      return cm.deleteH(-1, \"group\");\n    },\n    delGroupAfter: function delGroupAfter(cm) {\n      return cm.deleteH(1, \"group\");\n    },\n    indentAuto: function indentAuto(cm) {\n      return cm.indentSelection(\"smart\");\n    },\n    indentMore: function indentMore(cm) {\n      return cm.indentSelection(\"add\");\n    },\n    indentLess: function indentLess(cm) {\n      return cm.indentSelection(\"subtract\");\n    },\n    insertTab: function insertTab(cm) {\n      return cm.replaceSelection(\"\\t\");\n    },\n    insertSoftTab: function insertSoftTab(cm) {\n      var spaces = [],\n          ranges = cm.listSelections(),\n          tabSize = cm.options.tabSize;\n\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function defaultTab(cm) {\n      if (cm.somethingSelected()) {\n        cm.indentSelection(\"add\");\n      } else {\n        cm.execCommand(\"insertTab\");\n      }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function transposeChars(cm) {\n      return runInOp(cm, function () {\n        var ranges = cm.listSelections(),\n            newSel = [];\n\n        for (var i = 0; i < ranges.length; i++) {\n          if (!ranges[i].empty()) {\n            continue;\n          }\n\n          var cur = ranges[i].head,\n              line = getLine(cm.doc, cur.line).text;\n\n          if (line) {\n            if (cur.ch == line.length) {\n              cur = new Pos(cur.line, cur.ch - 1);\n            }\n\n            if (cur.ch > 0) {\n              cur = new Pos(cur.line, cur.ch + 1);\n              cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2), Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n            } else if (cur.line > cm.doc.first) {\n              var prev = getLine(cm.doc, cur.line - 1).text;\n\n              if (prev) {\n                cur = new Pos(cur.line, 1);\n                cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() + prev.charAt(prev.length - 1), Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n              }\n            }\n          }\n\n          newSel.push(new Range(cur, cur));\n        }\n\n        cm.setSelections(newSel);\n      });\n    },\n    newlineAndIndent: function newlineAndIndent(cm) {\n      return runInOp(cm, function () {\n        var sels = cm.listSelections();\n\n        for (var i = sels.length - 1; i >= 0; i--) {\n          cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\");\n        }\n\n        sels = cm.listSelections();\n\n        for (var i$1 = 0; i$1 < sels.length; i$1++) {\n          cm.indentLine(sels[i$1].from().line, null, true);\n        }\n\n        ensureCursorVisible(cm);\n      });\n    },\n    openLine: function openLine(cm) {\n      return cm.replaceSelection(\"\\n\", \"start\");\n    },\n    toggleOverwrite: function toggleOverwrite(cm) {\n      return cm.toggleOverwrite();\n    }\n  };\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n\n    if (visual != line) {\n      lineN = lineNo(visual);\n    }\n\n    return endOfLine(true, cm, visual, lineN, 1);\n  }\n\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n\n    if (visual != line) {\n      lineN = lineNo(visual);\n    }\n\n    return endOfLine(true, cm, line, lineN, -1);\n  }\n\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(0, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky);\n    }\n\n    return start;\n  } // Run a handler that was bound to a key.\n\n\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n\n      if (!bound) {\n        return false;\n      }\n    } // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n\n\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift,\n        done = false;\n\n    try {\n      if (cm.isReadOnly()) {\n        cm.state.suppressEdits = true;\n      }\n\n      if (dropShift) {\n        cm.display.shift = false;\n      }\n\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n\n    return done;\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n\n      if (result) {\n        return result;\n      }\n    }\n\n    return cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm) || lookupKey(name, cm.options.keyMap, handle, cm);\n  } // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n\n  var stopSeq = new Delayed();\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n\n    if (seq) {\n      if (isModifierKey(name)) {\n        return \"handled\";\n      }\n\n      if (/\\'$/.test(name)) {\n        cm.state.keySeq = null;\n      } else {\n        stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        });\n      }\n\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) {\n        return true;\n      }\n    }\n\n    return dispatchKeyInner(cm, name, e, handle);\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\") {\n      cm.state.keySeq = name;\n    }\n\n    if (result == \"handled\") {\n      signalLater(cm, \"keyHandled\", cm, name, e);\n    }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result;\n  } // Handle a key from the keydown event.\n\n\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n\n    if (!name) {\n      return false;\n    }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) {\n        return doHandleBinding(cm, b, true);\n      }) || dispatchKey(cm, name, e, function (b) {\n        if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion) {\n          return doHandleBinding(cm, b);\n        }\n      });\n    } else {\n      return dispatchKey(cm, name, e, function (b) {\n        return doHandleBinding(cm, b);\n      });\n    }\n  } // Handle a key from the keypress event\n\n\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) {\n      return doHandleBinding(cm, b, true);\n    });\n  }\n\n  var lastStoppedKey = null;\n\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n\n    if (signalDOMEvent(cm, e)) {\n      return;\n    } // IE does strange things with escape.\n\n\n    if (ie && ie_version < 11 && e.keyCode == 27) {\n      e.returnValue = false;\n    }\n\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n\n    if (presto) {\n      lastStoppedKey = handled ? code : null; // Opera has no cut event... we try to at least catch the key combo\n\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey)) {\n        cm.replaceSelection(\"\", null, \"cut\");\n      }\n    } // Turn mouse into crosshair when Alt is held on Mac.\n\n\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className)) {\n      showCrossHair(cm);\n    }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) {\n      this.doc.sel.shift = false;\n    }\n\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) {\n      return;\n    }\n\n    var keyCode = e.keyCode,\n        charCode = e.charCode;\n\n    if (presto && keyCode == lastStoppedKey) {\n      lastStoppedKey = null;\n      e_preventDefault(e);\n      return;\n    }\n\n    if (presto && (!e.which || e.which < 10) && handleKeyBinding(cm, e)) {\n      return;\n    }\n\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode); // Some browsers fire keypress events for backspace\n\n    if (ch == \"\\x08\") {\n      return;\n    }\n\n    if (handleCharBinding(cm, e, ch)) {\n      return;\n    }\n\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function PastClick(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time && cmp(pos, this.pos) == 0 && button == this.button;\n  };\n\n  var lastClick;\n  var lastDoubleClick;\n\n  function clickRepeat(pos, button) {\n    var now = +new Date();\n\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\";\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\";\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\";\n    }\n  } // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n\n\n  function onMouseDown(e) {\n    var cm = this,\n        display = cm.display;\n\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) {\n      return;\n    }\n\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () {\n          return display.scroller.draggable = true;\n        }, 100);\n      }\n\n      return;\n    }\n\n    var button = e_button(e);\n\n    if (button == 3 && captureRightClick ? contextMenuInGutter(cm, e) : clickInGutter(cm, e)) {\n      return;\n    }\n\n    var pos = posFromMouse(cm, e),\n        repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus(); // #3261: make sure, that we're not starting a second selection\n\n    if (button == 1 && cm.state.selectingText) {\n      cm.state.selectingText(e);\n    }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) {\n      return;\n    }\n\n    if (button == 1) {\n      if (pos) {\n        leftButtonDown(cm, pos, repeat, e);\n      } else if (e_target(e) == display.scroller) {\n        e_preventDefault(e);\n      }\n    } else if (button == 2) {\n      if (pos) {\n        extendSelection(cm.doc, pos);\n      }\n\n      setTimeout(function () {\n        return display.input.focus();\n      }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) {\n        onContextMenu(cm, e);\n      } else {\n        delayBlurEvent(cm);\n      }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n\n    if (repeat == \"double\") {\n      name = \"Double\" + name;\n    } else if (repeat == \"triple\") {\n      name = \"Triple\" + name;\n    }\n\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n    return dispatchKey(cm, addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") {\n        bound = commands[bound];\n      }\n\n      if (!bound) {\n        return false;\n      }\n\n      var done = false;\n\n      try {\n        if (cm.isReadOnly()) {\n          cm.state.suppressEdits = true;\n        }\n\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n\n      return done;\n    });\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n\n    if (value.extend == null || cm.doc.extend) {\n      value.extend = cm.doc.extend || event.shiftKey;\n    }\n\n    if (value.addNew == null) {\n      value.addNew = mac ? event.metaKey : event.ctrlKey;\n    }\n\n    if (value.moveOnDrag == null) {\n      value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey);\n    }\n\n    return value;\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) {\n      setTimeout(bind(ensureFocus, cm), 0);\n    } else {\n      cm.curOp.focus = activeElt();\n    }\n\n    var behavior = configureMouse(cm, repeat, event);\n    var sel = cm.doc.sel,\n        contained;\n\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() && repeat == \"single\" && (contained = sel.contains(pos)) > -1 && (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) && (cmp(contained.to(), pos) > 0 || pos.xRel < 0)) {\n      leftButtonStartDrag(cm, event, pos, behavior);\n    } else {\n      leftButtonSelect(cm, event, pos, behavior);\n    }\n  } // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n\n\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display,\n        moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) {\n        display.scroller.draggable = false;\n      }\n\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n\n      if (!moved) {\n        e_preventDefault(e);\n\n        if (!behavior.addNew) {\n          extendSelection(cm.doc, pos, null, null, behavior.extend);\n        } // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n\n\n        if (webkit || ie && ie_version == 9) {\n          setTimeout(function () {\n            display.wrapper.ownerDocument.body.focus();\n            display.input.focus();\n          }, 20);\n        } else {\n          display.input.focus();\n        }\n      }\n    });\n\n    var mouseMove = function mouseMove(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n\n    var dragStart = function dragStart() {\n      return moved = true;\n    }; // Let the drag handler handle this.\n\n\n    if (webkit) {\n      display.scroller.draggable = true;\n    }\n\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag; // IE's approach to draggable\n\n    if (display.scroller.dragDrop) {\n      display.scroller.dragDrop();\n    }\n\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n    delayBlurEvent(cm);\n    setTimeout(function () {\n      return display.input.focus();\n    }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") {\n      return new Range(pos, pos);\n    }\n\n    if (unit == \"word\") {\n      return cm.findWordAt(pos);\n    }\n\n    if (unit == \"line\") {\n      return new Range(Pos(pos.line, 0), _clipPos(cm.doc, Pos(pos.line + 1, 0)));\n    }\n\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to);\n  } // Normal selection, as opposed to text dragging.\n\n\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display,\n        doc = cm.doc;\n    e_preventDefault(event);\n    var ourRange,\n        ourIndex,\n        startSel = doc.sel,\n        ranges = startSel.ranges;\n\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n\n      if (ourIndex > -1) {\n        ourRange = ranges[ourIndex];\n      } else {\n        ourRange = new Range(start, start);\n      }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) {\n        ourRange = new Range(start, start);\n      }\n\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n\n      if (behavior.extend) {\n        ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend);\n      } else {\n        ourRange = range;\n      }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex), {\n        scroll: false,\n        origin: \"*mouse\"\n      });\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0), {\n        scroll: false,\n        origin: \"*mouse\"\n      });\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) {\n        return;\n      }\n\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [],\n            tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol),\n            right = Math.max(startCol, posCol);\n\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line)); line <= end; line++) {\n          var text = getLine(doc, line).text,\n              leftPos = findColumn(text, left, tabSize);\n\n          if (left == right) {\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos)));\n          } else if (text.length > leftPos) {\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize))));\n          }\n        }\n\n        if (!ranges.length) {\n          ranges.push(new Range(start, start));\n        }\n\n        setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex), {\n          origin: \"*mouse\",\n          scroll: false\n        });\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor,\n            head;\n\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(_clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect(); // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n\n      if (!cur) {\n        return;\n      }\n\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n\n        if (cur.line >= visible.to || cur.line < visible.from) {\n          setTimeout(operation(cm, function () {\n            if (counter == curCount) {\n              extend(e);\n            }\n          }), 150);\n        }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n\n        if (outside) {\n          setTimeout(operation(cm, function () {\n            if (counter != curCount) {\n              return;\n            }\n\n            display.scroller.scrollTop += outside;\n            extend(e);\n          }), 50);\n        }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      e_preventDefault(e);\n      display.input.focus();\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) {\n        done(e);\n      } else {\n        extend(e);\n      }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  } // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n\n\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) {\n      return range;\n    }\n\n    var order = getOrder(anchorLine);\n\n    if (!order) {\n      return range;\n    }\n\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky),\n        part = order[index];\n\n    if (part.from != anchor.ch && part.to != anchor.ch) {\n      return range;\n    }\n\n    var boundary = index + (part.from == anchor.ch == (part.level != 1) ? 0 : 1);\n\n    if (boundary == 0 || boundary == order.length) {\n      return range;\n    } // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n\n\n    var leftSide;\n\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n\n      if (headIndex == boundary - 1 || headIndex == boundary) {\n        leftSide = dir < 0;\n      } else {\n        leftSide = dir > 0;\n      }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to,\n        sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head);\n  } // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n\n\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try {\n        mX = e.clientX;\n        mY = e.clientY;\n      } catch (e) {\n        return false;\n      }\n    }\n\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) {\n      return false;\n    }\n\n    if (prevent) {\n      e_preventDefault(e);\n    }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) {\n      return e_defaultPrevented(e);\n    }\n\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.options.gutters.length; ++i) {\n      var g = display.gutters.childNodes[i];\n\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = _lineAtHeight(cm.doc, mY);\n\n        var gutter = cm.options.gutters[i];\n        signal(cm, type, cm, line, gutter, e);\n        return e_defaultPrevented(e);\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true);\n  } // CONTEXT MENU HANDLING\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n\n\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) {\n      return;\n    }\n\n    if (signalDOMEvent(cm, e, \"contextmenu\")) {\n      return;\n    }\n\n    cm.display.input.onContextMenu(e);\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) {\n      return false;\n    }\n\n    return gutterEvent(cm, e, \"gutterContextMenu\", false);\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") + cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {\n    toString: function toString() {\n      return \"CodeMirror.Init\";\n    }\n  };\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n\n      if (handle) {\n        optionHandlers[name] = notOnInit ? function (cm, val, old) {\n          if (old != Init) {\n            handle(cm, val, old);\n          }\n        } : handle;\n      }\n    }\n\n    CodeMirror.defineOption = option; // Passed to option handlers when there is no old value.\n\n    CodeMirror.Init = Init; // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n\n    option(\"value\", \"\", function (cm, val) {\n      return cm.setValue(val);\n    }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n\n      if (!val) {\n        return;\n      }\n\n      var newBreaks = [],\n          lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n\n          if (found == -1) {\n            break;\n          }\n\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n\n        lineNo++;\n      });\n\n      for (var i = newBreaks.length - 1; i >= 0; i--) {\n        _replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length));\n      }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n\n      if (old != Init) {\n        cm.refresh();\n      }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) {\n      return cm.refresh();\n    }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\"); // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) {\n      return cm.getInputField().spellcheck = val;\n    }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      guttersChanged(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n\n      if (prev && prev.detach) {\n        prev.detach(cm, next);\n      }\n\n      if (next.attach) {\n        next.attach(cm, prev || null);\n      }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm) {\n      setGuttersForLineNumbers(cm.options);\n      guttersChanged(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) {\n      return updateScrollbars(cm);\n    }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm) {\n      setGuttersForLineNumbers(cm.options);\n      guttersChanged(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, guttersChanged, true);\n    option(\"lineNumberFormatter\", function (integer) {\n      return integer;\n    }, guttersChanged, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n\n      cm.display.input.readOnlyChanged(val);\n    });\n    option(\"disableInput\", false, function (cm, val) {\n      if (!val) {\n        cm.display.input.reset();\n      }\n    }, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) {\n      return cm.doc.history.undoDepth = val;\n    });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) {\n      return cm.refresh();\n    }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) {\n        cm.display.input.resetPosition();\n      }\n    });\n    option(\"tabindex\", null, function (cm, val) {\n      return cm.display.input.getField().tabIndex = val || \"\";\n    });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) {\n      return cm.doc.setDirection(val);\n    }, true);\n    option(\"phrases\", null);\n  }\n\n  function guttersChanged(cm) {\n    updateGutters(cm);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () {\n      return updateScrollbars(cm);\n    }, 100);\n  } // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) {\n      return new CodeMirror(place, options);\n    }\n\n    this.options = options = options ? copyObj(options) : {}; // Determine effective options based on given values and defaults.\n\n    copyObj(defaults, options, false);\n    setGuttersForLineNumbers(options);\n    var doc = options.value;\n\n    if (typeof doc == \"string\") {\n      doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction);\n    } else if (options.mode) {\n      doc.modeOption = options.mode;\n    }\n\n    this.doc = doc;\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input);\n    display.wrapper.CodeMirror = this;\n    updateGutters(this);\n    themeChanged(this);\n\n    if (options.lineWrapping) {\n      this.display.wrapper.className += \" CodeMirror-wrap\";\n    }\n\n    initScrollbars(this);\n    this.state = {\n      keyMaps: [],\n      // stores maps added by addKeyMap\n      overlays: [],\n      // highlighting overlays, as added by addOverlay\n      modeGen: 0,\n      // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false,\n      // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: false,\n      cutIncoming: false,\n      // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(),\n      // stores highlight worker timeout\n      keySeq: null,\n      // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) {\n      display.input.focus();\n    } // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n\n\n    if (ie && ie_version < 11) {\n      setTimeout(function () {\n        return this$1.display.input.reset(true);\n      }, 20);\n    }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    _startOperation(this);\n\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if (options.autofocus && !mobile || this.hasFocus()) {\n      setTimeout(bind(onFocus, this), 20);\n    } else {\n      onBlur(this);\n    }\n\n    for (var opt in optionHandlers) {\n      if (optionHandlers.hasOwnProperty(opt)) {\n        optionHandlers[opt](this$1, options[opt], Init);\n      }\n    }\n\n    maybeUpdateLineNumberWidth(this);\n\n    if (options.finishInit) {\n      options.finishInit(this);\n    }\n\n    for (var i = 0; i < initHooks.length; ++i) {\n      initHooks[i](this$1);\n    }\n\n    _endOperation(this); // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n\n\n    if (webkit && options.lineWrapping && getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\") {\n      display.lineDiv.style.textRendering = \"auto\";\n    }\n  } // The default configuration options.\n\n\n  CodeMirror.defaults = defaults; // Functions to run when options are changed.\n\n  CodeMirror.optionHandlers = optionHandlers; // Attach the necessary event handlers when initializing the editor\n\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown)); // Older IE's will not fire a second mousedown for a double click\n\n    if (ie && ie_version < 11) {\n      on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) {\n          return;\n        }\n\n        var pos = posFromMouse(cm, e);\n\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) {\n          return;\n        }\n\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      }));\n    } else {\n      on(d.scroller, \"dblclick\", function (e) {\n        return signalDOMEvent(cm, e) || e_preventDefault(e);\n      });\n    } // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n\n\n    if (!captureRightClick) {\n      on(d.scroller, \"contextmenu\", function (e) {\n        return onContextMenu(cm, e);\n      });\n    } // Used to suppress mouse event handling when a touch happens\n\n\n    var touchFinished,\n        prevTouch = {\n      end: 0\n    };\n\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () {\n          return d.activeTouch = null;\n        }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date();\n      }\n    }\n\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) {\n        return false;\n      }\n\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1;\n    }\n\n    function farAway(touch, other) {\n      if (other.left == null) {\n        return true;\n      }\n\n      var dx = other.left - touch.left,\n          dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20;\n    }\n\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date();\n        d.activeTouch = {\n          start: now,\n          moved: false,\n          prev: now - prevTouch.end <= 300 ? prevTouch : null\n        };\n\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) {\n        d.activeTouch.moved = true;\n      }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n\n      if (touch && !eventInWidget(d, e) && touch.left != null && !touch.moved && new Date() - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"),\n            range;\n\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          {\n            range = new Range(pos, pos);\n          } else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          {\n            range = cm.findWordAt(pos);\n          } else // Triple tap\n          {\n            range = new Range(Pos(pos.line, 0), _clipPos(cm.doc, Pos(pos.line + 1, 0)));\n          }\n\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch); // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    }); // Listen to wheel events in order to try and update the viewport on time.\n\n    on(d.scroller, \"mousewheel\", function (e) {\n      return onScrollWheel(cm, e);\n    });\n    on(d.scroller, \"DOMMouseScroll\", function (e) {\n      return onScrollWheel(cm, e);\n    }); // Prevent wrapper from ever scrolling\n\n    on(d.wrapper, \"scroll\", function () {\n      return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0;\n    });\n    d.dragFunctions = {\n      enter: function enter(e) {\n        if (!signalDOMEvent(cm, e)) {\n          e_stop(e);\n        }\n      },\n      over: function over(e) {\n        if (!signalDOMEvent(cm, e)) {\n          onDragOver(cm, e);\n          e_stop(e);\n        }\n      },\n      start: function start(e) {\n        return onDragStart(cm, e);\n      },\n      drop: operation(cm, onDrop),\n      leave: function leave(e) {\n        if (!signalDOMEvent(cm, e)) {\n          clearDragCursor(cm);\n        }\n      }\n    };\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) {\n      return onKeyUp.call(cm, e);\n    });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) {\n      return onFocus(cm, e);\n    });\n    on(inp, \"blur\", function (e) {\n      return onBlur(cm, e);\n    });\n  }\n\n  var initHooks = [];\n\n  CodeMirror.defineInitHook = function (f) {\n    return initHooks.push(f);\n  }; // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n\n\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc,\n        state;\n\n    if (how == null) {\n      how = \"add\";\n    }\n\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) {\n        how = \"prev\";\n      } else {\n        state = getContextBefore(cm, n).state;\n      }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n),\n        curSpace = countColumn(line.text, null, tabSize);\n\n    if (line.stateAfter) {\n      line.stateAfter = null;\n    }\n\n    var curSpaceString = line.text.match(/^\\s*/)[0],\n        indentation;\n\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) {\n          return;\n        }\n\n        how = \"prev\";\n      }\n    }\n\n    if (how == \"prev\") {\n      if (n > doc.first) {\n        indentation = countColumn(getLine(doc, n - 1).text, null, tabSize);\n      } else {\n        indentation = 0;\n      }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n\n    indentation = Math.max(0, indentation);\n    var indentString = \"\",\n        pos = 0;\n\n    if (cm.options.indentWithTabs) {\n      for (var i = Math.floor(indentation / tabSize); i; --i) {\n        pos += tabSize;\n        indentString += \"\\t\";\n      }\n    }\n\n    if (pos < indentation) {\n      indentString += spaceStr(indentation - pos);\n    }\n\n    if (indentString != curSpaceString) {\n      _replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n\n      line.stateAfter = null;\n      return true;\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break;\n        }\n      }\n    }\n  } // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n\n\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n\n    if (!sel) {\n      sel = doc.sel;\n    }\n\n    var paste = cm.state.pasteIncoming || origin == \"paste\";\n    var textLines = splitLinesAuto(inserted),\n        multiPaste = null; // When pasting N lines into N selections, insert one line per selection\n\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n\n          for (var i = 0; i < lastCopied.text.length; i++) {\n            multiPaste.push(doc.splitLines(lastCopied.text[i]));\n          }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) {\n          return [l];\n        });\n      }\n    }\n\n    var updateInput; // Normal behavior is to insert the new text into every selection\n\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(),\n          to = range.to();\n\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          {\n            from = Pos(from.line, from.ch - deleted);\n          } else if (cm.state.overwrite && !paste) // Handle overwrite\n          {\n            to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length));\n          } else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted) {\n          from = to = Pos(from.line, 0);\n        }\n      }\n\n      updateInput = cm.curOp.updateInput;\n      var changeEvent = {\n        from: from,\n        to: to,\n        text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n        origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")\n      };\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n\n    if (inserted && !paste) {\n      triggerElectric(cm, inserted);\n    }\n\n    ensureCursorVisible(cm);\n    cm.curOp.updateInput = updateInput;\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = false;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n\n    if (pasted) {\n      e.preventDefault();\n\n      if (!cm.isReadOnly() && !cm.options.disableInput) {\n        runInOp(cm, function () {\n          return applyTextInput(cm, pasted, 0, null, \"paste\");\n        });\n      }\n\n      return true;\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) {\n      return;\n    }\n\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n\n      if (range.head.ch > 100 || i && sel.ranges[i - 1].head.line == range.head.line) {\n        continue;\n      }\n\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++) {\n          if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break;\n          }\n        }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch))) {\n          indented = indentLine(cm, range.head.line, \"smart\");\n        }\n      }\n\n      if (indented) {\n        signalLater(cm, \"electricInput\", cm, range.head.line);\n      }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [],\n        ranges = [];\n\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {\n        anchor: Pos(line, 0),\n        head: Pos(line + 1, 0)\n      };\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n\n    return {\n      text: text,\n      ranges: ranges\n    };\n  }\n\n  function disableBrowserMagic(field, spellcheck) {\n    field.setAttribute(\"autocorrect\", \"off\");\n    field.setAttribute(\"autocapitalize\", \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\"); // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n\n    if (webkit) {\n      te.style.width = \"1000px\";\n    } else {\n      te.setAttribute(\"wrap\", \"off\");\n    } // If border: 0; -- iOS fails to open keyboard (issue #1287)\n\n\n    if (ios) {\n      te.style.border = \"1px solid black\";\n    }\n\n    disableBrowserMagic(te);\n    return div;\n  } // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n    var helpers = CodeMirror.helpers = {};\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function focus() {\n        window.focus();\n        this.display.input.focus();\n      },\n      setOption: function setOption(option, value) {\n        var options = this.options,\n            old = options[option];\n\n        if (options[option] == value && option != \"mode\") {\n          return;\n        }\n\n        options[option] = value;\n\n        if (optionHandlers.hasOwnProperty(option)) {\n          operation(this, optionHandlers[option])(this, value, old);\n        }\n\n        signal(this, \"optionChange\", this, option);\n      },\n      getOption: function getOption(option) {\n        return this.options[option];\n      },\n      getDoc: function getDoc() {\n        return this.doc;\n      },\n      addKeyMap: function addKeyMap(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function removeKeyMap(map) {\n        var maps = this.state.keyMaps;\n\n        for (var i = 0; i < maps.length; ++i) {\n          if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true;\n          }\n        }\n      },\n      addOverlay: methodOp(function (spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n\n        if (mode.startState) {\n          throw new Error(\"Overlays may not be stateful.\");\n        }\n\n        insertSorted(this.state.overlays, {\n          mode: mode,\n          modeSpec: spec,\n          opaque: options && options.opaque,\n          priority: options && options.priority || 0\n        }, function (overlay) {\n          return overlay.priority;\n        });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function (spec) {\n        var this$1 = this;\n        var overlays = this.state.overlays;\n\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this$1.state.modeGen++;\n            regChange(this$1);\n            return;\n          }\n        }\n      }),\n      indentLine: methodOp(function (n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) {\n            dir = this.options.smartIndent ? \"smart\" : \"prev\";\n          } else {\n            dir = dir ? \"add\" : \"subtract\";\n          }\n        }\n\n        if (isLine(this.doc, n)) {\n          indentLine(this, n, dir, aggressive);\n        }\n      }),\n      indentSelection: methodOp(function (how) {\n        var this$1 = this;\n        var ranges = this.doc.sel.ranges,\n            end = -1;\n\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n\n          if (!range.empty()) {\n            var from = range.from(),\n                to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n\n            for (var j = start; j < end; ++j) {\n              indentLine(this$1, j, how);\n            }\n\n            var newRanges = this$1.doc.sel.ranges;\n\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0) {\n              replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll);\n            }\n          } else if (range.head.line > end) {\n            indentLine(this$1, range.head.line, how, true);\n            end = range.head.line;\n\n            if (i == this$1.doc.sel.primIndex) {\n              ensureCursorVisible(this$1);\n            }\n          }\n        }\n      }),\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function getTokenAt(pos, precise) {\n        return takeToken(this, pos, precise);\n      },\n      getLineTokens: function getLineTokens(line, precise) {\n        return takeToken(this, Pos(line), precise, true);\n      },\n      getTokenTypeAt: function getTokenTypeAt(pos) {\n        pos = _clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0,\n            after = (styles.length - 1) / 2,\n            ch = pos.ch;\n        var type;\n\n        if (ch == 0) {\n          type = styles[2];\n        } else {\n          for (;;) {\n            var mid = before + after >> 1;\n\n            if ((mid ? styles[mid * 2 - 1] : 0) >= ch) {\n              after = mid;\n            } else if (styles[mid * 2 + 1] < ch) {\n              before = mid + 1;\n            } else {\n              type = styles[mid * 2 + 2];\n              break;\n            }\n          }\n        }\n\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1);\n      },\n      getModeAt: function getModeAt(pos) {\n        var mode = this.doc.mode;\n\n        if (!mode.innerMode) {\n          return mode;\n        }\n\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n      },\n      getHelper: function getHelper(pos, type) {\n        return this.getHelpers(pos, type)[0];\n      },\n      getHelpers: function getHelpers(pos, type) {\n        var this$1 = this;\n        var found = [];\n\n        if (!helpers.hasOwnProperty(type)) {\n          return found;\n        }\n\n        var help = helpers[type],\n            mode = this.getModeAt(pos);\n\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) {\n            found.push(help[mode[type]]);\n          }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n\n            if (val) {\n              found.push(val);\n            }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n\n          if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1) {\n            found.push(cur.val);\n          }\n        }\n\n        return found;\n      },\n      getStateAfter: function getStateAfter(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1 : line);\n        return getContextBefore(this, line + 1, precise).state;\n      },\n      cursorCoords: function cursorCoords(start, mode) {\n        var pos,\n            range = this.doc.sel.primary();\n\n        if (start == null) {\n          pos = range.head;\n        } else if (_typeof(start) == \"object\") {\n          pos = _clipPos(this.doc, start);\n        } else {\n          pos = start ? range.from() : range.to();\n        }\n\n        return _cursorCoords(this, pos, mode || \"page\");\n      },\n      charCoords: function charCoords(pos, mode) {\n        return _charCoords(this, _clipPos(this.doc, pos), mode || \"page\");\n      },\n      coordsChar: function coordsChar(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return _coordsChar(this, coords.left, coords.top);\n      },\n      lineAtHeight: function lineAtHeight(height, mode) {\n        height = fromCoordSystem(this, {\n          top: height,\n          left: 0\n        }, mode || \"page\").top;\n        return _lineAtHeight(this.doc, height + this.display.viewOffset);\n      },\n      heightAtLine: function heightAtLine(line, mode, includeWidgets) {\n        var end = false,\n            lineObj;\n\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n\n          if (line < this.doc.first) {\n            line = this.doc.first;\n          } else if (line > last) {\n            line = last;\n            end = true;\n          }\n\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n\n        return intoCoordSystem(this, lineObj, {\n          top: 0,\n          left: 0\n        }, mode || \"page\", includeWidgets || end).top + (end ? this.doc.height - _heightAtLine(lineObj) : 0);\n      },\n      defaultTextHeight: function defaultTextHeight() {\n        return textHeight(this.display);\n      },\n      defaultCharWidth: function defaultCharWidth() {\n        return charWidth(this.display);\n      },\n      getViewport: function getViewport() {\n        return {\n          from: this.display.viewFrom,\n          to: this.display.viewTo\n        };\n      },\n      addWidget: function addWidget(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = _cursorCoords(this, _clipPos(this.doc, pos));\n        var top = pos.bottom,\n            left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n              hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth); // Default to positioning above (if specified and possible); otherwise default to positioning below\n\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight) {\n            top = pos.top - node.offsetHeight;\n          } else if (pos.bottom + node.offsetHeight <= vspace) {\n            top = pos.bottom;\n          }\n\n          if (left + node.offsetWidth > hspace) {\n            left = hspace - node.offsetWidth;\n          }\n        }\n\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") {\n            left = 0;\n          } else if (horiz == \"middle\") {\n            left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n          }\n\n          node.style.left = left + \"px\";\n        }\n\n        if (scroll) {\n          scrollIntoView(this, {\n            left: left,\n            top: top,\n            right: left + node.offsetWidth,\n            bottom: top + node.offsetHeight\n          });\n        }\n      },\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n      execCommand: function execCommand(cmd) {\n        if (commands.hasOwnProperty(cmd)) {\n          return commands[cmd].call(null, this);\n        }\n      },\n      triggerElectric: methodOp(function (text) {\n        triggerElectric(this, text);\n      }),\n      findPosH: function findPosH(from, amount, unit, visually) {\n        var this$1 = this;\n        var dir = 1;\n\n        if (amount < 0) {\n          dir = -1;\n          amount = -amount;\n        }\n\n        var cur = _clipPos(this.doc, from);\n\n        for (var i = 0; i < amount; ++i) {\n          cur = _findPosH(this$1.doc, cur, dir, unit, visually);\n\n          if (cur.hitSide) {\n            break;\n          }\n        }\n\n        return cur;\n      },\n      moveH: methodOp(function (dir, unit) {\n        var this$1 = this;\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty()) {\n            return _findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually);\n          } else {\n            return dir < 0 ? range.from() : range.to();\n          }\n        }, sel_move);\n      }),\n      deleteH: methodOp(function (dir, unit) {\n        var sel = this.doc.sel,\n            doc = this.doc;\n\n        if (sel.somethingSelected()) {\n          doc.replaceSelection(\"\", null, \"+delete\");\n        } else {\n          deleteNearSelection(this, function (range) {\n            var other = _findPosH(doc, range.head, dir, unit, false);\n\n            return dir < 0 ? {\n              from: other,\n              to: range.head\n            } : {\n              from: range.head,\n              to: other\n            };\n          });\n        }\n      }),\n      findPosV: function findPosV(from, amount, unit, goalColumn) {\n        var this$1 = this;\n        var dir = 1,\n            x = goalColumn;\n\n        if (amount < 0) {\n          dir = -1;\n          amount = -amount;\n        }\n\n        var cur = _clipPos(this.doc, from);\n\n        for (var i = 0; i < amount; ++i) {\n          var coords = _cursorCoords(this$1, cur, \"div\");\n\n          if (x == null) {\n            x = coords.left;\n          } else {\n            coords.left = x;\n          }\n\n          cur = _findPosV(this$1, coords, dir, unit);\n\n          if (cur.hitSide) {\n            break;\n          }\n        }\n\n        return cur;\n      },\n      moveV: methodOp(function (dir, unit) {\n        var this$1 = this;\n        var doc = this.doc,\n            goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse) {\n            return dir < 0 ? range.from() : range.to();\n          }\n\n          var headPos = _cursorCoords(this$1, range.head, \"div\");\n\n          if (range.goalColumn != null) {\n            headPos.left = range.goalColumn;\n          }\n\n          goals.push(headPos.left);\n\n          var pos = _findPosV(this$1, headPos, dir, unit);\n\n          if (unit == \"page\" && range == doc.sel.primary()) {\n            addToScrollTop(this$1, _charCoords(this$1, pos, \"div\").top - headPos.top);\n          }\n\n          return pos;\n        }, sel_move);\n\n        if (goals.length) {\n          for (var i = 0; i < doc.sel.ranges.length; i++) {\n            doc.sel.ranges[i].goalColumn = goals[i];\n          }\n        }\n      }),\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function findWordAt(pos) {\n        var doc = this.doc,\n            line = getLine(doc, pos.line).text;\n        var start = pos.ch,\n            end = pos.ch;\n\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n\n          if ((pos.sticky == \"before\" || end == line.length) && start) {\n            --start;\n          } else {\n            ++end;\n          }\n\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper) ? function (ch) {\n            return isWordChar(ch, helper);\n          } : /\\s/.test(startChar) ? function (ch) {\n            return /\\s/.test(ch);\n          } : function (ch) {\n            return !/\\s/.test(ch) && !isWordChar(ch);\n          };\n\n          while (start > 0 && check(line.charAt(start - 1))) {\n            --start;\n          }\n\n          while (end < line.length && check(line.charAt(end))) {\n            ++end;\n          }\n        }\n\n        return new Range(Pos(pos.line, start), Pos(pos.line, end));\n      },\n      toggleOverwrite: function toggleOverwrite(value) {\n        if (value != null && value == this.state.overwrite) {\n          return;\n        }\n\n        if (this.state.overwrite = !this.state.overwrite) {\n          addClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n        } else {\n          rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n        }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function hasFocus() {\n        return this.display.input.getField() == activeElt();\n      },\n      isReadOnly: function isReadOnly() {\n        return !!(this.options.readOnly || this.doc.cantEdit);\n      },\n      scrollTo: methodOp(function (x, y) {\n        scrollToCoords(this, x, y);\n      }),\n      getScrollInfo: function getScrollInfo() {\n        var scroller = this.display.scroller;\n        return {\n          left: scroller.scrollLeft,\n          top: scroller.scrollTop,\n          height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n          width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n          clientHeight: displayHeight(this),\n          clientWidth: displayWidth(this)\n        };\n      },\n      scrollIntoView: methodOp(function (range, margin) {\n        if (range == null) {\n          range = {\n            from: this.doc.sel.primary().head,\n            to: null\n          };\n\n          if (margin == null) {\n            margin = this.options.cursorScrollMargin;\n          }\n        } else if (typeof range == \"number\") {\n          range = {\n            from: Pos(range, 0),\n            to: null\n          };\n        } else if (range.from == null) {\n          range = {\n            from: range,\n            to: null\n          };\n        }\n\n        if (!range.to) {\n          range.to = range.from;\n        }\n\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n      setSize: methodOp(function (width, height) {\n        var this$1 = this;\n\n        var interpret = function interpret(val) {\n          return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n        };\n\n        if (width != null) {\n          this.display.wrapper.style.width = interpret(width);\n        }\n\n        if (height != null) {\n          this.display.wrapper.style.height = interpret(height);\n        }\n\n        if (this.options.lineWrapping) {\n          clearLineMeasurementCache(this);\n        }\n\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) {\n            for (var i = 0; i < line.widgets.length; i++) {\n              if (line.widgets[i].noHScroll) {\n                regLineChange(this$1, lineNo, \"widget\");\n                break;\n              }\n            }\n          }\n\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n      operation: function operation(f) {\n        return runInOp(this, f);\n      },\n      startOperation: function startOperation() {\n        return _startOperation(this);\n      },\n      endOperation: function endOperation() {\n        return _endOperation(this);\n      },\n      refresh: methodOp(function () {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this);\n\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5) {\n          estimateLineHeights(this);\n        }\n\n        signal(this, \"refresh\", this);\n      }),\n      swapDoc: methodOp(function (doc) {\n        var old = this.doc;\n        old.cm = null;\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old;\n      }),\n      phrase: function phrase(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText;\n      },\n      getInputField: function getInputField() {\n        return this.display.input.getField();\n      },\n      getWrapperElement: function getWrapperElement() {\n        return this.display.wrapper;\n      },\n      getScrollerElement: function getScrollerElement() {\n        return this.display.scroller;\n      },\n      getGutterElement: function getGutterElement() {\n        return this.display.gutters;\n      }\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function (type, name, value) {\n      if (!helpers.hasOwnProperty(type)) {\n        helpers[type] = CodeMirror[type] = {\n          _global: []\n        };\n      }\n\n      helpers[type][name] = value;\n    };\n\n    CodeMirror.registerGlobalHelper = function (type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n\n      helpers[type]._global.push({\n        pred: predicate,\n        val: value\n      });\n    };\n  } // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n\n\n  function _findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n\n    function findNextLine() {\n      var l = pos.line + dir;\n\n      if (l < doc.first || l >= doc.first + doc.size) {\n        return false;\n      }\n\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l);\n    }\n\n    function moveOnce(boundToLine) {\n      var next;\n\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n\n      if (next == null) {\n        if (!boundToLine && findNextLine()) {\n          pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir);\n        } else {\n          return false;\n        }\n      } else {\n        pos = next;\n      }\n\n      return true;\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null,\n          group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) {\n          break;\n        }\n\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\" : group && cur == \"\\n\" ? \"n\" : !group || /\\s/.test(cur) ? null : \"p\";\n\n        if (group && !first && !type) {\n          type = \"s\";\n        }\n\n        if (sawType && sawType != type) {\n          if (dir < 0) {\n            dir = 1;\n            moveOnce();\n            pos.sticky = \"after\";\n          }\n\n          break;\n        }\n\n        if (type) {\n          sawType = type;\n        }\n\n        if (dir > 0 && !moveOnce(!first)) {\n          break;\n        }\n      }\n    }\n\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n\n    if (equalCursorPos(oldPos, result)) {\n      result.hitSide = true;\n    }\n\n    return result;\n  } // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n\n\n  function _findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc,\n        x = pos.left,\n        y;\n\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n\n    var target;\n\n    for (;;) {\n      target = _coordsChar(cm, x, y);\n\n      if (!target.outside) {\n        break;\n      }\n\n      if (dir < 0 ? y <= 0 : y >= doc.height) {\n        target.hitSide = true;\n        break;\n      }\n\n      y += dir * 5;\n    }\n\n    return target;\n  } // CONTENTEDITABLE INPUT STYLE\n\n\n  var ContentEditableInput = function ContentEditableInput(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n    var this$1 = this;\n    var input = this,\n        cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck);\n    on(div, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) {\n        return;\n      } // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n\n\n      if (ie_version <= 11) {\n        setTimeout(operation(cm, function () {\n          return this$1.updateFromDOM();\n        }), 20);\n      }\n    });\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {\n        data: e.data,\n        done: false\n      };\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) {\n        this$1.composing = {\n          data: e.data,\n          done: false\n        };\n      }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) {\n          this$1.readFromDOMSoon();\n        }\n\n        this$1.composing.done = true;\n      }\n    });\n    on(div, \"touchstart\", function () {\n      return input.forceCompositionEnd();\n    });\n    on(div, \"input\", function () {\n      if (!this$1.composing) {\n        this$1.readFromDOMSoon();\n      }\n    });\n\n    function onCopyCut(e) {\n      if (signalDOMEvent(cm, e)) {\n        return;\n      }\n\n      if (cm.somethingSelected()) {\n        setLastCopied({\n          lineWise: false,\n          text: cm.getSelections()\n        });\n\n        if (e.type == \"cut\") {\n          cm.replaceSelection(\"\", null, \"cut\");\n        }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return;\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({\n          lineWise: true,\n          text: ranges.text\n        });\n\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\"); // iOS exposes the clipboard API, but seems to discard content inserted into it\n\n        e.clipboardData.setData(\"Text\", content);\n\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return;\n        }\n      } // Old-fashioned briefly-focus-a-textarea hack\n\n\n      var kludge = hiddenTextarea(),\n          te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n\n        if (hadFocus == div) {\n          input.showPrimarySelection();\n        }\n      }, 50);\n    }\n\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = this.cm.state.focused;\n    return result;\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) {\n      return;\n    }\n\n    if (info.focus || takeFocus) {\n      this.showPrimarySelection();\n    }\n\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection();\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(),\n        cm = this.cm,\n        prim = cm.doc.sel.primary();\n    var from = prim.from(),\n        to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return;\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad && cmp(minPos(curAnchor, curFocus), from) == 0 && cmp(maxPos(curAnchor, curFocus), to) == 0) {\n      return;\n    }\n\n    var view = cm.display.view;\n    var start = from.line >= cm.display.viewFrom && posToDOM(cm, from) || {\n      node: view[0].measure.map[2],\n      offset: 0\n    };\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {\n        node: map[map.length - 1],\n        offset: map[map.length - 2] - map[map.length - 3]\n      };\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return;\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0),\n        rng;\n\n    try {\n      rng = range(start.node, start.offset, end.offset, end.node);\n    } catch (e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n\n\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n\n      if (old && sel.anchorNode == null) {\n        sel.addRange(old);\n      } else if (gecko) {\n        this.startGracePeriod();\n      }\n    }\n\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n    var this$1 = this;\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n\n      if (this$1.selectionChanged()) {\n        this$1.cm.operation(function () {\n          return this$1.cm.curOp.selectionChanged = true;\n        });\n      }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode;\n    this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode;\n    this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n\n    if (!sel.rangeCount) {\n      return false;\n    }\n\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node);\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor()) {\n        this.showSelection(this.prepareSelection(), true);\n      }\n\n      this.div.focus();\n    }\n  };\n\n  ContentEditableInput.prototype.blur = function () {\n    this.div.blur();\n  };\n\n  ContentEditableInput.prototype.getField = function () {\n    return this.div;\n  };\n\n  ContentEditableInput.prototype.supportsTouch = function () {\n    return true;\n  };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n\n    if (this.selectionInEditor()) {\n      this.pollSelection();\n    } else {\n      runInOp(this.cm, function () {\n        return input.cm.curOp.selectionChanged = true;\n      });\n    }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset || sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset;\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) {\n      return;\n    }\n\n    var sel = this.getSelection(),\n        cm = this.cm; // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n\n    if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({\n        type: \"keydown\",\n        keyCode: 8,\n        preventDefault: Math.abs\n      });\n      this.blur();\n      this.focus();\n      return;\n    }\n\n    if (this.composing) {\n      return;\n    }\n\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n\n    if (anchor && head) {\n      runInOp(cm, function () {\n        setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n\n        if (anchor.bad || head.bad) {\n          cm.curOp.selectionChanged = true;\n        }\n      });\n    }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm,\n        display = cm.display,\n        sel = cm.doc.sel.primary();\n    var from = sel.from(),\n        to = sel.to();\n\n    if (from.ch == 0 && from.line > cm.firstLine()) {\n      from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length);\n    }\n\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine()) {\n      to = Pos(to.line + 1, 0);\n    }\n\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) {\n      return false;\n    }\n\n    var fromIndex, fromLine, fromNode;\n\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) {\n      return false;\n    }\n\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) {\n        newText.pop();\n        oldText.pop();\n        toLine--;\n      } else if (newText[0] == oldText[0]) {\n        newText.shift();\n        oldText.shift();\n        fromLine++;\n      } else {\n        break;\n      }\n    }\n\n    var cutFront = 0,\n        cutEnd = 0;\n    var newTop = newText[0],\n        oldTop = oldText[0],\n        maxCutFront = Math.min(newTop.length, oldTop.length);\n\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront)) {\n      ++cutFront;\n    }\n\n    var newBot = lst(newText),\n        oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0), oldBot.length - (oldText.length == 1 ? cutFront : 0));\n\n    while (cutEnd < maxCutEnd && newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n      ++cutEnd;\n    } // Try to move start of change to start of selection if ambiguous\n\n\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch && newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      _replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n\n      return true;\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) {\n      return;\n    }\n\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n    var this$1 = this;\n\n    if (this.readDOMTimeout != null) {\n      return;\n    }\n\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n\n      if (this$1.composing) {\n        if (this$1.composing.done) {\n          this$1.composing = null;\n        } else {\n          return;\n        }\n      }\n\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n    var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent()) {\n      runInOp(this.cm, function () {\n        return regChange(this$1.cm);\n      });\n    }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (!this.cm.isReadOnly()) {\n      operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0);\n    }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n\n    if (!view || view.hidden) {\n      return null;\n    }\n\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n    var order = getOrder(line, cm.doc.direction),\n        side = \"left\";\n\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result;\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode) {\n      if (/CodeMirror-gutter-wrapper/.test(scan.className)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function badPos(pos, bad) {\n    if (bad) {\n      pos.bad = true;\n    }\n\n    return pos;\n  }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\",\n        closing = false,\n        lineSep = cm.doc.lineSeparator(),\n        extraLinebreak = false;\n\n    function recognizeMarker(id) {\n      return function (marker) {\n        return marker.id == id;\n      };\n    }\n\n    function close() {\n      if (closing) {\n        text += lineSep;\n\n        if (extraLinebreak) {\n          text += lineSep;\n        }\n\n        closing = extraLinebreak = false;\n      }\n    }\n\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n\n        if (cmText) {\n          addText(cmText);\n          return;\n        }\n\n        var markerID = node.getAttribute(\"cm-marker\"),\n            range;\n\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n\n          if (found.length && (range = found[0].find(0))) {\n            addText(getBetween(cm.doc, range.from, range.to).join(lineSep));\n          }\n\n          return;\n        }\n\n        if (node.getAttribute(\"contenteditable\") == \"false\") {\n          return;\n        }\n\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) {\n          return;\n        }\n\n        if (isBlock) {\n          close();\n        }\n\n        for (var i = 0; i < node.childNodes.length; i++) {\n          walk(node.childNodes[i]);\n        }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) {\n          extraLinebreak = true;\n        }\n\n        if (isBlock) {\n          closing = true;\n        }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n\n    for (;;) {\n      walk(from);\n\n      if (from == to) {\n        break;\n      }\n\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n\n    return text;\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n\n      if (!lineNode) {\n        return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true);\n      }\n\n      node = null;\n      offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) {\n          return null;\n        }\n\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) {\n          break;\n        }\n      }\n    }\n\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n\n      if (lineView.node == lineNode) {\n        return locateNodeInLineView(lineView, node, offset);\n      }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild,\n        bad = false;\n\n    if (!node || !contains(wrapper, node)) {\n      return badPos(Pos(lineNo(lineView.line), 0), true);\n    }\n\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad);\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null,\n        topNode = node;\n\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n\n      if (offset) {\n        offset = textNode.nodeValue.length;\n      }\n    }\n\n    while (topNode.parentNode != wrapper) {\n      topNode = topNode.parentNode;\n    }\n\n    var measure = lineView.measure,\n        maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n\n            if (offset < 0 || curNode != textNode) {\n              ch = map[j + (offset ? 1 : 0)];\n            }\n\n            return Pos(line, ch);\n          }\n        }\n      }\n    }\n\n    var found = find(textNode, topNode, offset);\n\n    if (found) {\n      return badPos(found, bad);\n    } // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n\n\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n\n      if (found) {\n        return badPos(Pos(found.line, found.ch - dist), bad);\n      } else {\n        dist += after.textContent.length;\n      }\n    }\n\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n\n      if (found) {\n        return badPos(Pos(found.line, found.ch + dist$1), bad);\n      } else {\n        dist$1 += before.textContent.length;\n      }\n    }\n  } // TEXTAREA INPUT STYLE\n\n\n  var TextareaInput = function TextareaInput(cm) {\n    this.cm = cm; // See input.poll and input.reset\n\n    this.prevInput = \"\"; // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n\n    this.pollingFast = false; // Self-resetting timeout for the poller\n\n    this.polling = new Delayed(); // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n    var this$1 = this;\n    var input = this,\n        cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild); // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n\n    if (ios) {\n      te.style.width = \"0px\";\n    }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) {\n        this$1.hasSelection = null;\n      }\n\n      input.poll();\n    });\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) {\n        return;\n      }\n\n      cm.state.pasteIncoming = true;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) {\n        return;\n      }\n\n      if (cm.somethingSelected()) {\n        setLastCopied({\n          lineWise: false,\n          text: cm.getSelections()\n        });\n      } else if (!cm.options.lineWiseCopyCut) {\n        return;\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({\n          lineWise: true,\n          text: ranges.text\n        });\n\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n\n      if (e.type == \"cut\") {\n        cm.state.cutIncoming = true;\n      }\n    }\n\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) {\n        return;\n      }\n\n      cm.state.pasteIncoming = true;\n      input.focus();\n    }); // Prevent normal selection in the editor (we handle our own)\n\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) {\n        e_preventDefault(e);\n      }\n    });\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n\n      if (input.composing) {\n        input.composing.range.clear();\n      }\n\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {\n          className: \"CodeMirror-composing\"\n        })\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea(); // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm,\n        display = cm.display,\n        doc = cm.doc;\n    var result = prepareSelection(cm); // Move the hidden textarea near the cursor to prevent scrolling artifacts\n\n    if (cm.options.moveInputWithCursor) {\n      var headPos = _cursorCoords(cm, doc.sel.primary().head, \"div\");\n\n      var wrapOff = display.wrapper.getBoundingClientRect(),\n          lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10, headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10, headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result;\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm,\n        display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  }; // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n\n\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) {\n      return;\n    }\n\n    var cm = this.cm;\n\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n\n      if (cm.state.focused) {\n        selectInput(this.textarea);\n      }\n\n      if (ie && ie_version >= 9) {\n        this.hasSelection = content;\n      }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n\n      if (ie && ie_version >= 9) {\n        this.hasSelection = null;\n      }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () {\n    return this.textarea;\n  };\n\n  TextareaInput.prototype.supportsTouch = function () {\n    return false;\n  };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try {\n        this.textarea.focus();\n      } catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n\n    }\n  };\n\n  TextareaInput.prototype.blur = function () {\n    this.textarea.blur();\n  };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () {\n    this.slowPoll();\n  }; // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n\n\n  TextareaInput.prototype.slowPoll = function () {\n    var this$1 = this;\n\n    if (this.pollingFast) {\n      return;\n    }\n\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n\n      if (this$1.cm.state.focused) {\n        this$1.slowPoll();\n      }\n    });\n  }; // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n\n\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false,\n        input = this;\n    input.pollingFast = true;\n\n    function p() {\n      var changed = input.poll();\n\n      if (!changed && !missed) {\n        missed = true;\n        input.polling.set(60, p);\n      } else {\n        input.pollingFast = false;\n        input.slowPoll();\n      }\n    }\n\n    input.polling.set(20, p);\n  }; // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n\n\n  TextareaInput.prototype.poll = function () {\n    var this$1 = this;\n    var cm = this.cm,\n        input = this.textarea,\n        prevInput = this.prevInput; // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n\n    if (this.contextMenuPending || !cm.state.focused || hasSelection(input) && !prevInput && !this.composing || cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq) {\n      return false;\n    }\n\n    var text = input.value; // If nothing changed, bail.\n\n    if (text == prevInput && !cm.somethingSelected()) {\n      return false;\n    } // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n\n\n    if (ie && ie_version >= 9 && this.hasSelection === text || mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false;\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n\n      if (first == 0x200b && !prevInput) {\n        prevInput = \"\\u200B\";\n      }\n\n      if (first == 0x21da) {\n        this.reset();\n        return this.cm.execCommand(\"undo\");\n      }\n    } // Find the part of the input that is actually new\n\n\n    var same = 0,\n        l = Math.min(prevInput.length, text.length);\n\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) {\n      ++same;\n    }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same, null, this$1.composing ? \"*compose\" : null); // Don't leave long text in the textarea, since it makes further polling slow\n\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) {\n        input.value = this$1.prevInput = \"\";\n      } else {\n        this$1.prevInput = text;\n      }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"), {\n          className: \"CodeMirror-composing\"\n        });\n      }\n    });\n    return true;\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) {\n      this.pollingFast = false;\n    }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) {\n      this.hasSelection = null;\n    }\n\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this,\n        cm = input.cm,\n        display = cm.display,\n        te = input.textarea;\n    var pos = posFromMouse(cm, e),\n        scrollPos = display.scroller.scrollTop;\n\n    if (!pos || presto) {\n      return;\n    } // Opera is difficult.\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n\n\n    var reset = cm.options.resetSelectionOnContextMenu;\n\n    if (reset && cm.doc.sel.contains(pos) == -1) {\n      operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll);\n    }\n\n    var oldCSS = te.style.cssText,\n        oldWrapperCSS = input.wrapper.style.cssText;\n    input.wrapper.style.cssText = \"position: absolute\";\n    var wrapperBox = input.wrapper.getBoundingClientRect();\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n\n    if (webkit) {\n      oldScrollY = window.scrollY;\n    } // Work around Chrome issue (#2712)\n\n\n    display.input.focus();\n\n    if (webkit) {\n      window.scrollTo(null, oldScrollY);\n    }\n\n    display.input.reset(); // Adds \"Select all\" to context menu in FF\n\n    if (!cm.somethingSelected()) {\n      te.value = input.prevInput = \" \";\n    }\n\n    input.contextMenuPending = true;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll); // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200B\" + (selected ? te.value : \"\");\n        te.value = \"\\u21DA\"; // Used to catch context-menu undo\n\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200B\";\n        te.selectionStart = 1;\n        te.selectionEnd = extval.length; // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n\n    function rehide() {\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n\n      if (ie && ie_version < 9) {\n        display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos);\n      } // Try to detect the user choosing select-all\n\n\n      if (te.selectionStart != null) {\n        if (!ie || ie && ie_version < 9) {\n          prepareSelectAllHack();\n        }\n\n        var i = 0,\n            poll = function poll() {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 && te.selectionEnd > 0 && input.prevInput == \"\\u200B\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) {\n      prepareSelectAllHack();\n    }\n\n    if (captureRightClick) {\n      e_stop(e);\n\n      var mouseup = function mouseup() {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) {\n      this.reset();\n    }\n\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n\n    if (!options.tabindex && textarea.tabIndex) {\n      options.tabindex = textarea.tabIndex;\n    }\n\n    if (!options.placeholder && textarea.placeholder) {\n      options.placeholder = textarea.placeholder;\n    } // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n\n\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea || textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {\n      textarea.value = cm.getValue();\n    }\n\n    var realSubmit;\n\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save); // Deplorable hack to make the submit method do the right thing.\n\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch (e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n\n      cm.getTextArea = function () {\n        return textarea;\n      };\n\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n\n          if (typeof textarea.form.submit == \"function\") {\n            textarea.form.submit = realSubmit;\n          }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) {\n      return textarea.parentNode.insertBefore(node, textarea.nextSibling);\n    }, options);\n    return cm;\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  } // EDITOR CONSTRUCTOR\n\n\n  defineOptions(CodeMirror);\n  addEditorMethods(CodeMirror); // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n\n  for (var prop in Doc.prototype) {\n    if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0) {\n      CodeMirror.prototype[prop] = function (method) {\n        return function () {\n          return method.apply(this.doc, arguments);\n        };\n      }(Doc.prototype[prop]);\n    }\n  }\n\n  eventMixin(Doc); // INPUT HANDLING\n\n  CodeMirror.inputStyles = {\n    \"textarea\": TextareaInput,\n    \"contenteditable\": ContentEditableInput // MODE DEFINITION AND QUERYING\n    // Extra arguments are stored as the mode's dependencies, which is\n    // used by (legacy) mechanisms like loadmode.js to automatically\n    // load a mode. (Preferred mechanism is the require/define calls.)\n\n  };\n\n  CodeMirror.defineMode = function (name\n  /*, mode, …*/\n  ) {\n    if (!CodeMirror.defaults.mode && name != \"null\") {\n      CodeMirror.defaults.mode = name;\n    }\n\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME; // Minimal default mode.\n\n  CodeMirror.defineMode(\"null\", function () {\n    return {\n      token: function token(stream) {\n        return stream.skipToEnd();\n      }\n    };\n  });\n  CodeMirror.defineMIME(\"text/plain\", \"null\"); // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n  addLegacyProps(CodeMirror);\n  CodeMirror.version = \"5.40.2\";\n  return CodeMirror;\n});\n\n},{}],12:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) == \"object\" && (typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineMode(\"css\", function (config, parserConfig) {\n    var inline = parserConfig.inline;\n    if (!parserConfig.propertyKeywords) parserConfig = CodeMirror.resolveMode(\"text/css\");\n    var indentUnit = config.indentUnit,\n        tokenHooks = parserConfig.tokenHooks,\n        documentTypes = parserConfig.documentTypes || {},\n        mediaTypes = parserConfig.mediaTypes || {},\n        mediaFeatures = parserConfig.mediaFeatures || {},\n        mediaValueKeywords = parserConfig.mediaValueKeywords || {},\n        propertyKeywords = parserConfig.propertyKeywords || {},\n        nonStandardPropertyKeywords = parserConfig.nonStandardPropertyKeywords || {},\n        fontProperties = parserConfig.fontProperties || {},\n        counterDescriptors = parserConfig.counterDescriptors || {},\n        colorKeywords = parserConfig.colorKeywords || {},\n        valueKeywords = parserConfig.valueKeywords || {},\n        allowNested = parserConfig.allowNested,\n        lineComment = parserConfig.lineComment,\n        supportsAtComponent = parserConfig.supportsAtComponent === true;\n    var type, override;\n\n    function ret(style, tp) {\n      type = tp;\n      return style;\n    } // Tokenizers\n\n\n    function tokenBase(stream, state) {\n      var ch = stream.next();\n\n      if (tokenHooks[ch]) {\n        var result = tokenHooks[ch](stream, state);\n        if (result !== false) return result;\n      }\n\n      if (ch == \"@\") {\n        stream.eatWhile(/[\\w\\\\\\-]/);\n        return ret(\"def\", stream.current());\n      } else if (ch == \"=\" || (ch == \"~\" || ch == \"|\") && stream.eat(\"=\")) {\n        return ret(null, \"compare\");\n      } else if (ch == \"\\\"\" || ch == \"'\") {\n        state.tokenize = tokenString(ch);\n        return state.tokenize(stream, state);\n      } else if (ch == \"#\") {\n        stream.eatWhile(/[\\w\\\\\\-]/);\n        return ret(\"atom\", \"hash\");\n      } else if (ch == \"!\") {\n        stream.match(/^\\s*\\w*/);\n        return ret(\"keyword\", \"important\");\n      } else if (/\\d/.test(ch) || ch == \".\" && stream.eat(/\\d/)) {\n        stream.eatWhile(/[\\w.%]/);\n        return ret(\"number\", \"unit\");\n      } else if (ch === \"-\") {\n        if (/[\\d.]/.test(stream.peek())) {\n          stream.eatWhile(/[\\w.%]/);\n          return ret(\"number\", \"unit\");\n        } else if (stream.match(/^-[\\w\\\\\\-]+/)) {\n          stream.eatWhile(/[\\w\\\\\\-]/);\n          if (stream.match(/^\\s*:/, false)) return ret(\"variable-2\", \"variable-definition\");\n          return ret(\"variable-2\", \"variable\");\n        } else if (stream.match(/^\\w+-/)) {\n          return ret(\"meta\", \"meta\");\n        }\n      } else if (/[,+>*\\/]/.test(ch)) {\n        return ret(null, \"select-op\");\n      } else if (ch == \".\" && stream.match(/^-?[_a-z][_a-z0-9-]*/i)) {\n        return ret(\"qualifier\", \"qualifier\");\n      } else if (/[:;{}\\[\\]\\(\\)]/.test(ch)) {\n        return ret(null, ch);\n      } else if ((ch == \"u\" || ch == \"U\") && stream.match(/rl(-prefix)?\\(/i) || (ch == \"d\" || ch == \"D\") && stream.match(\"omain(\", true, true) || (ch == \"r\" || ch == \"R\") && stream.match(\"egexp(\", true, true)) {\n        stream.backUp(1);\n        state.tokenize = tokenParenthesized;\n        return ret(\"property\", \"word\");\n      } else if (/[\\w\\\\\\-]/.test(ch)) {\n        stream.eatWhile(/[\\w\\\\\\-]/);\n        return ret(\"property\", \"word\");\n      } else {\n        return ret(null, null);\n      }\n    }\n\n    function tokenString(quote) {\n      return function (stream, state) {\n        var escaped = false,\n            ch;\n\n        while ((ch = stream.next()) != null) {\n          if (ch == quote && !escaped) {\n            if (quote == \")\") stream.backUp(1);\n            break;\n          }\n\n          escaped = !escaped && ch == \"\\\\\";\n        }\n\n        if (ch == quote || !escaped && quote != \")\") state.tokenize = null;\n        return ret(\"string\", \"string\");\n      };\n    }\n\n    function tokenParenthesized(stream, state) {\n      stream.next(); // Must be '('\n\n      if (!stream.match(/\\s*[\\\"\\')]/, false)) state.tokenize = tokenString(\")\");else state.tokenize = null;\n      return ret(null, \"(\");\n    } // Context management\n\n\n    function Context(type, indent, prev) {\n      this.type = type;\n      this.indent = indent;\n      this.prev = prev;\n    }\n\n    function pushContext(state, stream, type, indent) {\n      state.context = new Context(type, stream.indentation() + (indent === false ? 0 : indentUnit), state.context);\n      return type;\n    }\n\n    function popContext(state) {\n      if (state.context.prev) state.context = state.context.prev;\n      return state.context.type;\n    }\n\n    function pass(type, stream, state) {\n      return states[state.context.type](type, stream, state);\n    }\n\n    function popAndPass(type, stream, state, n) {\n      for (var i = n || 1; i > 0; i--) {\n        state.context = state.context.prev;\n      }\n\n      return pass(type, stream, state);\n    } // Parser\n\n\n    function wordAsValue(stream) {\n      var word = stream.current().toLowerCase();\n      if (valueKeywords.hasOwnProperty(word)) override = \"atom\";else if (colorKeywords.hasOwnProperty(word)) override = \"keyword\";else override = \"variable\";\n    }\n\n    var states = {};\n\n    states.top = function (type, stream, state) {\n      if (type == \"{\") {\n        return pushContext(state, stream, \"block\");\n      } else if (type == \"}\" && state.context.prev) {\n        return popContext(state);\n      } else if (supportsAtComponent && /@component/i.test(type)) {\n        return pushContext(state, stream, \"atComponentBlock\");\n      } else if (/^@(-moz-)?document$/i.test(type)) {\n        return pushContext(state, stream, \"documentTypes\");\n      } else if (/^@(media|supports|(-moz-)?document|import)$/i.test(type)) {\n        return pushContext(state, stream, \"atBlock\");\n      } else if (/^@(font-face|counter-style)/i.test(type)) {\n        state.stateArg = type;\n        return \"restricted_atBlock_before\";\n      } else if (/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(type)) {\n        return \"keyframes\";\n      } else if (type && type.charAt(0) == \"@\") {\n        return pushContext(state, stream, \"at\");\n      } else if (type == \"hash\") {\n        override = \"builtin\";\n      } else if (type == \"word\") {\n        override = \"tag\";\n      } else if (type == \"variable-definition\") {\n        return \"maybeprop\";\n      } else if (type == \"interpolation\") {\n        return pushContext(state, stream, \"interpolation\");\n      } else if (type == \":\") {\n        return \"pseudo\";\n      } else if (allowNested && type == \"(\") {\n        return pushContext(state, stream, \"parens\");\n      }\n\n      return state.context.type;\n    };\n\n    states.block = function (type, stream, state) {\n      if (type == \"word\") {\n        var word = stream.current().toLowerCase();\n\n        if (propertyKeywords.hasOwnProperty(word)) {\n          override = \"property\";\n          return \"maybeprop\";\n        } else if (nonStandardPropertyKeywords.hasOwnProperty(word)) {\n          override = \"string-2\";\n          return \"maybeprop\";\n        } else if (allowNested) {\n          override = stream.match(/^\\s*:(?:\\s|$)/, false) ? \"property\" : \"tag\";\n          return \"block\";\n        } else {\n          override += \" error\";\n          return \"maybeprop\";\n        }\n      } else if (type == \"meta\") {\n        return \"block\";\n      } else if (!allowNested && (type == \"hash\" || type == \"qualifier\")) {\n        override = \"error\";\n        return \"block\";\n      } else {\n        return states.top(type, stream, state);\n      }\n    };\n\n    states.maybeprop = function (type, stream, state) {\n      if (type == \":\") return pushContext(state, stream, \"prop\");\n      return pass(type, stream, state);\n    };\n\n    states.prop = function (type, stream, state) {\n      if (type == \";\") return popContext(state);\n      if (type == \"{\" && allowNested) return pushContext(state, stream, \"propBlock\");\n      if (type == \"}\" || type == \"{\") return popAndPass(type, stream, state);\n      if (type == \"(\") return pushContext(state, stream, \"parens\");\n\n      if (type == \"hash\" && !/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(stream.current())) {\n        override += \" error\";\n      } else if (type == \"word\") {\n        wordAsValue(stream);\n      } else if (type == \"interpolation\") {\n        return pushContext(state, stream, \"interpolation\");\n      }\n\n      return \"prop\";\n    };\n\n    states.propBlock = function (type, _stream, state) {\n      if (type == \"}\") return popContext(state);\n\n      if (type == \"word\") {\n        override = \"property\";\n        return \"maybeprop\";\n      }\n\n      return state.context.type;\n    };\n\n    states.parens = function (type, stream, state) {\n      if (type == \"{\" || type == \"}\") return popAndPass(type, stream, state);\n      if (type == \")\") return popContext(state);\n      if (type == \"(\") return pushContext(state, stream, \"parens\");\n      if (type == \"interpolation\") return pushContext(state, stream, \"interpolation\");\n      if (type == \"word\") wordAsValue(stream);\n      return \"parens\";\n    };\n\n    states.pseudo = function (type, stream, state) {\n      if (type == \"meta\") return \"pseudo\";\n\n      if (type == \"word\") {\n        override = \"variable-3\";\n        return state.context.type;\n      }\n\n      return pass(type, stream, state);\n    };\n\n    states.documentTypes = function (type, stream, state) {\n      if (type == \"word\" && documentTypes.hasOwnProperty(stream.current())) {\n        override = \"tag\";\n        return state.context.type;\n      } else {\n        return states.atBlock(type, stream, state);\n      }\n    };\n\n    states.atBlock = function (type, stream, state) {\n      if (type == \"(\") return pushContext(state, stream, \"atBlock_parens\");\n      if (type == \"}\" || type == \";\") return popAndPass(type, stream, state);\n      if (type == \"{\") return popContext(state) && pushContext(state, stream, allowNested ? \"block\" : \"top\");\n      if (type == \"interpolation\") return pushContext(state, stream, \"interpolation\");\n\n      if (type == \"word\") {\n        var word = stream.current().toLowerCase();\n        if (word == \"only\" || word == \"not\" || word == \"and\" || word == \"or\") override = \"keyword\";else if (mediaTypes.hasOwnProperty(word)) override = \"attribute\";else if (mediaFeatures.hasOwnProperty(word)) override = \"property\";else if (mediaValueKeywords.hasOwnProperty(word)) override = \"keyword\";else if (propertyKeywords.hasOwnProperty(word)) override = \"property\";else if (nonStandardPropertyKeywords.hasOwnProperty(word)) override = \"string-2\";else if (valueKeywords.hasOwnProperty(word)) override = \"atom\";else if (colorKeywords.hasOwnProperty(word)) override = \"keyword\";else override = \"error\";\n      }\n\n      return state.context.type;\n    };\n\n    states.atComponentBlock = function (type, stream, state) {\n      if (type == \"}\") return popAndPass(type, stream, state);\n      if (type == \"{\") return popContext(state) && pushContext(state, stream, allowNested ? \"block\" : \"top\", false);\n      if (type == \"word\") override = \"error\";\n      return state.context.type;\n    };\n\n    states.atBlock_parens = function (type, stream, state) {\n      if (type == \")\") return popContext(state);\n      if (type == \"{\" || type == \"}\") return popAndPass(type, stream, state, 2);\n      return states.atBlock(type, stream, state);\n    };\n\n    states.restricted_atBlock_before = function (type, stream, state) {\n      if (type == \"{\") return pushContext(state, stream, \"restricted_atBlock\");\n\n      if (type == \"word\" && state.stateArg == \"@counter-style\") {\n        override = \"variable\";\n        return \"restricted_atBlock_before\";\n      }\n\n      return pass(type, stream, state);\n    };\n\n    states.restricted_atBlock = function (type, stream, state) {\n      if (type == \"}\") {\n        state.stateArg = null;\n        return popContext(state);\n      }\n\n      if (type == \"word\") {\n        if (state.stateArg == \"@font-face\" && !fontProperties.hasOwnProperty(stream.current().toLowerCase()) || state.stateArg == \"@counter-style\" && !counterDescriptors.hasOwnProperty(stream.current().toLowerCase())) override = \"error\";else override = \"property\";\n        return \"maybeprop\";\n      }\n\n      return \"restricted_atBlock\";\n    };\n\n    states.keyframes = function (type, stream, state) {\n      if (type == \"word\") {\n        override = \"variable\";\n        return \"keyframes\";\n      }\n\n      if (type == \"{\") return pushContext(state, stream, \"top\");\n      return pass(type, stream, state);\n    };\n\n    states.at = function (type, stream, state) {\n      if (type == \";\") return popContext(state);\n      if (type == \"{\" || type == \"}\") return popAndPass(type, stream, state);\n      if (type == \"word\") override = \"tag\";else if (type == \"hash\") override = \"builtin\";\n      return \"at\";\n    };\n\n    states.interpolation = function (type, stream, state) {\n      if (type == \"}\") return popContext(state);\n      if (type == \"{\" || type == \";\") return popAndPass(type, stream, state);\n      if (type == \"word\") override = \"variable\";else if (type != \"variable\" && type != \"(\" && type != \")\") override = \"error\";\n      return \"interpolation\";\n    };\n\n    return {\n      startState: function startState(base) {\n        return {\n          tokenize: null,\n          state: inline ? \"block\" : \"top\",\n          stateArg: null,\n          context: new Context(inline ? \"block\" : \"top\", base || 0, null)\n        };\n      },\n      token: function token(stream, state) {\n        if (!state.tokenize && stream.eatSpace()) return null;\n        var style = (state.tokenize || tokenBase)(stream, state);\n\n        if (style && _typeof(style) == \"object\") {\n          type = style[1];\n          style = style[0];\n        }\n\n        override = style;\n        if (type != \"comment\") state.state = states[state.state](type, stream, state);\n        return override;\n      },\n      indent: function indent(state, textAfter) {\n        var cx = state.context,\n            ch = textAfter && textAfter.charAt(0);\n        var indent = cx.indent;\n        if (cx.type == \"prop\" && (ch == \"}\" || ch == \")\")) cx = cx.prev;\n\n        if (cx.prev) {\n          if (ch == \"}\" && (cx.type == \"block\" || cx.type == \"top\" || cx.type == \"interpolation\" || cx.type == \"restricted_atBlock\")) {\n            // Resume indentation from parent context.\n            cx = cx.prev;\n            indent = cx.indent;\n          } else if (ch == \")\" && (cx.type == \"parens\" || cx.type == \"atBlock_parens\") || ch == \"{\" && (cx.type == \"at\" || cx.type == \"atBlock\")) {\n            // Dedent relative to current context.\n            indent = Math.max(0, cx.indent - indentUnit);\n          }\n        }\n\n        return indent;\n      },\n      electricChars: \"}\",\n      blockCommentStart: \"/*\",\n      blockCommentEnd: \"*/\",\n      blockCommentContinue: \" * \",\n      lineComment: lineComment,\n      fold: \"brace\"\n    };\n  });\n\n  function keySet(array) {\n    var keys = {};\n\n    for (var i = 0; i < array.length; ++i) {\n      keys[array[i].toLowerCase()] = true;\n    }\n\n    return keys;\n  }\n\n  var documentTypes_ = [\"domain\", \"regexp\", \"url\", \"url-prefix\"],\n      documentTypes = keySet(documentTypes_);\n  var mediaTypes_ = [\"all\", \"aural\", \"braille\", \"handheld\", \"print\", \"projection\", \"screen\", \"tty\", \"tv\", \"embossed\"],\n      mediaTypes = keySet(mediaTypes_);\n  var mediaFeatures_ = [\"width\", \"min-width\", \"max-width\", \"height\", \"min-height\", \"max-height\", \"device-width\", \"min-device-width\", \"max-device-width\", \"device-height\", \"min-device-height\", \"max-device-height\", \"aspect-ratio\", \"min-aspect-ratio\", \"max-aspect-ratio\", \"device-aspect-ratio\", \"min-device-aspect-ratio\", \"max-device-aspect-ratio\", \"color\", \"min-color\", \"max-color\", \"color-index\", \"min-color-index\", \"max-color-index\", \"monochrome\", \"min-monochrome\", \"max-monochrome\", \"resolution\", \"min-resolution\", \"max-resolution\", \"scan\", \"grid\", \"orientation\", \"device-pixel-ratio\", \"min-device-pixel-ratio\", \"max-device-pixel-ratio\", \"pointer\", \"any-pointer\", \"hover\", \"any-hover\"],\n      mediaFeatures = keySet(mediaFeatures_);\n  var mediaValueKeywords_ = [\"landscape\", \"portrait\", \"none\", \"coarse\", \"fine\", \"on-demand\", \"hover\", \"interlace\", \"progressive\"],\n      mediaValueKeywords = keySet(mediaValueKeywords_);\n  var propertyKeywords_ = [\"align-content\", \"align-items\", \"align-self\", \"alignment-adjust\", \"alignment-baseline\", \"anchor-point\", \"animation\", \"animation-delay\", \"animation-direction\", \"animation-duration\", \"animation-fill-mode\", \"animation-iteration-count\", \"animation-name\", \"animation-play-state\", \"animation-timing-function\", \"appearance\", \"azimuth\", \"backface-visibility\", \"background\", \"background-attachment\", \"background-blend-mode\", \"background-clip\", \"background-color\", \"background-image\", \"background-origin\", \"background-position\", \"background-repeat\", \"background-size\", \"baseline-shift\", \"binding\", \"bleed\", \"bookmark-label\", \"bookmark-level\", \"bookmark-state\", \"bookmark-target\", \"border\", \"border-bottom\", \"border-bottom-color\", \"border-bottom-left-radius\", \"border-bottom-right-radius\", \"border-bottom-style\", \"border-bottom-width\", \"border-collapse\", \"border-color\", \"border-image\", \"border-image-outset\", \"border-image-repeat\", \"border-image-slice\", \"border-image-source\", \"border-image-width\", \"border-left\", \"border-left-color\", \"border-left-style\", \"border-left-width\", \"border-radius\", \"border-right\", \"border-right-color\", \"border-right-style\", \"border-right-width\", \"border-spacing\", \"border-style\", \"border-top\", \"border-top-color\", \"border-top-left-radius\", \"border-top-right-radius\", \"border-top-style\", \"border-top-width\", \"border-width\", \"bottom\", \"box-decoration-break\", \"box-shadow\", \"box-sizing\", \"break-after\", \"break-before\", \"break-inside\", \"caption-side\", \"caret-color\", \"clear\", \"clip\", \"color\", \"color-profile\", \"column-count\", \"column-fill\", \"column-gap\", \"column-rule\", \"column-rule-color\", \"column-rule-style\", \"column-rule-width\", \"column-span\", \"column-width\", \"columns\", \"content\", \"counter-increment\", \"counter-reset\", \"crop\", \"cue\", \"cue-after\", \"cue-before\", \"cursor\", \"direction\", \"display\", \"dominant-baseline\", \"drop-initial-after-adjust\", \"drop-initial-after-align\", \"drop-initial-before-adjust\", \"drop-initial-before-align\", \"drop-initial-size\", \"drop-initial-value\", \"elevation\", \"empty-cells\", \"fit\", \"fit-position\", \"flex\", \"flex-basis\", \"flex-direction\", \"flex-flow\", \"flex-grow\", \"flex-shrink\", \"flex-wrap\", \"float\", \"float-offset\", \"flow-from\", \"flow-into\", \"font\", \"font-feature-settings\", \"font-family\", \"font-kerning\", \"font-language-override\", \"font-size\", \"font-size-adjust\", \"font-stretch\", \"font-style\", \"font-synthesis\", \"font-variant\", \"font-variant-alternates\", \"font-variant-caps\", \"font-variant-east-asian\", \"font-variant-ligatures\", \"font-variant-numeric\", \"font-variant-position\", \"font-weight\", \"grid\", \"grid-area\", \"grid-auto-columns\", \"grid-auto-flow\", \"grid-auto-rows\", \"grid-column\", \"grid-column-end\", \"grid-column-gap\", \"grid-column-start\", \"grid-gap\", \"grid-row\", \"grid-row-end\", \"grid-row-gap\", \"grid-row-start\", \"grid-template\", \"grid-template-areas\", \"grid-template-columns\", \"grid-template-rows\", \"hanging-punctuation\", \"height\", \"hyphens\", \"icon\", \"image-orientation\", \"image-rendering\", \"image-resolution\", \"inline-box-align\", \"justify-content\", \"justify-items\", \"justify-self\", \"left\", \"letter-spacing\", \"line-break\", \"line-height\", \"line-stacking\", \"line-stacking-ruby\", \"line-stacking-shift\", \"line-stacking-strategy\", \"list-style\", \"list-style-image\", \"list-style-position\", \"list-style-type\", \"margin\", \"margin-bottom\", \"margin-left\", \"margin-right\", \"margin-top\", \"marks\", \"marquee-direction\", \"marquee-loop\", \"marquee-play-count\", \"marquee-speed\", \"marquee-style\", \"max-height\", \"max-width\", \"min-height\", \"min-width\", \"move-to\", \"nav-down\", \"nav-index\", \"nav-left\", \"nav-right\", \"nav-up\", \"object-fit\", \"object-position\", \"opacity\", \"order\", \"orphans\", \"outline\", \"outline-color\", \"outline-offset\", \"outline-style\", \"outline-width\", \"overflow\", \"overflow-style\", \"overflow-wrap\", \"overflow-x\", \"overflow-y\", \"padding\", \"padding-bottom\", \"padding-left\", \"padding-right\", \"padding-top\", \"page\", \"page-break-after\", \"page-break-before\", \"page-break-inside\", \"page-policy\", \"pause\", \"pause-after\", \"pause-before\", \"perspective\", \"perspective-origin\", \"pitch\", \"pitch-range\", \"place-content\", \"place-items\", \"place-self\", \"play-during\", \"position\", \"presentation-level\", \"punctuation-trim\", \"quotes\", \"region-break-after\", \"region-break-before\", \"region-break-inside\", \"region-fragment\", \"rendering-intent\", \"resize\", \"rest\", \"rest-after\", \"rest-before\", \"richness\", \"right\", \"rotation\", \"rotation-point\", \"ruby-align\", \"ruby-overhang\", \"ruby-position\", \"ruby-span\", \"shape-image-threshold\", \"shape-inside\", \"shape-margin\", \"shape-outside\", \"size\", \"speak\", \"speak-as\", \"speak-header\", \"speak-numeral\", \"speak-punctuation\", \"speech-rate\", \"stress\", \"string-set\", \"tab-size\", \"table-layout\", \"target\", \"target-name\", \"target-new\", \"target-position\", \"text-align\", \"text-align-last\", \"text-decoration\", \"text-decoration-color\", \"text-decoration-line\", \"text-decoration-skip\", \"text-decoration-style\", \"text-emphasis\", \"text-emphasis-color\", \"text-emphasis-position\", \"text-emphasis-style\", \"text-height\", \"text-indent\", \"text-justify\", \"text-outline\", \"text-overflow\", \"text-shadow\", \"text-size-adjust\", \"text-space-collapse\", \"text-transform\", \"text-underline-position\", \"text-wrap\", \"top\", \"transform\", \"transform-origin\", \"transform-style\", \"transition\", \"transition-delay\", \"transition-duration\", \"transition-property\", \"transition-timing-function\", \"unicode-bidi\", \"user-select\", \"vertical-align\", \"visibility\", \"voice-balance\", \"voice-duration\", \"voice-family\", \"voice-pitch\", \"voice-range\", \"voice-rate\", \"voice-stress\", \"voice-volume\", \"volume\", \"white-space\", \"widows\", \"width\", \"will-change\", \"word-break\", \"word-spacing\", \"word-wrap\", \"z-index\", // SVG-specific\n  \"clip-path\", \"clip-rule\", \"mask\", \"enable-background\", \"filter\", \"flood-color\", \"flood-opacity\", \"lighting-color\", \"stop-color\", \"stop-opacity\", \"pointer-events\", \"color-interpolation\", \"color-interpolation-filters\", \"color-rendering\", \"fill\", \"fill-opacity\", \"fill-rule\", \"image-rendering\", \"marker\", \"marker-end\", \"marker-mid\", \"marker-start\", \"shape-rendering\", \"stroke\", \"stroke-dasharray\", \"stroke-dashoffset\", \"stroke-linecap\", \"stroke-linejoin\", \"stroke-miterlimit\", \"stroke-opacity\", \"stroke-width\", \"text-rendering\", \"baseline-shift\", \"dominant-baseline\", \"glyph-orientation-horizontal\", \"glyph-orientation-vertical\", \"text-anchor\", \"writing-mode\"],\n      propertyKeywords = keySet(propertyKeywords_);\n  var nonStandardPropertyKeywords_ = [\"scrollbar-arrow-color\", \"scrollbar-base-color\", \"scrollbar-dark-shadow-color\", \"scrollbar-face-color\", \"scrollbar-highlight-color\", \"scrollbar-shadow-color\", \"scrollbar-3d-light-color\", \"scrollbar-track-color\", \"shape-inside\", \"searchfield-cancel-button\", \"searchfield-decoration\", \"searchfield-results-button\", \"searchfield-results-decoration\", \"zoom\"],\n      nonStandardPropertyKeywords = keySet(nonStandardPropertyKeywords_);\n  var fontProperties_ = [\"font-family\", \"src\", \"unicode-range\", \"font-variant\", \"font-feature-settings\", \"font-stretch\", \"font-weight\", \"font-style\"],\n      fontProperties = keySet(fontProperties_);\n  var counterDescriptors_ = [\"additive-symbols\", \"fallback\", \"negative\", \"pad\", \"prefix\", \"range\", \"speak-as\", \"suffix\", \"symbols\", \"system\"],\n      counterDescriptors = keySet(counterDescriptors_);\n  var colorKeywords_ = [\"aliceblue\", \"antiquewhite\", \"aqua\", \"aquamarine\", \"azure\", \"beige\", \"bisque\", \"black\", \"blanchedalmond\", \"blue\", \"blueviolet\", \"brown\", \"burlywood\", \"cadetblue\", \"chartreuse\", \"chocolate\", \"coral\", \"cornflowerblue\", \"cornsilk\", \"crimson\", \"cyan\", \"darkblue\", \"darkcyan\", \"darkgoldenrod\", \"darkgray\", \"darkgreen\", \"darkkhaki\", \"darkmagenta\", \"darkolivegreen\", \"darkorange\", \"darkorchid\", \"darkred\", \"darksalmon\", \"darkseagreen\", \"darkslateblue\", \"darkslategray\", \"darkturquoise\", \"darkviolet\", \"deeppink\", \"deepskyblue\", \"dimgray\", \"dodgerblue\", \"firebrick\", \"floralwhite\", \"forestgreen\", \"fuchsia\", \"gainsboro\", \"ghostwhite\", \"gold\", \"goldenrod\", \"gray\", \"grey\", \"green\", \"greenyellow\", \"honeydew\", \"hotpink\", \"indianred\", \"indigo\", \"ivory\", \"khaki\", \"lavender\", \"lavenderblush\", \"lawngreen\", \"lemonchiffon\", \"lightblue\", \"lightcoral\", \"lightcyan\", \"lightgoldenrodyellow\", \"lightgray\", \"lightgreen\", \"lightpink\", \"lightsalmon\", \"lightseagreen\", \"lightskyblue\", \"lightslategray\", \"lightsteelblue\", \"lightyellow\", \"lime\", \"limegreen\", \"linen\", \"magenta\", \"maroon\", \"mediumaquamarine\", \"mediumblue\", \"mediumorchid\", \"mediumpurple\", \"mediumseagreen\", \"mediumslateblue\", \"mediumspringgreen\", \"mediumturquoise\", \"mediumvioletred\", \"midnightblue\", \"mintcream\", \"mistyrose\", \"moccasin\", \"navajowhite\", \"navy\", \"oldlace\", \"olive\", \"olivedrab\", \"orange\", \"orangered\", \"orchid\", \"palegoldenrod\", \"palegreen\", \"paleturquoise\", \"palevioletred\", \"papayawhip\", \"peachpuff\", \"peru\", \"pink\", \"plum\", \"powderblue\", \"purple\", \"rebeccapurple\", \"red\", \"rosybrown\", \"royalblue\", \"saddlebrown\", \"salmon\", \"sandybrown\", \"seagreen\", \"seashell\", \"sienna\", \"silver\", \"skyblue\", \"slateblue\", \"slategray\", \"snow\", \"springgreen\", \"steelblue\", \"tan\", \"teal\", \"thistle\", \"tomato\", \"turquoise\", \"violet\", \"wheat\", \"white\", \"whitesmoke\", \"yellow\", \"yellowgreen\"],\n      colorKeywords = keySet(colorKeywords_);\n  var valueKeywords_ = [\"above\", \"absolute\", \"activeborder\", \"additive\", \"activecaption\", \"afar\", \"after-white-space\", \"ahead\", \"alias\", \"all\", \"all-scroll\", \"alphabetic\", \"alternate\", \"always\", \"amharic\", \"amharic-abegede\", \"antialiased\", \"appworkspace\", \"arabic-indic\", \"armenian\", \"asterisks\", \"attr\", \"auto\", \"auto-flow\", \"avoid\", \"avoid-column\", \"avoid-page\", \"avoid-region\", \"background\", \"backwards\", \"baseline\", \"below\", \"bidi-override\", \"binary\", \"bengali\", \"blink\", \"block\", \"block-axis\", \"bold\", \"bolder\", \"border\", \"border-box\", \"both\", \"bottom\", \"break\", \"break-all\", \"break-word\", \"bullets\", \"button\", \"button-bevel\", \"buttonface\", \"buttonhighlight\", \"buttonshadow\", \"buttontext\", \"calc\", \"cambodian\", \"capitalize\", \"caps-lock-indicator\", \"caption\", \"captiontext\", \"caret\", \"cell\", \"center\", \"checkbox\", \"circle\", \"cjk-decimal\", \"cjk-earthly-branch\", \"cjk-heavenly-stem\", \"cjk-ideographic\", \"clear\", \"clip\", \"close-quote\", \"col-resize\", \"collapse\", \"color\", \"color-burn\", \"color-dodge\", \"column\", \"column-reverse\", \"compact\", \"condensed\", \"contain\", \"content\", \"contents\", \"content-box\", \"context-menu\", \"continuous\", \"copy\", \"counter\", \"counters\", \"cover\", \"crop\", \"cross\", \"crosshair\", \"currentcolor\", \"cursive\", \"cyclic\", \"darken\", \"dashed\", \"decimal\", \"decimal-leading-zero\", \"default\", \"default-button\", \"dense\", \"destination-atop\", \"destination-in\", \"destination-out\", \"destination-over\", \"devanagari\", \"difference\", \"disc\", \"discard\", \"disclosure-closed\", \"disclosure-open\", \"document\", \"dot-dash\", \"dot-dot-dash\", \"dotted\", \"double\", \"down\", \"e-resize\", \"ease\", \"ease-in\", \"ease-in-out\", \"ease-out\", \"element\", \"ellipse\", \"ellipsis\", \"embed\", \"end\", \"ethiopic\", \"ethiopic-abegede\", \"ethiopic-abegede-am-et\", \"ethiopic-abegede-gez\", \"ethiopic-abegede-ti-er\", \"ethiopic-abegede-ti-et\", \"ethiopic-halehame-aa-er\", \"ethiopic-halehame-aa-et\", \"ethiopic-halehame-am-et\", \"ethiopic-halehame-gez\", \"ethiopic-halehame-om-et\", \"ethiopic-halehame-sid-et\", \"ethiopic-halehame-so-et\", \"ethiopic-halehame-ti-er\", \"ethiopic-halehame-ti-et\", \"ethiopic-halehame-tig\", \"ethiopic-numeric\", \"ew-resize\", \"exclusion\", \"expanded\", \"extends\", \"extra-condensed\", \"extra-expanded\", \"fantasy\", \"fast\", \"fill\", \"fixed\", \"flat\", \"flex\", \"flex-end\", \"flex-start\", \"footnotes\", \"forwards\", \"from\", \"geometricPrecision\", \"georgian\", \"graytext\", \"grid\", \"groove\", \"gujarati\", \"gurmukhi\", \"hand\", \"hangul\", \"hangul-consonant\", \"hard-light\", \"hebrew\", \"help\", \"hidden\", \"hide\", \"higher\", \"highlight\", \"highlighttext\", \"hiragana\", \"hiragana-iroha\", \"horizontal\", \"hsl\", \"hsla\", \"hue\", \"icon\", \"ignore\", \"inactiveborder\", \"inactivecaption\", \"inactivecaptiontext\", \"infinite\", \"infobackground\", \"infotext\", \"inherit\", \"initial\", \"inline\", \"inline-axis\", \"inline-block\", \"inline-flex\", \"inline-grid\", \"inline-table\", \"inset\", \"inside\", \"intrinsic\", \"invert\", \"italic\", \"japanese-formal\", \"japanese-informal\", \"justify\", \"kannada\", \"katakana\", \"katakana-iroha\", \"keep-all\", \"khmer\", \"korean-hangul-formal\", \"korean-hanja-formal\", \"korean-hanja-informal\", \"landscape\", \"lao\", \"large\", \"larger\", \"left\", \"level\", \"lighter\", \"lighten\", \"line-through\", \"linear\", \"linear-gradient\", \"lines\", \"list-item\", \"listbox\", \"listitem\", \"local\", \"logical\", \"loud\", \"lower\", \"lower-alpha\", \"lower-armenian\", \"lower-greek\", \"lower-hexadecimal\", \"lower-latin\", \"lower-norwegian\", \"lower-roman\", \"lowercase\", \"ltr\", \"luminosity\", \"malayalam\", \"match\", \"matrix\", \"matrix3d\", \"media-controls-background\", \"media-current-time-display\", \"media-fullscreen-button\", \"media-mute-button\", \"media-play-button\", \"media-return-to-realtime-button\", \"media-rewind-button\", \"media-seek-back-button\", \"media-seek-forward-button\", \"media-slider\", \"media-sliderthumb\", \"media-time-remaining-display\", \"media-volume-slider\", \"media-volume-slider-container\", \"media-volume-sliderthumb\", \"medium\", \"menu\", \"menulist\", \"menulist-button\", \"menulist-text\", \"menulist-textfield\", \"menutext\", \"message-box\", \"middle\", \"min-intrinsic\", \"mix\", \"mongolian\", \"monospace\", \"move\", \"multiple\", \"multiply\", \"myanmar\", \"n-resize\", \"narrower\", \"ne-resize\", \"nesw-resize\", \"no-close-quote\", \"no-drop\", \"no-open-quote\", \"no-repeat\", \"none\", \"normal\", \"not-allowed\", \"nowrap\", \"ns-resize\", \"numbers\", \"numeric\", \"nw-resize\", \"nwse-resize\", \"oblique\", \"octal\", \"opacity\", \"open-quote\", \"optimizeLegibility\", \"optimizeSpeed\", \"oriya\", \"oromo\", \"outset\", \"outside\", \"outside-shape\", \"overlay\", \"overline\", \"padding\", \"padding-box\", \"painted\", \"page\", \"paused\", \"persian\", \"perspective\", \"plus-darker\", \"plus-lighter\", \"pointer\", \"polygon\", \"portrait\", \"pre\", \"pre-line\", \"pre-wrap\", \"preserve-3d\", \"progress\", \"push-button\", \"radial-gradient\", \"radio\", \"read-only\", \"read-write\", \"read-write-plaintext-only\", \"rectangle\", \"region\", \"relative\", \"repeat\", \"repeating-linear-gradient\", \"repeating-radial-gradient\", \"repeat-x\", \"repeat-y\", \"reset\", \"reverse\", \"rgb\", \"rgba\", \"ridge\", \"right\", \"rotate\", \"rotate3d\", \"rotateX\", \"rotateY\", \"rotateZ\", \"round\", \"row\", \"row-resize\", \"row-reverse\", \"rtl\", \"run-in\", \"running\", \"s-resize\", \"sans-serif\", \"saturation\", \"scale\", \"scale3d\", \"scaleX\", \"scaleY\", \"scaleZ\", \"screen\", \"scroll\", \"scrollbar\", \"scroll-position\", \"se-resize\", \"searchfield\", \"searchfield-cancel-button\", \"searchfield-decoration\", \"searchfield-results-button\", \"searchfield-results-decoration\", \"self-start\", \"self-end\", \"semi-condensed\", \"semi-expanded\", \"separate\", \"serif\", \"show\", \"sidama\", \"simp-chinese-formal\", \"simp-chinese-informal\", \"single\", \"skew\", \"skewX\", \"skewY\", \"skip-white-space\", \"slide\", \"slider-horizontal\", \"slider-vertical\", \"sliderthumb-horizontal\", \"sliderthumb-vertical\", \"slow\", \"small\", \"small-caps\", \"small-caption\", \"smaller\", \"soft-light\", \"solid\", \"somali\", \"source-atop\", \"source-in\", \"source-out\", \"source-over\", \"space\", \"space-around\", \"space-between\", \"space-evenly\", \"spell-out\", \"square\", \"square-button\", \"start\", \"static\", \"status-bar\", \"stretch\", \"stroke\", \"sub\", \"subpixel-antialiased\", \"super\", \"sw-resize\", \"symbolic\", \"symbols\", \"system-ui\", \"table\", \"table-caption\", \"table-cell\", \"table-column\", \"table-column-group\", \"table-footer-group\", \"table-header-group\", \"table-row\", \"table-row-group\", \"tamil\", \"telugu\", \"text\", \"text-bottom\", \"text-top\", \"textarea\", \"textfield\", \"thai\", \"thick\", \"thin\", \"threeddarkshadow\", \"threedface\", \"threedhighlight\", \"threedlightshadow\", \"threedshadow\", \"tibetan\", \"tigre\", \"tigrinya-er\", \"tigrinya-er-abegede\", \"tigrinya-et\", \"tigrinya-et-abegede\", \"to\", \"top\", \"trad-chinese-formal\", \"trad-chinese-informal\", \"transform\", \"translate\", \"translate3d\", \"translateX\", \"translateY\", \"translateZ\", \"transparent\", \"ultra-condensed\", \"ultra-expanded\", \"underline\", \"unset\", \"up\", \"upper-alpha\", \"upper-armenian\", \"upper-greek\", \"upper-hexadecimal\", \"upper-latin\", \"upper-norwegian\", \"upper-roman\", \"uppercase\", \"urdu\", \"url\", \"var\", \"vertical\", \"vertical-text\", \"visible\", \"visibleFill\", \"visiblePainted\", \"visibleStroke\", \"visual\", \"w-resize\", \"wait\", \"wave\", \"wider\", \"window\", \"windowframe\", \"windowtext\", \"words\", \"wrap\", \"wrap-reverse\", \"x-large\", \"x-small\", \"xor\", \"xx-large\", \"xx-small\"],\n      valueKeywords = keySet(valueKeywords_);\n  var allWords = documentTypes_.concat(mediaTypes_).concat(mediaFeatures_).concat(mediaValueKeywords_).concat(propertyKeywords_).concat(nonStandardPropertyKeywords_).concat(colorKeywords_).concat(valueKeywords_);\n  CodeMirror.registerHelper(\"hintWords\", \"css\", allWords);\n\n  function tokenCComment(stream, state) {\n    var maybeEnd = false,\n        ch;\n\n    while ((ch = stream.next()) != null) {\n      if (maybeEnd && ch == \"/\") {\n        state.tokenize = null;\n        break;\n      }\n\n      maybeEnd = ch == \"*\";\n    }\n\n    return [\"comment\", \"comment\"];\n  }\n\n  CodeMirror.defineMIME(\"text/css\", {\n    documentTypes: documentTypes,\n    mediaTypes: mediaTypes,\n    mediaFeatures: mediaFeatures,\n    mediaValueKeywords: mediaValueKeywords,\n    propertyKeywords: propertyKeywords,\n    nonStandardPropertyKeywords: nonStandardPropertyKeywords,\n    fontProperties: fontProperties,\n    counterDescriptors: counterDescriptors,\n    colorKeywords: colorKeywords,\n    valueKeywords: valueKeywords,\n    tokenHooks: {\n      \"/\": function _(stream, state) {\n        if (!stream.eat(\"*\")) return false;\n        state.tokenize = tokenCComment;\n        return tokenCComment(stream, state);\n      }\n    },\n    name: \"css\"\n  });\n  CodeMirror.defineMIME(\"text/x-scss\", {\n    mediaTypes: mediaTypes,\n    mediaFeatures: mediaFeatures,\n    mediaValueKeywords: mediaValueKeywords,\n    propertyKeywords: propertyKeywords,\n    nonStandardPropertyKeywords: nonStandardPropertyKeywords,\n    colorKeywords: colorKeywords,\n    valueKeywords: valueKeywords,\n    fontProperties: fontProperties,\n    allowNested: true,\n    lineComment: \"//\",\n    tokenHooks: {\n      \"/\": function _(stream, state) {\n        if (stream.eat(\"/\")) {\n          stream.skipToEnd();\n          return [\"comment\", \"comment\"];\n        } else if (stream.eat(\"*\")) {\n          state.tokenize = tokenCComment;\n          return tokenCComment(stream, state);\n        } else {\n          return [\"operator\", \"operator\"];\n        }\n      },\n      \":\": function _(stream) {\n        if (stream.match(/\\s*\\{/, false)) return [null, null];\n        return false;\n      },\n      \"$\": function $(stream) {\n        stream.match(/^[\\w-]+/);\n        if (stream.match(/^\\s*:/, false)) return [\"variable-2\", \"variable-definition\"];\n        return [\"variable-2\", \"variable\"];\n      },\n      \"#\": function _(stream) {\n        if (!stream.eat(\"{\")) return false;\n        return [null, \"interpolation\"];\n      }\n    },\n    name: \"css\",\n    helperType: \"scss\"\n  });\n  CodeMirror.defineMIME(\"text/x-less\", {\n    mediaTypes: mediaTypes,\n    mediaFeatures: mediaFeatures,\n    mediaValueKeywords: mediaValueKeywords,\n    propertyKeywords: propertyKeywords,\n    nonStandardPropertyKeywords: nonStandardPropertyKeywords,\n    colorKeywords: colorKeywords,\n    valueKeywords: valueKeywords,\n    fontProperties: fontProperties,\n    allowNested: true,\n    lineComment: \"//\",\n    tokenHooks: {\n      \"/\": function _(stream, state) {\n        if (stream.eat(\"/\")) {\n          stream.skipToEnd();\n          return [\"comment\", \"comment\"];\n        } else if (stream.eat(\"*\")) {\n          state.tokenize = tokenCComment;\n          return tokenCComment(stream, state);\n        } else {\n          return [\"operator\", \"operator\"];\n        }\n      },\n      \"@\": function _(stream) {\n        if (stream.eat(\"{\")) return [null, \"interpolation\"];\n        if (stream.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\\b/i, false)) return false;\n        stream.eatWhile(/[\\w\\\\\\-]/);\n        if (stream.match(/^\\s*:/, false)) return [\"variable-2\", \"variable-definition\"];\n        return [\"variable-2\", \"variable\"];\n      },\n      \"&\": function _() {\n        return [\"atom\", \"atom\"];\n      }\n    },\n    name: \"css\",\n    helperType: \"less\"\n  });\n  CodeMirror.defineMIME(\"text/x-gss\", {\n    documentTypes: documentTypes,\n    mediaTypes: mediaTypes,\n    mediaFeatures: mediaFeatures,\n    propertyKeywords: propertyKeywords,\n    nonStandardPropertyKeywords: nonStandardPropertyKeywords,\n    fontProperties: fontProperties,\n    counterDescriptors: counterDescriptors,\n    colorKeywords: colorKeywords,\n    valueKeywords: valueKeywords,\n    supportsAtComponent: true,\n    tokenHooks: {\n      \"/\": function _(stream, state) {\n        if (!stream.eat(\"*\")) return false;\n        state.tokenize = tokenCComment;\n        return tokenCComment(stream, state);\n      }\n    },\n    name: \"css\",\n    helperType: \"gss\"\n  });\n});\n\n},{\"../../lib/codemirror\":11}],13:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) == \"object\" && (typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../xml/xml\"), require(\"../javascript/javascript\"), require(\"../css/css\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../xml/xml\", \"../javascript/javascript\", \"../css/css\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  \"use strict\";\n\n  var defaultTags = {\n    script: [[\"lang\", /(javascript|babel)/i, \"javascript\"], [\"type\", /^(?:text|application)\\/(?:x-)?(?:java|ecma)script$|^module$|^$/i, \"javascript\"], [\"type\", /./, \"text/plain\"], [null, null, \"javascript\"]],\n    style: [[\"lang\", /^css$/i, \"css\"], [\"type\", /^(text\\/)?(x-)?(stylesheet|css)$/i, \"css\"], [\"type\", /./, \"text/plain\"], [null, null, \"css\"]]\n  };\n\n  function maybeBackup(stream, pat, style) {\n    var cur = stream.current(),\n        close = cur.search(pat);\n\n    if (close > -1) {\n      stream.backUp(cur.length - close);\n    } else if (cur.match(/<\\/?$/)) {\n      stream.backUp(cur.length);\n      if (!stream.match(pat, false)) stream.match(cur);\n    }\n\n    return style;\n  }\n\n  var attrRegexpCache = {};\n\n  function getAttrRegexp(attr) {\n    var regexp = attrRegexpCache[attr];\n    if (regexp) return regexp;\n    return attrRegexpCache[attr] = new RegExp(\"\\\\s+\" + attr + \"\\\\s*=\\\\s*('|\\\")?([^'\\\"]+)('|\\\")?\\\\s*\");\n  }\n\n  function getAttrValue(text, attr) {\n    var match = text.match(getAttrRegexp(attr));\n    return match ? /^\\s*(.*?)\\s*$/.exec(match[2])[1] : \"\";\n  }\n\n  function getTagRegexp(tagName, anchored) {\n    return new RegExp((anchored ? \"^\" : \"\") + \"<\\/\\s*\" + tagName + \"\\s*>\", \"i\");\n  }\n\n  function addTags(from, to) {\n    for (var tag in from) {\n      var dest = to[tag] || (to[tag] = []);\n      var source = from[tag];\n\n      for (var i = source.length - 1; i >= 0; i--) {\n        dest.unshift(source[i]);\n      }\n    }\n  }\n\n  function findMatchingMode(tagInfo, tagText) {\n    for (var i = 0; i < tagInfo.length; i++) {\n      var spec = tagInfo[i];\n      if (!spec[0] || spec[1].test(getAttrValue(tagText, spec[0]))) return spec[2];\n    }\n  }\n\n  CodeMirror.defineMode(\"htmlmixed\", function (config, parserConfig) {\n    var htmlMode = CodeMirror.getMode(config, {\n      name: \"xml\",\n      htmlMode: true,\n      multilineTagIndentFactor: parserConfig.multilineTagIndentFactor,\n      multilineTagIndentPastTag: parserConfig.multilineTagIndentPastTag\n    });\n    var tags = {};\n    var configTags = parserConfig && parserConfig.tags,\n        configScript = parserConfig && parserConfig.scriptTypes;\n    addTags(defaultTags, tags);\n    if (configTags) addTags(configTags, tags);\n    if (configScript) for (var i = configScript.length - 1; i >= 0; i--) {\n      tags.script.unshift([\"type\", configScript[i].matches, configScript[i].mode]);\n    }\n\n    function html(stream, state) {\n      var style = htmlMode.token(stream, state.htmlState),\n          tag = /\\btag\\b/.test(style),\n          tagName;\n\n      if (tag && !/[<>\\s\\/]/.test(stream.current()) && (tagName = state.htmlState.tagName && state.htmlState.tagName.toLowerCase()) && tags.hasOwnProperty(tagName)) {\n        state.inTag = tagName + \" \";\n      } else if (state.inTag && tag && />$/.test(stream.current())) {\n        var inTag = /^([\\S]+) (.*)/.exec(state.inTag);\n        state.inTag = null;\n        var modeSpec = stream.current() == \">\" && findMatchingMode(tags[inTag[1]], inTag[2]);\n        var mode = CodeMirror.getMode(config, modeSpec);\n        var endTagA = getTagRegexp(inTag[1], true),\n            endTag = getTagRegexp(inTag[1], false);\n\n        state.token = function (stream, state) {\n          if (stream.match(endTagA, false)) {\n            state.token = html;\n            state.localState = state.localMode = null;\n            return null;\n          }\n\n          return maybeBackup(stream, endTag, state.localMode.token(stream, state.localState));\n        };\n\n        state.localMode = mode;\n        state.localState = CodeMirror.startState(mode, htmlMode.indent(state.htmlState, \"\"));\n      } else if (state.inTag) {\n        state.inTag += stream.current();\n        if (stream.eol()) state.inTag += \" \";\n      }\n\n      return style;\n    }\n\n    ;\n    return {\n      startState: function startState() {\n        var state = CodeMirror.startState(htmlMode);\n        return {\n          token: html,\n          inTag: null,\n          localMode: null,\n          localState: null,\n          htmlState: state\n        };\n      },\n      copyState: function copyState(state) {\n        var local;\n\n        if (state.localState) {\n          local = CodeMirror.copyState(state.localMode, state.localState);\n        }\n\n        return {\n          token: state.token,\n          inTag: state.inTag,\n          localMode: state.localMode,\n          localState: local,\n          htmlState: CodeMirror.copyState(htmlMode, state.htmlState)\n        };\n      },\n      token: function token(stream, state) {\n        return state.token(stream, state);\n      },\n      indent: function indent(state, textAfter, line) {\n        if (!state.localMode || /^\\s*<\\//.test(textAfter)) return htmlMode.indent(state.htmlState, textAfter);else if (state.localMode.indent) return state.localMode.indent(state.localState, textAfter, line);else return CodeMirror.Pass;\n      },\n      innerMode: function innerMode(state) {\n        return {\n          state: state.localState || state.htmlState,\n          mode: state.localMode || htmlMode\n        };\n      }\n    };\n  }, \"xml\", \"javascript\", \"css\");\n  CodeMirror.defineMIME(\"text/html\", \"htmlmixed\");\n});\n\n},{\"../../lib/codemirror\":11,\"../css/css\":12,\"../javascript/javascript\":14,\"../xml/xml\":15}],14:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) == \"object\" && (typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineMode(\"javascript\", function (config, parserConfig) {\n    var indentUnit = config.indentUnit;\n    var statementIndent = parserConfig.statementIndent;\n    var jsonldMode = parserConfig.jsonld;\n    var jsonMode = parserConfig.json || jsonldMode;\n    var isTS = parserConfig.typescript;\n    var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/; // Tokenizer\n\n    var keywords = function () {\n      function kw(type) {\n        return {\n          type: type,\n          style: \"keyword\"\n        };\n      }\n\n      var A = kw(\"keyword a\"),\n          B = kw(\"keyword b\"),\n          C = kw(\"keyword c\"),\n          D = kw(\"keyword d\");\n      var operator = kw(\"operator\"),\n          atom = {\n        type: \"atom\",\n        style: \"atom\"\n      };\n      return {\n        \"if\": kw(\"if\"),\n        \"while\": A,\n        \"with\": A,\n        \"else\": B,\n        \"do\": B,\n        \"try\": B,\n        \"finally\": B,\n        \"return\": D,\n        \"break\": D,\n        \"continue\": D,\n        \"new\": kw(\"new\"),\n        \"delete\": C,\n        \"void\": C,\n        \"throw\": C,\n        \"debugger\": kw(\"debugger\"),\n        \"var\": kw(\"var\"),\n        \"const\": kw(\"var\"),\n        \"let\": kw(\"var\"),\n        \"function\": kw(\"function\"),\n        \"catch\": kw(\"catch\"),\n        \"for\": kw(\"for\"),\n        \"switch\": kw(\"switch\"),\n        \"case\": kw(\"case\"),\n        \"default\": kw(\"default\"),\n        \"in\": operator,\n        \"typeof\": operator,\n        \"instanceof\": operator,\n        \"true\": atom,\n        \"false\": atom,\n        \"null\": atom,\n        \"undefined\": atom,\n        \"NaN\": atom,\n        \"Infinity\": atom,\n        \"this\": kw(\"this\"),\n        \"class\": kw(\"class\"),\n        \"super\": kw(\"atom\"),\n        \"yield\": C,\n        \"export\": kw(\"export\"),\n        \"import\": kw(\"import\"),\n        \"extends\": C,\n        \"await\": C\n      };\n    }();\n\n    var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n    var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n    function readRegexp(stream) {\n      var escaped = false,\n          next,\n          inSet = false;\n\n      while ((next = stream.next()) != null) {\n        if (!escaped) {\n          if (next == \"/\" && !inSet) return;\n          if (next == \"[\") inSet = true;else if (inSet && next == \"]\") inSet = false;\n        }\n\n        escaped = !escaped && next == \"\\\\\";\n      }\n    } // Used as scratch variables to communicate multiple values without\n    // consing up tons of objects.\n\n\n    var type, content;\n\n    function ret(tp, style, cont) {\n      type = tp;\n      content = cont;\n      return style;\n    }\n\n    function tokenBase(stream, state) {\n      var ch = stream.next();\n\n      if (ch == '\"' || ch == \"'\") {\n        state.tokenize = tokenString(ch);\n        return state.tokenize(stream, state);\n      } else if (ch == \".\" && stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)) {\n        return ret(\"number\", \"number\");\n      } else if (ch == \".\" && stream.match(\"..\")) {\n        return ret(\"spread\", \"meta\");\n      } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n        return ret(ch);\n      } else if (ch == \"=\" && stream.eat(\">\")) {\n        return ret(\"=>\", \"operator\");\n      } else if (ch == \"0\" && stream.match(/^(?:x[\\da-f]+|o[0-7]+|b[01]+)n?/i)) {\n        return ret(\"number\", \"number\");\n      } else if (/\\d/.test(ch)) {\n        stream.match(/^\\d*(?:n|(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)?/);\n        return ret(\"number\", \"number\");\n      } else if (ch == \"/\") {\n        if (stream.eat(\"*\")) {\n          state.tokenize = tokenComment;\n          return tokenComment(stream, state);\n        } else if (stream.eat(\"/\")) {\n          stream.skipToEnd();\n          return ret(\"comment\", \"comment\");\n        } else if (expressionAllowed(stream, state, 1)) {\n          readRegexp(stream);\n          stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n          return ret(\"regexp\", \"string-2\");\n        } else {\n          stream.eat(\"=\");\n          return ret(\"operator\", \"operator\", stream.current());\n        }\n      } else if (ch == \"`\") {\n        state.tokenize = tokenQuasi;\n        return tokenQuasi(stream, state);\n      } else if (ch == \"#\") {\n        stream.skipToEnd();\n        return ret(\"error\", \"error\");\n      } else if (isOperatorChar.test(ch)) {\n        if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n          if (stream.eat(\"=\")) {\n            if (ch == \"!\" || ch == \"=\") stream.eat(\"=\");\n          } else if (/[<>*+\\-]/.test(ch)) {\n            stream.eat(ch);\n            if (ch == \">\") stream.eat(ch);\n          }\n        }\n\n        return ret(\"operator\", \"operator\", stream.current());\n      } else if (wordRE.test(ch)) {\n        stream.eatWhile(wordRE);\n        var word = stream.current();\n\n        if (state.lastType != \".\") {\n          if (keywords.propertyIsEnumerable(word)) {\n            var kw = keywords[word];\n            return ret(kw.type, kw.style, word);\n          }\n\n          if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false)) return ret(\"async\", \"keyword\", word);\n        }\n\n        return ret(\"variable\", \"variable\", word);\n      }\n    }\n\n    function tokenString(quote) {\n      return function (stream, state) {\n        var escaped = false,\n            next;\n\n        if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)) {\n          state.tokenize = tokenBase;\n          return ret(\"jsonld-keyword\", \"meta\");\n        }\n\n        while ((next = stream.next()) != null) {\n          if (next == quote && !escaped) break;\n          escaped = !escaped && next == \"\\\\\";\n        }\n\n        if (!escaped) state.tokenize = tokenBase;\n        return ret(\"string\", \"string\");\n      };\n    }\n\n    function tokenComment(stream, state) {\n      var maybeEnd = false,\n          ch;\n\n      while (ch = stream.next()) {\n        if (ch == \"/\" && maybeEnd) {\n          state.tokenize = tokenBase;\n          break;\n        }\n\n        maybeEnd = ch == \"*\";\n      }\n\n      return ret(\"comment\", \"comment\");\n    }\n\n    function tokenQuasi(stream, state) {\n      var escaped = false,\n          next;\n\n      while ((next = stream.next()) != null) {\n        if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n          state.tokenize = tokenBase;\n          break;\n        }\n\n        escaped = !escaped && next == \"\\\\\";\n      }\n\n      return ret(\"quasi\", \"string-2\", stream.current());\n    }\n\n    var brackets = \"([{}])\"; // This is a crude lookahead trick to try and notice that we're\n    // parsing the argument patterns for a fat-arrow function before we\n    // actually hit the arrow token. It only works if the arrow is on\n    // the same line as the arguments and there's no strange noise\n    // (comments) in between. Fallback is to only notice when we hit the\n    // arrow, and not declare the arguments as locals for the arrow\n    // body.\n\n    function findFatArrow(stream, state) {\n      if (state.fatArrowAt) state.fatArrowAt = null;\n      var arrow = stream.string.indexOf(\"=>\", stream.start);\n      if (arrow < 0) return;\n\n      if (isTS) {\n        // Try to skip TypeScript return type declarations after the arguments\n        var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow));\n        if (m) arrow = m.index;\n      }\n\n      var depth = 0,\n          sawSomething = false;\n\n      for (var pos = arrow - 1; pos >= 0; --pos) {\n        var ch = stream.string.charAt(pos);\n        var bracket = brackets.indexOf(ch);\n\n        if (bracket >= 0 && bracket < 3) {\n          if (!depth) {\n            ++pos;\n            break;\n          }\n\n          if (--depth == 0) {\n            if (ch == \"(\") sawSomething = true;\n            break;\n          }\n        } else if (bracket >= 3 && bracket < 6) {\n          ++depth;\n        } else if (wordRE.test(ch)) {\n          sawSomething = true;\n        } else if (/[\"'\\/]/.test(ch)) {\n          return;\n        } else if (sawSomething && !depth) {\n          ++pos;\n          break;\n        }\n      }\n\n      if (sawSomething && !depth) state.fatArrowAt = pos;\n    } // Parser\n\n\n    var atomicTypes = {\n      \"atom\": true,\n      \"number\": true,\n      \"variable\": true,\n      \"string\": true,\n      \"regexp\": true,\n      \"this\": true,\n      \"jsonld-keyword\": true\n    };\n\n    function JSLexical(indented, column, type, align, prev, info) {\n      this.indented = indented;\n      this.column = column;\n      this.type = type;\n      this.prev = prev;\n      this.info = info;\n      if (align != null) this.align = align;\n    }\n\n    function inScope(state, varname) {\n      for (var v = state.localVars; v; v = v.next) {\n        if (v.name == varname) return true;\n      }\n\n      for (var cx = state.context; cx; cx = cx.prev) {\n        for (var v = cx.vars; v; v = v.next) {\n          if (v.name == varname) return true;\n        }\n      }\n    }\n\n    function parseJS(state, style, type, content, stream) {\n      var cc = state.cc; // Communicate our context to the combinators.\n      // (Less wasteful than consing up a hundred closures on every call.)\n\n      cx.state = state;\n      cx.stream = stream;\n      cx.marked = null, cx.cc = cc;\n      cx.style = style;\n      if (!state.lexical.hasOwnProperty(\"align\")) state.lexical.align = true;\n\n      while (true) {\n        var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n\n        if (combinator(type, content)) {\n          while (cc.length && cc[cc.length - 1].lex) {\n            cc.pop()();\n          }\n\n          if (cx.marked) return cx.marked;\n          if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n          return style;\n        }\n      }\n    } // Combinator utils\n\n\n    var cx = {\n      state: null,\n      column: null,\n      marked: null,\n      cc: null\n    };\n\n    function pass() {\n      for (var i = arguments.length - 1; i >= 0; i--) {\n        cx.cc.push(arguments[i]);\n      }\n    }\n\n    function cont() {\n      pass.apply(null, arguments);\n      return true;\n    }\n\n    function inList(name, list) {\n      for (var v = list; v; v = v.next) {\n        if (v.name == name) return true;\n      }\n\n      return false;\n    }\n\n    function register(varname) {\n      var state = cx.state;\n      cx.marked = \"def\";\n\n      if (state.context) {\n        if (state.lexical.info == \"var\" && state.context && state.context.block) {\n          // FIXME function decls are also not block scoped\n          var newContext = registerVarScoped(varname, state.context);\n\n          if (newContext != null) {\n            state.context = newContext;\n            return;\n          }\n        } else if (!inList(varname, state.localVars)) {\n          state.localVars = new Var(varname, state.localVars);\n          return;\n        }\n      } // Fall through means this is global\n\n\n      if (parserConfig.globalVars && !inList(varname, state.globalVars)) state.globalVars = new Var(varname, state.globalVars);\n    }\n\n    function registerVarScoped(varname, context) {\n      if (!context) {\n        return null;\n      } else if (context.block) {\n        var inner = registerVarScoped(varname, context.prev);\n        if (!inner) return null;\n        if (inner == context.prev) return context;\n        return new Context(inner, context.vars, true);\n      } else if (inList(varname, context.vars)) {\n        return context;\n      } else {\n        return new Context(context.prev, new Var(varname, context.vars), false);\n      }\n    }\n\n    function isModifier(name) {\n      return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\";\n    } // Combinators\n\n\n    function Context(prev, vars, block) {\n      this.prev = prev;\n      this.vars = vars;\n      this.block = block;\n    }\n\n    function Var(name, next) {\n      this.name = name;\n      this.next = next;\n    }\n\n    var defaultVars = new Var(\"this\", new Var(\"arguments\", null));\n\n    function pushcontext() {\n      cx.state.context = new Context(cx.state.context, cx.state.localVars, false);\n      cx.state.localVars = defaultVars;\n    }\n\n    function pushblockcontext() {\n      cx.state.context = new Context(cx.state.context, cx.state.localVars, true);\n      cx.state.localVars = null;\n    }\n\n    function popcontext() {\n      cx.state.localVars = cx.state.context.vars;\n      cx.state.context = cx.state.context.prev;\n    }\n\n    popcontext.lex = true;\n\n    function pushlex(type, info) {\n      var result = function result() {\n        var state = cx.state,\n            indent = state.indented;\n        if (state.lexical.type == \"stat\") indent = state.lexical.indented;else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev) {\n          indent = outer.indented;\n        }\n        state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n      };\n\n      result.lex = true;\n      return result;\n    }\n\n    function poplex() {\n      var state = cx.state;\n\n      if (state.lexical.prev) {\n        if (state.lexical.type == \")\") state.indented = state.lexical.indented;\n        state.lexical = state.lexical.prev;\n      }\n    }\n\n    poplex.lex = true;\n\n    function expect(wanted) {\n      function exp(type) {\n        if (type == wanted) return cont();else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();else return cont(exp);\n      }\n\n      ;\n      return exp;\n    }\n\n    function statement(type, value) {\n      if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n      if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n      if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n      if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n      if (type == \"debugger\") return cont(expect(\";\"));\n      if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n      if (type == \";\") return cont();\n\n      if (type == \"if\") {\n        if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex) cx.state.cc.pop()();\n        return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n      }\n\n      if (type == \"function\") return cont(functiondef);\n      if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n\n      if (type == \"class\" || isTS && value == \"interface\") {\n        cx.marked = \"keyword\";\n        return cont(pushlex(\"form\"), className, poplex);\n      }\n\n      if (type == \"variable\") {\n        if (isTS && value == \"declare\") {\n          cx.marked = \"keyword\";\n          return cont(statement);\n        } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n          cx.marked = \"keyword\";\n          if (value == \"enum\") return cont(enumdef);else if (value == \"type\") return cont(typeexpr, expect(\"operator\"), typeexpr, expect(\";\"));else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex);\n        } else if (isTS && value == \"namespace\") {\n          cx.marked = \"keyword\";\n          return cont(pushlex(\"form\"), expression, block, poplex);\n        } else if (isTS && value == \"abstract\") {\n          cx.marked = \"keyword\";\n          return cont(statement);\n        } else {\n          return cont(pushlex(\"stat\"), maybelabel);\n        }\n      }\n\n      if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext, block, poplex, poplex, popcontext);\n      if (type == \"case\") return cont(expression, expect(\":\"));\n      if (type == \"default\") return cont(expect(\":\"));\n      if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n      if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n      if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n      if (type == \"async\") return cont(statement);\n      if (value == \"@\") return cont(expression, statement);\n      return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n    }\n\n    function maybeCatchBinding(type) {\n      if (type == \"(\") return cont(funarg, expect(\")\"));\n    }\n\n    function expression(type, value) {\n      return expressionInner(type, value, false);\n    }\n\n    function expressionNoComma(type, value) {\n      return expressionInner(type, value, true);\n    }\n\n    function parenExpr(type) {\n      if (type != \"(\") return pass();\n      return cont(pushlex(\")\"), expression, expect(\")\"), poplex);\n    }\n\n    function expressionInner(type, value, noComma) {\n      if (cx.state.fatArrowAt == cx.stream.start) {\n        var body = noComma ? arrowBodyNoComma : arrowBody;\n        if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n      }\n\n      var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n      if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n      if (type == \"function\") return cont(functiondef, maybeop);\n\n      if (type == \"class\" || isTS && value == \"interface\") {\n        cx.marked = \"keyword\";\n        return cont(pushlex(\"form\"), classExpression, poplex);\n      }\n\n      if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n      if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n      if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n      if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n      if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n      if (type == \"quasi\") return pass(quasi, maybeop);\n      if (type == \"new\") return cont(maybeTarget(noComma));\n      if (type == \"import\") return cont(expression);\n      return cont();\n    }\n\n    function maybeexpression(type) {\n      if (type.match(/[;\\}\\)\\],]/)) return pass();\n      return pass(expression);\n    }\n\n    function maybeoperatorComma(type, value) {\n      if (type == \",\") return cont(expression);\n      return maybeoperatorNoComma(type, value, false);\n    }\n\n    function maybeoperatorNoComma(type, value, noComma) {\n      var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n      var expr = noComma == false ? expression : expressionNoComma;\n      if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n\n      if (type == \"operator\") {\n        if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n        if (isTS && value == \"<\" && cx.stream.match(/^([^>]|<.*?>)*>\\s*\\(/, false)) return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n        if (value == \"?\") return cont(expression, expect(\":\"), expr);\n        return cont(expr);\n      }\n\n      if (type == \"quasi\") {\n        return pass(quasi, me);\n      }\n\n      if (type == \";\") return;\n      if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n      if (type == \".\") return cont(property, me);\n      if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n\n      if (isTS && value == \"as\") {\n        cx.marked = \"keyword\";\n        return cont(typeexpr, me);\n      }\n\n      if (type == \"regexp\") {\n        cx.state.lastType = cx.marked = \"operator\";\n        cx.stream.backUp(cx.stream.pos - cx.stream.start - 1);\n        return cont(expr);\n      }\n    }\n\n    function quasi(type, value) {\n      if (type != \"quasi\") return pass();\n      if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n      return cont(expression, continueQuasi);\n    }\n\n    function continueQuasi(type) {\n      if (type == \"}\") {\n        cx.marked = \"string-2\";\n        cx.state.tokenize = tokenQuasi;\n        return cont(quasi);\n      }\n    }\n\n    function arrowBody(type) {\n      findFatArrow(cx.stream, cx.state);\n      return pass(type == \"{\" ? statement : expression);\n    }\n\n    function arrowBodyNoComma(type) {\n      findFatArrow(cx.stream, cx.state);\n      return pass(type == \"{\" ? statement : expressionNoComma);\n    }\n\n    function maybeTarget(noComma) {\n      return function (type) {\n        if (type == \".\") return cont(noComma ? targetNoComma : target);else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma);else return pass(noComma ? expressionNoComma : expression);\n      };\n    }\n\n    function target(_, value) {\n      if (value == \"target\") {\n        cx.marked = \"keyword\";\n        return cont(maybeoperatorComma);\n      }\n    }\n\n    function targetNoComma(_, value) {\n      if (value == \"target\") {\n        cx.marked = \"keyword\";\n        return cont(maybeoperatorNoComma);\n      }\n    }\n\n    function maybelabel(type) {\n      if (type == \":\") return cont(poplex, statement);\n      return pass(maybeoperatorComma, expect(\";\"), poplex);\n    }\n\n    function property(type) {\n      if (type == \"variable\") {\n        cx.marked = \"property\";\n        return cont();\n      }\n    }\n\n    function objprop(type, value) {\n      if (type == \"async\") {\n        cx.marked = \"property\";\n        return cont(objprop);\n      } else if (type == \"variable\" || cx.style == \"keyword\") {\n        cx.marked = \"property\";\n        if (value == \"get\" || value == \"set\") return cont(getterSetter);\n        var m; // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n\n        if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false))) cx.state.fatArrowAt = cx.stream.pos + m[0].length;\n        return cont(afterprop);\n      } else if (type == \"number\" || type == \"string\") {\n        cx.marked = jsonldMode ? \"property\" : cx.style + \" property\";\n        return cont(afterprop);\n      } else if (type == \"jsonld-keyword\") {\n        return cont(afterprop);\n      } else if (isTS && isModifier(value)) {\n        cx.marked = \"keyword\";\n        return cont(objprop);\n      } else if (type == \"[\") {\n        return cont(expression, maybetype, expect(\"]\"), afterprop);\n      } else if (type == \"spread\") {\n        return cont(expressionNoComma, afterprop);\n      } else if (value == \"*\") {\n        cx.marked = \"keyword\";\n        return cont(objprop);\n      } else if (type == \":\") {\n        return pass(afterprop);\n      }\n    }\n\n    function getterSetter(type) {\n      if (type != \"variable\") return pass(afterprop);\n      cx.marked = \"property\";\n      return cont(functiondef);\n    }\n\n    function afterprop(type) {\n      if (type == \":\") return cont(expressionNoComma);\n      if (type == \"(\") return pass(functiondef);\n    }\n\n    function commasep(what, end, sep) {\n      function proceed(type, value) {\n        if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n          var lex = cx.state.lexical;\n          if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n          return cont(function (type, value) {\n            if (type == end || value == end) return pass();\n            return pass(what);\n          }, proceed);\n        }\n\n        if (type == end || value == end) return cont();\n        return cont(expect(end));\n      }\n\n      return function (type, value) {\n        if (type == end || value == end) return cont();\n        return pass(what, proceed);\n      };\n    }\n\n    function contCommasep(what, end, info) {\n      for (var i = 3; i < arguments.length; i++) {\n        cx.cc.push(arguments[i]);\n      }\n\n      return cont(pushlex(end, info), commasep(what, end), poplex);\n    }\n\n    function block(type) {\n      if (type == \"}\") return cont();\n      return pass(statement, block);\n    }\n\n    function maybetype(type, value) {\n      if (isTS) {\n        if (type == \":\") return cont(typeexpr);\n        if (value == \"?\") return cont(maybetype);\n      }\n    }\n\n    function mayberettype(type) {\n      if (isTS && type == \":\") {\n        if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr);else return cont(typeexpr);\n      }\n    }\n\n    function isKW(_, value) {\n      if (value == \"is\") {\n        cx.marked = \"keyword\";\n        return cont();\n      }\n    }\n\n    function typeexpr(type, value) {\n      if (value == \"keyof\" || value == \"typeof\") {\n        cx.marked = \"keyword\";\n        return cont(value == \"keyof\" ? typeexpr : expressionNoComma);\n      }\n\n      if (type == \"variable\" || value == \"void\") {\n        cx.marked = \"type\";\n        return cont(afterType);\n      }\n\n      if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n      if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType);\n      if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType);\n      if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType);\n      if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr);\n    }\n\n    function maybeReturnType(type) {\n      if (type == \"=>\") return cont(typeexpr);\n    }\n\n    function typeprop(type, value) {\n      if (type == \"variable\" || cx.style == \"keyword\") {\n        cx.marked = \"property\";\n        return cont(typeprop);\n      } else if (value == \"?\") {\n        return cont(typeprop);\n      } else if (type == \":\") {\n        return cont(typeexpr);\n      } else if (type == \"[\") {\n        return cont(expression, maybetype, expect(\"]\"), typeprop);\n      }\n    }\n\n    function typearg(type, value) {\n      if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg);\n      if (type == \":\") return cont(typeexpr);\n      return pass(typeexpr);\n    }\n\n    function afterType(type, value) {\n      if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType);\n      if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr);\n      if (type == \"[\") return cont(expect(\"]\"), afterType);\n\n      if (value == \"extends\" || value == \"implements\") {\n        cx.marked = \"keyword\";\n        return cont(typeexpr);\n      }\n    }\n\n    function maybeTypeArgs(_, value) {\n      if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType);\n    }\n\n    function typeparam() {\n      return pass(typeexpr, maybeTypeDefault);\n    }\n\n    function maybeTypeDefault(_, value) {\n      if (value == \"=\") return cont(typeexpr);\n    }\n\n    function vardef(_, value) {\n      if (value == \"enum\") {\n        cx.marked = \"keyword\";\n        return cont(enumdef);\n      }\n\n      return pass(pattern, maybetype, maybeAssign, vardefCont);\n    }\n\n    function pattern(type, value) {\n      if (isTS && isModifier(value)) {\n        cx.marked = \"keyword\";\n        return cont(pattern);\n      }\n\n      if (type == \"variable\") {\n        register(value);\n        return cont();\n      }\n\n      if (type == \"spread\") return cont(pattern);\n      if (type == \"[\") return contCommasep(eltpattern, \"]\");\n      if (type == \"{\") return contCommasep(proppattern, \"}\");\n    }\n\n    function proppattern(type, value) {\n      if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n        register(value);\n        return cont(maybeAssign);\n      }\n\n      if (type == \"variable\") cx.marked = \"property\";\n      if (type == \"spread\") return cont(pattern);\n      if (type == \"}\") return pass();\n      return cont(expect(\":\"), pattern, maybeAssign);\n    }\n\n    function eltpattern() {\n      return pass(pattern, maybeAssign);\n    }\n\n    function maybeAssign(_type, value) {\n      if (value == \"=\") return cont(expressionNoComma);\n    }\n\n    function vardefCont(type) {\n      if (type == \",\") return cont(vardef);\n    }\n\n    function maybeelse(type, value) {\n      if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n    }\n\n    function forspec(type, value) {\n      if (value == \"await\") return cont(forspec);\n      if (type == \"(\") return cont(pushlex(\")\"), forspec1, expect(\")\"), poplex);\n    }\n\n    function forspec1(type) {\n      if (type == \"var\") return cont(vardef, expect(\";\"), forspec2);\n      if (type == \";\") return cont(forspec2);\n      if (type == \"variable\") return cont(formaybeinof);\n      return pass(expression, expect(\";\"), forspec2);\n    }\n\n    function formaybeinof(_type, value) {\n      if (value == \"in\" || value == \"of\") {\n        cx.marked = \"keyword\";\n        return cont(expression);\n      }\n\n      return cont(maybeoperatorComma, forspec2);\n    }\n\n    function forspec2(type, value) {\n      if (type == \";\") return cont(forspec3);\n\n      if (value == \"in\" || value == \"of\") {\n        cx.marked = \"keyword\";\n        return cont(expression);\n      }\n\n      return pass(expression, expect(\";\"), forspec3);\n    }\n\n    function forspec3(type) {\n      if (type != \")\") cont(expression);\n    }\n\n    function functiondef(type, value) {\n      if (value == \"*\") {\n        cx.marked = \"keyword\";\n        return cont(functiondef);\n      }\n\n      if (type == \"variable\") {\n        register(value);\n        return cont(functiondef);\n      }\n\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n      if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef);\n    }\n\n    function funarg(type, value) {\n      if (value == \"@\") cont(expression, funarg);\n      if (type == \"spread\") return cont(funarg);\n\n      if (isTS && isModifier(value)) {\n        cx.marked = \"keyword\";\n        return cont(funarg);\n      }\n\n      return pass(pattern, maybetype, maybeAssign);\n    }\n\n    function classExpression(type, value) {\n      // Class expressions may have an optional name.\n      if (type == \"variable\") return className(type, value);\n      return classNameAfter(type, value);\n    }\n\n    function className(type, value) {\n      if (type == \"variable\") {\n        register(value);\n        return cont(classNameAfter);\n      }\n    }\n\n    function classNameAfter(type, value) {\n      if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter);\n\n      if (value == \"extends\" || value == \"implements\" || isTS && type == \",\") {\n        if (value == \"implements\") cx.marked = \"keyword\";\n        return cont(isTS ? typeexpr : expression, classNameAfter);\n      }\n\n      if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n    }\n\n    function classBody(type, value) {\n      if (type == \"async\" || type == \"variable\" && (value == \"static\" || value == \"get\" || value == \"set\" || isTS && isModifier(value)) && cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false)) {\n        cx.marked = \"keyword\";\n        return cont(classBody);\n      }\n\n      if (type == \"variable\" || cx.style == \"keyword\") {\n        cx.marked = \"property\";\n        return cont(isTS ? classfield : functiondef, classBody);\n      }\n\n      if (type == \"[\") return cont(expression, maybetype, expect(\"]\"), isTS ? classfield : functiondef, classBody);\n\n      if (value == \"*\") {\n        cx.marked = \"keyword\";\n        return cont(classBody);\n      }\n\n      if (type == \";\") return cont(classBody);\n      if (type == \"}\") return cont();\n      if (value == \"@\") return cont(expression, classBody);\n    }\n\n    function classfield(type, value) {\n      if (value == \"?\") return cont(classfield);\n      if (type == \":\") return cont(typeexpr, maybeAssign);\n      if (value == \"=\") return cont(expressionNoComma);\n      return pass(functiondef);\n    }\n\n    function afterExport(type, value) {\n      if (value == \"*\") {\n        cx.marked = \"keyword\";\n        return cont(maybeFrom, expect(\";\"));\n      }\n\n      if (value == \"default\") {\n        cx.marked = \"keyword\";\n        return cont(expression, expect(\";\"));\n      }\n\n      if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n      return pass(statement);\n    }\n\n    function exportField(type, value) {\n      if (value == \"as\") {\n        cx.marked = \"keyword\";\n        return cont(expect(\"variable\"));\n      }\n\n      if (type == \"variable\") return pass(expressionNoComma, exportField);\n    }\n\n    function afterImport(type) {\n      if (type == \"string\") return cont();\n      if (type == \"(\") return pass(expression);\n      return pass(importSpec, maybeMoreImports, maybeFrom);\n    }\n\n    function importSpec(type, value) {\n      if (type == \"{\") return contCommasep(importSpec, \"}\");\n      if (type == \"variable\") register(value);\n      if (value == \"*\") cx.marked = \"keyword\";\n      return cont(maybeAs);\n    }\n\n    function maybeMoreImports(type) {\n      if (type == \",\") return cont(importSpec, maybeMoreImports);\n    }\n\n    function maybeAs(_type, value) {\n      if (value == \"as\") {\n        cx.marked = \"keyword\";\n        return cont(importSpec);\n      }\n    }\n\n    function maybeFrom(_type, value) {\n      if (value == \"from\") {\n        cx.marked = \"keyword\";\n        return cont(expression);\n      }\n    }\n\n    function arrayLiteral(type) {\n      if (type == \"]\") return cont();\n      return pass(commasep(expressionNoComma, \"]\"));\n    }\n\n    function enumdef() {\n      return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex);\n    }\n\n    function enummember() {\n      return pass(pattern, maybeAssign);\n    }\n\n    function isContinuedStatement(state, textAfter) {\n      return state.lastType == \"operator\" || state.lastType == \",\" || isOperatorChar.test(textAfter.charAt(0)) || /[,.]/.test(textAfter.charAt(0));\n    }\n\n    function expressionAllowed(stream, state, backUp) {\n      return state.tokenize == tokenBase && /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) || state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0)));\n    } // Interface\n\n\n    return {\n      startState: function startState(basecolumn) {\n        var state = {\n          tokenize: tokenBase,\n          lastType: \"sof\",\n          cc: [],\n          lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n          localVars: parserConfig.localVars,\n          context: parserConfig.localVars && new Context(null, null, false),\n          indented: basecolumn || 0\n        };\n        if (parserConfig.globalVars && _typeof(parserConfig.globalVars) == \"object\") state.globalVars = parserConfig.globalVars;\n        return state;\n      },\n      token: function token(stream, state) {\n        if (stream.sol()) {\n          if (!state.lexical.hasOwnProperty(\"align\")) state.lexical.align = false;\n          state.indented = stream.indentation();\n          findFatArrow(stream, state);\n        }\n\n        if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n        var style = state.tokenize(stream, state);\n        if (type == \"comment\") return style;\n        state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n        return parseJS(state, style, type, content, stream);\n      },\n      indent: function indent(state, textAfter) {\n        if (state.tokenize == tokenComment) return CodeMirror.Pass;\n        if (state.tokenize != tokenBase) return 0;\n        var firstChar = textAfter && textAfter.charAt(0),\n            lexical = state.lexical,\n            top; // Kludge to prevent 'maybelse' from blocking lexical scope pops\n\n        if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n          var c = state.cc[i];\n          if (c == poplex) lexical = lexical.prev;else if (c != maybeelse) break;\n        }\n\n        while ((lexical.type == \"stat\" || lexical.type == \"form\") && (firstChar == \"}\" || (top = state.cc[state.cc.length - 1]) && (top == maybeoperatorComma || top == maybeoperatorNoComma) && !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))) {\n          lexical = lexical.prev;\n        }\n\n        if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\") lexical = lexical.prev;\n        var type = lexical.type,\n            closing = firstChar == type;\n        if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);else if (type == \"form\" && firstChar == \"{\") return lexical.indented;else if (type == \"form\") return lexical.indented + indentUnit;else if (type == \"stat\") return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false) return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);else if (lexical.align) return lexical.column + (closing ? 0 : 1);else return lexical.indented + (closing ? 0 : indentUnit);\n      },\n      electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n      blockCommentStart: jsonMode ? null : \"/*\",\n      blockCommentEnd: jsonMode ? null : \"*/\",\n      blockCommentContinue: jsonMode ? null : \" * \",\n      lineComment: jsonMode ? null : \"//\",\n      fold: \"brace\",\n      closeBrackets: \"()[]{}''\\\"\\\"``\",\n      helperType: jsonMode ? \"json\" : \"javascript\",\n      jsonldMode: jsonldMode,\n      jsonMode: jsonMode,\n      expressionAllowed: expressionAllowed,\n      skipExpression: function skipExpression(state) {\n        var top = state.cc[state.cc.length - 1];\n        if (top == expression || top == expressionNoComma) state.cc.pop();\n      }\n    };\n  });\n  CodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n  CodeMirror.defineMIME(\"text/javascript\", \"javascript\");\n  CodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\n  CodeMirror.defineMIME(\"application/javascript\", \"javascript\");\n  CodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\n  CodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\n  CodeMirror.defineMIME(\"application/json\", {\n    name: \"javascript\",\n    json: true\n  });\n  CodeMirror.defineMIME(\"application/x-json\", {\n    name: \"javascript\",\n    json: true\n  });\n  CodeMirror.defineMIME(\"application/ld+json\", {\n    name: \"javascript\",\n    jsonld: true\n  });\n  CodeMirror.defineMIME(\"text/typescript\", {\n    name: \"javascript\",\n    typescript: true\n  });\n  CodeMirror.defineMIME(\"application/typescript\", {\n    name: \"javascript\",\n    typescript: true\n  });\n});\n\n},{\"../../lib/codemirror\":11}],15:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) == \"object\" && (typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  \"use strict\";\n\n  var htmlConfig = {\n    autoSelfClosers: {\n      'area': true,\n      'base': true,\n      'br': true,\n      'col': true,\n      'command': true,\n      'embed': true,\n      'frame': true,\n      'hr': true,\n      'img': true,\n      'input': true,\n      'keygen': true,\n      'link': true,\n      'meta': true,\n      'param': true,\n      'source': true,\n      'track': true,\n      'wbr': true,\n      'menuitem': true\n    },\n    implicitlyClosed: {\n      'dd': true,\n      'li': true,\n      'optgroup': true,\n      'option': true,\n      'p': true,\n      'rp': true,\n      'rt': true,\n      'tbody': true,\n      'td': true,\n      'tfoot': true,\n      'th': true,\n      'tr': true\n    },\n    contextGrabbers: {\n      'dd': {\n        'dd': true,\n        'dt': true\n      },\n      'dt': {\n        'dd': true,\n        'dt': true\n      },\n      'li': {\n        'li': true\n      },\n      'option': {\n        'option': true,\n        'optgroup': true\n      },\n      'optgroup': {\n        'optgroup': true\n      },\n      'p': {\n        'address': true,\n        'article': true,\n        'aside': true,\n        'blockquote': true,\n        'dir': true,\n        'div': true,\n        'dl': true,\n        'fieldset': true,\n        'footer': true,\n        'form': true,\n        'h1': true,\n        'h2': true,\n        'h3': true,\n        'h4': true,\n        'h5': true,\n        'h6': true,\n        'header': true,\n        'hgroup': true,\n        'hr': true,\n        'menu': true,\n        'nav': true,\n        'ol': true,\n        'p': true,\n        'pre': true,\n        'section': true,\n        'table': true,\n        'ul': true\n      },\n      'rp': {\n        'rp': true,\n        'rt': true\n      },\n      'rt': {\n        'rp': true,\n        'rt': true\n      },\n      'tbody': {\n        'tbody': true,\n        'tfoot': true\n      },\n      'td': {\n        'td': true,\n        'th': true\n      },\n      'tfoot': {\n        'tbody': true\n      },\n      'th': {\n        'td': true,\n        'th': true\n      },\n      'thead': {\n        'tbody': true,\n        'tfoot': true\n      },\n      'tr': {\n        'tr': true\n      }\n    },\n    doNotIndent: {\n      \"pre\": true\n    },\n    allowUnquoted: true,\n    allowMissing: true,\n    caseFold: true\n  };\n  var xmlConfig = {\n    autoSelfClosers: {},\n    implicitlyClosed: {},\n    contextGrabbers: {},\n    doNotIndent: {},\n    allowUnquoted: false,\n    allowMissing: false,\n    allowMissingTagName: false,\n    caseFold: false\n  };\n  CodeMirror.defineMode(\"xml\", function (editorConf, config_) {\n    var indentUnit = editorConf.indentUnit;\n    var config = {};\n    var defaults = config_.htmlMode ? htmlConfig : xmlConfig;\n\n    for (var prop in defaults) {\n      config[prop] = defaults[prop];\n    }\n\n    for (var prop in config_) {\n      config[prop] = config_[prop];\n    } // Return variables for tokenizers\n\n\n    var type, setStyle;\n\n    function inText(stream, state) {\n      function chain(parser) {\n        state.tokenize = parser;\n        return parser(stream, state);\n      }\n\n      var ch = stream.next();\n\n      if (ch == \"<\") {\n        if (stream.eat(\"!\")) {\n          if (stream.eat(\"[\")) {\n            if (stream.match(\"CDATA[\")) return chain(inBlock(\"atom\", \"]]>\"));else return null;\n          } else if (stream.match(\"--\")) {\n            return chain(inBlock(\"comment\", \"-->\"));\n          } else if (stream.match(\"DOCTYPE\", true, true)) {\n            stream.eatWhile(/[\\w\\._\\-]/);\n            return chain(doctype(1));\n          } else {\n            return null;\n          }\n        } else if (stream.eat(\"?\")) {\n          stream.eatWhile(/[\\w\\._\\-]/);\n          state.tokenize = inBlock(\"meta\", \"?>\");\n          return \"meta\";\n        } else {\n          type = stream.eat(\"/\") ? \"closeTag\" : \"openTag\";\n          state.tokenize = inTag;\n          return \"tag bracket\";\n        }\n      } else if (ch == \"&\") {\n        var ok;\n\n        if (stream.eat(\"#\")) {\n          if (stream.eat(\"x\")) {\n            ok = stream.eatWhile(/[a-fA-F\\d]/) && stream.eat(\";\");\n          } else {\n            ok = stream.eatWhile(/[\\d]/) && stream.eat(\";\");\n          }\n        } else {\n          ok = stream.eatWhile(/[\\w\\.\\-:]/) && stream.eat(\";\");\n        }\n\n        return ok ? \"atom\" : \"error\";\n      } else {\n        stream.eatWhile(/[^&<]/);\n        return null;\n      }\n    }\n\n    inText.isInText = true;\n\n    function inTag(stream, state) {\n      var ch = stream.next();\n\n      if (ch == \">\" || ch == \"/\" && stream.eat(\">\")) {\n        state.tokenize = inText;\n        type = ch == \">\" ? \"endTag\" : \"selfcloseTag\";\n        return \"tag bracket\";\n      } else if (ch == \"=\") {\n        type = \"equals\";\n        return null;\n      } else if (ch == \"<\") {\n        state.tokenize = inText;\n        state.state = baseState;\n        state.tagName = state.tagStart = null;\n        var next = state.tokenize(stream, state);\n        return next ? next + \" tag error\" : \"tag error\";\n      } else if (/[\\'\\\"]/.test(ch)) {\n        state.tokenize = inAttribute(ch);\n        state.stringStartCol = stream.column();\n        return state.tokenize(stream, state);\n      } else {\n        stream.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/);\n        return \"word\";\n      }\n    }\n\n    function inAttribute(quote) {\n      var closure = function closure(stream, state) {\n        while (!stream.eol()) {\n          if (stream.next() == quote) {\n            state.tokenize = inTag;\n            break;\n          }\n        }\n\n        return \"string\";\n      };\n\n      closure.isInAttribute = true;\n      return closure;\n    }\n\n    function inBlock(style, terminator) {\n      return function (stream, state) {\n        while (!stream.eol()) {\n          if (stream.match(terminator)) {\n            state.tokenize = inText;\n            break;\n          }\n\n          stream.next();\n        }\n\n        return style;\n      };\n    }\n\n    function doctype(depth) {\n      return function (stream, state) {\n        var ch;\n\n        while ((ch = stream.next()) != null) {\n          if (ch == \"<\") {\n            state.tokenize = doctype(depth + 1);\n            return state.tokenize(stream, state);\n          } else if (ch == \">\") {\n            if (depth == 1) {\n              state.tokenize = inText;\n              break;\n            } else {\n              state.tokenize = doctype(depth - 1);\n              return state.tokenize(stream, state);\n            }\n          }\n        }\n\n        return \"meta\";\n      };\n    }\n\n    function Context(state, tagName, startOfLine) {\n      this.prev = state.context;\n      this.tagName = tagName;\n      this.indent = state.indented;\n      this.startOfLine = startOfLine;\n      if (config.doNotIndent.hasOwnProperty(tagName) || state.context && state.context.noIndent) this.noIndent = true;\n    }\n\n    function popContext(state) {\n      if (state.context) state.context = state.context.prev;\n    }\n\n    function maybePopContext(state, nextTagName) {\n      var parentTagName;\n\n      while (true) {\n        if (!state.context) {\n          return;\n        }\n\n        parentTagName = state.context.tagName;\n\n        if (!config.contextGrabbers.hasOwnProperty(parentTagName) || !config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)) {\n          return;\n        }\n\n        popContext(state);\n      }\n    }\n\n    function baseState(type, stream, state) {\n      if (type == \"openTag\") {\n        state.tagStart = stream.column();\n        return tagNameState;\n      } else if (type == \"closeTag\") {\n        return closeTagNameState;\n      } else {\n        return baseState;\n      }\n    }\n\n    function tagNameState(type, stream, state) {\n      if (type == \"word\") {\n        state.tagName = stream.current();\n        setStyle = \"tag\";\n        return attrState;\n      } else if (config.allowMissingTagName && type == \"endTag\") {\n        setStyle = \"tag bracket\";\n        return attrState(type, stream, state);\n      } else {\n        setStyle = \"error\";\n        return tagNameState;\n      }\n    }\n\n    function closeTagNameState(type, stream, state) {\n      if (type == \"word\") {\n        var tagName = stream.current();\n        if (state.context && state.context.tagName != tagName && config.implicitlyClosed.hasOwnProperty(state.context.tagName)) popContext(state);\n\n        if (state.context && state.context.tagName == tagName || config.matchClosing === false) {\n          setStyle = \"tag\";\n          return closeState;\n        } else {\n          setStyle = \"tag error\";\n          return closeStateErr;\n        }\n      } else if (config.allowMissingTagName && type == \"endTag\") {\n        setStyle = \"tag bracket\";\n        return closeState(type, stream, state);\n      } else {\n        setStyle = \"error\";\n        return closeStateErr;\n      }\n    }\n\n    function closeState(type, _stream, state) {\n      if (type != \"endTag\") {\n        setStyle = \"error\";\n        return closeState;\n      }\n\n      popContext(state);\n      return baseState;\n    }\n\n    function closeStateErr(type, stream, state) {\n      setStyle = \"error\";\n      return closeState(type, stream, state);\n    }\n\n    function attrState(type, _stream, state) {\n      if (type == \"word\") {\n        setStyle = \"attribute\";\n        return attrEqState;\n      } else if (type == \"endTag\" || type == \"selfcloseTag\") {\n        var tagName = state.tagName,\n            tagStart = state.tagStart;\n        state.tagName = state.tagStart = null;\n\n        if (type == \"selfcloseTag\" || config.autoSelfClosers.hasOwnProperty(tagName)) {\n          maybePopContext(state, tagName);\n        } else {\n          maybePopContext(state, tagName);\n          state.context = new Context(state, tagName, tagStart == state.indented);\n        }\n\n        return baseState;\n      }\n\n      setStyle = \"error\";\n      return attrState;\n    }\n\n    function attrEqState(type, stream, state) {\n      if (type == \"equals\") return attrValueState;\n      if (!config.allowMissing) setStyle = \"error\";\n      return attrState(type, stream, state);\n    }\n\n    function attrValueState(type, stream, state) {\n      if (type == \"string\") return attrContinuedState;\n\n      if (type == \"word\" && config.allowUnquoted) {\n        setStyle = \"string\";\n        return attrState;\n      }\n\n      setStyle = \"error\";\n      return attrState(type, stream, state);\n    }\n\n    function attrContinuedState(type, stream, state) {\n      if (type == \"string\") return attrContinuedState;\n      return attrState(type, stream, state);\n    }\n\n    return {\n      startState: function startState(baseIndent) {\n        var state = {\n          tokenize: inText,\n          state: baseState,\n          indented: baseIndent || 0,\n          tagName: null,\n          tagStart: null,\n          context: null\n        };\n        if (baseIndent != null) state.baseIndent = baseIndent;\n        return state;\n      },\n      token: function token(stream, state) {\n        if (!state.tagName && stream.sol()) state.indented = stream.indentation();\n        if (stream.eatSpace()) return null;\n        type = null;\n        var style = state.tokenize(stream, state);\n\n        if ((style || type) && style != \"comment\") {\n          setStyle = null;\n          state.state = state.state(type || style, stream, state);\n          if (setStyle) style = setStyle == \"error\" ? style + \" error\" : setStyle;\n        }\n\n        return style;\n      },\n      indent: function indent(state, textAfter, fullLine) {\n        var context = state.context; // Indent multi-line strings (e.g. css).\n\n        if (state.tokenize.isInAttribute) {\n          if (state.tagStart == state.indented) return state.stringStartCol + 1;else return state.indented + indentUnit;\n        }\n\n        if (context && context.noIndent) return CodeMirror.Pass;\n        if (state.tokenize != inTag && state.tokenize != inText) return fullLine ? fullLine.match(/^(\\s*)/)[0].length : 0; // Indent the starts of attribute names.\n\n        if (state.tagName) {\n          if (config.multilineTagIndentPastTag !== false) return state.tagStart + state.tagName.length + 2;else return state.tagStart + indentUnit * (config.multilineTagIndentFactor || 1);\n        }\n\n        if (config.alignCDATA && /<!\\[CDATA\\[/.test(textAfter)) return 0;\n        var tagAfter = textAfter && /^<(\\/)?([\\w_:\\.-]*)/.exec(textAfter);\n\n        if (tagAfter && tagAfter[1]) {\n          // Closing tag spotted\n          while (context) {\n            if (context.tagName == tagAfter[2]) {\n              context = context.prev;\n              break;\n            } else if (config.implicitlyClosed.hasOwnProperty(context.tagName)) {\n              context = context.prev;\n            } else {\n              break;\n            }\n          }\n        } else if (tagAfter) {\n          // Opening tag spotted\n          while (context) {\n            var grabbers = config.contextGrabbers[context.tagName];\n            if (grabbers && grabbers.hasOwnProperty(tagAfter[2])) context = context.prev;else break;\n          }\n        }\n\n        while (context && context.prev && !context.startOfLine) {\n          context = context.prev;\n        }\n\n        if (context) return context.indent + indentUnit;else return state.baseIndent || 0;\n      },\n      electricInput: /<\\/[\\s\\w:]+>$/,\n      blockCommentStart: \"<!--\",\n      blockCommentEnd: \"-->\",\n      configuration: config.htmlMode ? \"html\" : \"xml\",\n      helperType: config.htmlMode ? \"html\" : \"xml\",\n      skipAttribute: function skipAttribute(state) {\n        if (state.state == attrValueState) state.state = attrState;\n      }\n    };\n  });\n  CodeMirror.defineMIME(\"text/xml\", \"xml\");\n  CodeMirror.defineMIME(\"application/xml\", \"xml\");\n  if (!CodeMirror.mimeModes.hasOwnProperty(\"text/html\")) CodeMirror.defineMIME(\"text/html\", {\n    name: \"xml\",\n    htmlMode: true\n  });\n});\n\n},{\"../../lib/codemirror\":11}]},{},[3]);\n"]}