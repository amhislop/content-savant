!function a(o,u,c){function l(e,t){if(!u[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(s)return s(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var i=u[e]={exports:{}};o[e][0].call(i.exports,function(t){return l(o[e][1][t]||t)},i,i.exports,a,o,u,c)}return u[e].exports}for(var s="function"==typeof require&&require,t=0;t<c.length;t++)l(c[t]);return l}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.update_script=n.add_script=n.delete_script=void 0;var o=t("./types"),u=r(t("../reducers/output")),c=r(t("../reducers/menu")),l=r(t("../reducers/data"));function r(t){return t&&t.__esModule?t:{default:t}}n.delete_script=function(t,e){var n=o.DELETE_SCRIPT,r=e.id,i=e.inputs,a=e.menuItem;(0,l.default)({type:n,scripts:t,id:r}),(0,u.default)({type:n,inputs:i}),(0,c.default)({type:n,menuItem:a})};n.add_script=function(t,e,n){var r=o.ADD_SCRIPT,i=(0,l.default)({type:r,scripts:t,data:e});(0,c.default)({type:r,data:i,dest:n.menu}),(0,u.default)({type:r,data:i,dest:n.output})};n.update_script=function(t,e,n){var r=o.UPDATE_SCRIPT,i=(0,l.default)({type:r,script:t,data:e});(0,u.default)({type:r,value:i,dest:n.input}),n.menuItem&&(0,c.default)({type:r,attr:e.attr,value:i,dest:n.menuItem})}},{"../reducers/data":8,"../reducers/menu":9,"../reducers/output":10,"./types":2}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.UPDATE_SCRIPT=n.ADD_SCRIPT=n.DELETE_SCRIPT=void 0;n.DELETE_SCRIPT="DELETE_SCRIPT";n.ADD_SCRIPT="ADD_SCRIPT";n.UPDATE_SCRIPT="UPDATE_SCRIPT"},{}],3:[function(t,e,n){"use strict";var r=o(t("./modules/dataset")),g=t("./modules/utilities"),s=t("./actions/scriptActions"),u=t("./modules/transform"),i=t("./modules/editor"),a=o(t("./settings/SavantSettings"));function o(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}if(document.getElementById("savantEditor")){console.log("running");var c=new r.default,S=c.scripts,b=c.options;console.log(b);var l=(0,i.getEditorSettings)(b),_=wp.codeEditor.initialize(document.getElementById("savantEditor"),l);({elements:{_svt:document.getElementById("savant_meta"),menu:document.querySelector(".savant-tab ul"),output:document.querySelector(".savant-data"),settings:document.querySelectorAll(".savant-settings .settings-field"),icons:document.querySelectorAll(".controls i.icon")},init:function(){(0,g.isEmpty)(S)?this.newSession(!0):this.setActiveScript((0,g.getFirstScript)(S)),this.events()},events:function(){var e=this,t=this.elements,n=t._svt,r=t.menu,i=t.settings,a=t.icons;r.addEventListener("click",this.selectScript.bind(this)),_.codemirror.on("change",this.codeUpdate.bind(this)),i.forEach(function(t){return t.addEventListener("input",e.attrUpdate.bind(e))}),n.querySelector("i.trash").addEventListener("click",this.deleteScript.bind(this)),n.querySelector('button.btn[type="submit"]').addEventListener("click",this.newScript.bind(this)),a.forEach(function(t){return t.addEventListener("click",e.toggleMenu.bind(e))}),n.querySelectorAll(".btn.radio").forEach(function(t){return t.addEventListener("click",e.toggleButtons)}),n.querySelector(".file .upload").addEventListener("click",this.uploadFile.bind(this))},selectScript:function(t){if(t.target.classList.contains("button-language")){var e=t.target.getAttribute("data-id");(0,g.uniqueID)(S);this.setActiveScript(e)}},setActiveScript:function(t){this.activeScript={id:t,codeOutput:this.elements.output.querySelector('input[data-id="'.concat(t,'"][data-attribute="code"]'))},_.codemirror.setValue(S[t].code),_.codemirror.setOption("mode",b.mode[S[t].language]),document.querySelector(".savant-window").dataset.type=S[t].type;var e=!0,n=!1,r=void 0;try{for(var i,a=this.elements.menu.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.classList[o.dataset.id==t?"add":"remove"]("active")}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}for(var u=S[t],c=u.label,l=u.type,s=u.language,d=u.file,p=Object.entries({label:c,type:l,language:s}),f=0;f<p.length;f++){var v=h(p[f],2),y=v[0],m=v[1];document.querySelector('.settings-field[data-attribute="'.concat(y,'"]')).value=m}document.querySelector(".savant-window").dataset.type=l,document.querySelector(".file div span").textContent=(0,g.getFileName)(d)},newSession:function(t){document.querySelector(".savant-config").classList[t?"add":"remove"]("new","expand"),document.querySelector(".savant.side-bar").classList[t?"add":"remove"]("new","expand")},deleteScript:function(){var t=this.activeScript.id,e=document.querySelector('.savant-tab [data-id="'.concat(t,'"]'));(0,s.delete_script)(S,{id:t,inputs:document.querySelectorAll('.savant-data input[data-id="'.concat(t,'"]')),menuItem:e}),(0,g.isEmpty)(S)?(this.newSession(!0),_.codemirror.setValue("")):this.setActiveScript((0,g.getFirstScript)(S))},attrUpdate:function(t){var e=t.target,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.activeScript.id,i=this.elements,a=i.output,o=i.menu,u=n.attr||e.dataset.attribute,c=n.value||e.value,l={input:a.querySelector('[data-id="'.concat(r,'"][data-attribute="').concat(u,'"]')),menuItem:o.querySelector('[data-id="'.concat(r,'"]'))};(0,s.update_script)(S[r],{attr:u,value:c},l),"language"===u&&_.setOption("mode",b.mode[S[r].language]),"type"===u&&(document.querySelector(".savant-window").dataset.type=c),"file"===u&&(document.querySelector(".file div span").textContent=(0,g.getFileName)(c))},codeUpdate:function(){if(!(0,g.isEmpty)(S)){var t=this.activeScript,e=t.id,n=t.codeOutput,r=_.codemirror.getValue();if((0,s.update_script)(S[e],{attr:"code",value:r},{input:n}),"javascript"===S[e].language&&b.compiler){var i=this.elements.output,a=(0,u.compileCode)(r,["es2015","stage-0"]),o=i.querySelector('input[name="savant_field['.concat(e,'][compiled]"]'));(0,u.updateCompiledCode)(S[e],a,o)}}},newScript:function(t){t.preventDefault();var e=document.querySelector("div.savant-config"),n=e.querySelector(".language input:checked").value,r=e.querySelector(".label input").value||n.toUpperCase(),i=e.querySelector(".type input:checked").value,a=(0,g.uniqueID)(S),o={id:a,language:n,type:i,label:r,code:b.boilerplate[n],file:""};(0,s.add_script)(S,o,this.elements),this.toggleMenu(this.elements._svt.querySelector("i.icon.add-new")),this.newSession(!1),this.setActiveScript(S[a].id)},toggleMenu:function(t){var e=t.target||t,n=e.getAttribute("menu-target");this.elements._svt.querySelector(".".concat(n)).classList.toggle("expand"),e.classList.toggle("open")},toggleButtons:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.parentNode.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var a=r.value;a.classList[this==a?"add":"remove"]("active"),a.children[0].checked=this==a}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}},uploadFile:function(t){var e=this;t.preventDefault();var n,r=(0,g.uploader)();r.on("select",function(){n=r.state().get("selection").first().toJSON(),e.attrUpdate(t,{attr:"file",value:n.url})}),r.open()}}).init()}document.querySelector("#savantSettings")&&wp.element.render(React.createElement(a.default,null),document.getElementById("savantSettings"))},{"./actions/scriptActions":1,"./modules/dataset":4,"./modules/editor":5,"./modules/transform":6,"./modules/utilities":7,"./settings/SavantSettings":11}],4:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scripts=this.getInitialScripts(),this.options=this.getOptions()}var e,n,r;return e=t,(n=[{key:"getInitialScripts",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,a=document.querySelectorAll(".savant-data input")[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=o.getAttribute("data-id"),c=o.getAttribute("data-attribute");t[u]||(t[u]={}),t[u][c]=o.value}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"getOptions",value:function(){return Array.from(document.querySelectorAll(".savant-options input")).reduce(function(t,e){var n=e.dataset.attribute,r=e.dataset.language||!1;return t[n]||(t[n]={}),r?t[n][r]=e.value:t[n]=e.value,t},{})}}])&&i(e.prototype,n),r&&i(e,r),t}();n.default=r},{}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getEditorSettings=void 0;n.getEditorSettings=function(t){var e=t.theme,n=t.mode.javascript;console.log(wp.codeEditor);var r=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};return console.log("initialise"),r.codemirror=_.extend({},r.codemirror,{indentUnit:2,tabSize:2,theme:e,mode:n}),r}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.updateCompiledCode=n.compileCode=void 0;var r=t("../actions/scriptActions");n.compileCode=function(t,e){return Babel?Babel.transform(t,{presets:e}).code:null};n.updateCompiledCode=function(t,e,n){return(0,r.update_script)(t,{attr:"compiled",value:e},{input:n})}},{"../actions/scriptActions":1}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uploader=n.getFileName=n.getFirstScript=n.uniqueID=n.isEmpty=void 0;n.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};n.uniqueID=function t(e){for(var n=Math.floor(9999999*Math.random()+1),r=!0,i=Object.keys(e),a=0;a<i.length;a++)n==i[a]&&(r=!1);if(r)return n;t(e)};n.getFirstScript=function(t){return Object.keys(t)[0]};n.getFileName=function(t){return t.replace(/(.*)wp-content/g,"....")};n.uploader=function(){return wp.media.frames.file_frame=wp.media({title:"Choose a File",button:{text:"Choose File"},multiple:!1})}},{}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"ADD_SCRIPT":var e=t.data,n=t.scripts;return n[e.id]=e,n[e.id];case"UPDATE_SCRIPT":var r=t.script,i=t.data,a=i.attr,o=i.value;return r[a]=o,r[a];case"DELETE_SCRIPT":var u=t.id;delete t.scripts[u];break;default:return}}},{}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"ADD_SCRIPT":var e=t.data,n=e.id,r=e.language,i=e.label,a=document.createElement("li");a.dataset.attribute=r,a.dataset.id=n,a.classList.add("button-language"),a.textContent=i,t.dest.appendChild(a);break;case"UPDATE_SCRIPT":var o=t.attr,u=t.value,c=t.dest;"label"===o?c.textContent=u:"language"===o&&(c.dataset.attribute=u);break;case"DELETE_SCRIPT":t.menuItem.remove();break;default:return}}},{}],10:[function(t,e,n){"use strict";function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"DELETE_SCRIPT":var e=!0,n=!1,r=void 0;try{for(var i,a=t.inputs[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.remove()}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}break;case"ADD_SCRIPT":for(var o=t.data.id,u=Object.entries(t.data),c=0;c<u.length;c++){var l=y(u[c],2),s=l[0],d=l[1],p=document.createElement("input");p.dataset.attribute=s,p.dataset.id=o,p.name="savant_field[".concat(o,"][").concat(s,"]"),p.type="hidden",p.value=d,t.dest.appendChild(p)}break;case"UPDATE_SCRIPT":var f=t.dest,v=t.value;f.value=v;break;default:return}}},{}],11:[function(t,e,n){"use strict";function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){function s(){var t,e,n,r,i,a,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var u=arguments.length,c=new Array(u),l=0;l<u;l++)c[l]=arguments[l];return n=this,e=!(r=(t=p(s)).call.apply(t,[this].concat(c)))||"object"!==d(r)&&"function"!=typeof r?f(n):r,i=f(e),o={name:"Aidan"},(a="state")in i?Object.defineProperty(i,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[a]=o,e}var e,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(s,wp.element.Component),e=s,(n=[{key:"render",value:function(){return React.createElement("div",null,"Hello ",this.state.name)}}])&&i(e.prototype,n),r&&i(e,r),s}();n.default=r},{}]},{},[3]);
//# sourceMappingURL=bundle.js.map
