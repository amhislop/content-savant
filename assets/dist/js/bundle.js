!function a(u,o,c){function s(e,t){if(!o[e]){if(!u[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var i=o[e]={exports:{}};u[e][0].call(i.exports,function(t){return s(u[e][1][t]||t)},i,i.exports,a,u,o,c)}return o[e].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)s(c[t]);return s}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.update_script=n.add_script=n.delete_script=void 0;var u=t("./types"),o=r(t("../reducers/output")),c=r(t("../reducers/menu")),s=r(t("../reducers/data"));function r(t){return t&&t.__esModule?t:{default:t}}n.delete_script=function(t,e){var n=u.DELETE_SCRIPT,r=e.id,i=e.inputs,a=e.menuItem;(0,s.default)({type:n,scripts:t,id:r}),(0,o.default)({type:n,inputs:i}),(0,c.default)({type:n,menuItem:a})};n.add_script=function(t,e,n){var r=u.ADD_SCRIPT,i=(0,s.default)({type:r,scripts:t,data:e});(0,c.default)({type:r,data:i,dest:n.menu}),(0,o.default)({type:r,data:i,dest:n.output})};n.update_script=function(t,e,n){var r=u.UPDATE_SCRIPT,i=(0,s.default)({type:r,script:t,data:e});(0,o.default)({type:r,value:i,dest:n.input}),n.menuItem&&(0,c.default)({type:r,attr:e.attr,value:i,dest:n.menuItem})}},{"../reducers/data":8,"../reducers/menu":9,"../reducers/output":10,"./types":2}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.UPDATE_SCRIPT=n.ADD_SCRIPT=n.DELETE_SCRIPT=void 0;n.DELETE_SCRIPT="DELETE_SCRIPT";n.ADD_SCRIPT="ADD_SCRIPT";n.UPDATE_SCRIPT="UPDATE_SCRIPT"},{}],3:[function(t,e,n){"use strict";var r=u(t("./modules/dataset")),g=t("./modules/utilities"),l=t("./actions/scriptActions"),o=t("./modules/transform"),i=t("./modules/editor"),a=u(t("./settings/SavantSettings"));function u(t){return t&&t.__esModule?t:{default:t}}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var u,o=t[Symbol.iterator]();!(r=(u=o.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}if(document.getElementById("savantEditor")){console.log("running");var c=new r.default,h=c.scripts,b=c.options;console.log(b);var s=(0,i.getEditorSettings)(b),_=wp.codeEditor.initialize(document.getElementById("savantEditor"),s);({elements:{_svt:document.getElementById("savant_meta"),menu:document.querySelector(".savant-tab ul"),output:document.querySelector(".savant-data"),settings:document.querySelectorAll(".savant-settings .settings-field"),icons:document.querySelectorAll(".controls i.icon")},init:function(){(0,g.isEmpty)(h)?this.newSession(!0):this.setActiveScript((0,g.getFirstScript)(h)),this.events()},events:function(){var e=this,t=this.elements,n=t._svt,r=t.menu,i=t.settings,a=t.icons;r.addEventListener("click",this.selectScript.bind(this)),_.codemirror.on("change",this.codeUpdate.bind(this)),i.forEach(function(t){return t.addEventListener("input",e.attrUpdate.bind(e))}),n.querySelector("i.trash").addEventListener("click",this.deleteScript.bind(this)),n.querySelector('button.btn[type="submit"]').addEventListener("click",this.newScript.bind(this)),a.forEach(function(t){return t.addEventListener("click",e.toggleMenu.bind(e))}),n.querySelectorAll(".btn.radio").forEach(function(t){return t.addEventListener("click",e.toggleButtons)}),n.querySelector(".file .upload").addEventListener("click",this.uploadFile.bind(this))},selectScript:function(t){if(t.target.classList.contains("button-language")){var e=t.target.getAttribute("data-id");(0,g.uniqueID)(h);this.setActiveScript(e)}},setActiveScript:function(t){this.activeScript={id:t,codeOutput:this.elements.output.querySelector('input[data-id="'.concat(t,'"][data-attribute="code"]'))},_.codemirror.setValue(h[t].code),_.codemirror.setOption("mode",b.mode[h[t].language]),document.querySelector(".savant-window").dataset.type=h[t].type;var e=!0,n=!1,r=void 0;try{for(var i,a=this.elements.menu.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;u.classList[u.dataset.id==t?"add":"remove"]("active")}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}for(var o=h[t],c=o.label,s=o.type,l=o.language,d=o.file,p=Object.entries({label:c,type:s,language:l}),f=0;f<p.length;f++){var v=S(p[f],2),m=v[0],y=v[1];document.querySelector('.settings-field[data-attribute="'.concat(m,'"]')).value=y}document.querySelector(".savant-window").dataset.type=s,document.querySelector(".file div span").textContent=(0,g.getFileName)(d)},newSession:function(t){document.querySelector(".savant-config").classList[t?"add":"remove"]("new","expand"),document.querySelector(".savant.side-bar").classList[t?"add":"remove"]("new","expand")},deleteScript:function(){var t=this.activeScript.id,e=document.querySelector('.savant-tab [data-id="'.concat(t,'"]'));(0,l.delete_script)(h,{id:t,inputs:document.querySelectorAll('.savant-data input[data-id="'.concat(t,'"]')),menuItem:e}),(0,g.isEmpty)(h)?(this.newSession(!0),_.codemirror.setValue("")):this.setActiveScript((0,g.getFirstScript)(h))},attrUpdate:function(t){var e=t.target,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.activeScript.id,i=this.elements,a=i.output,u=i.menu,o=n.attr||e.dataset.attribute,c=n.value||e.value,s={input:a.querySelector('[data-id="'.concat(r,'"][data-attribute="').concat(o,'"]')),menuItem:u.querySelector('[data-id="'.concat(r,'"]'))};(0,l.update_script)(h[r],{attr:o,value:c},s),"language"===o&&_.setOption("mode",b.mode[h[r].language]),"type"===o&&(document.querySelector(".savant-window").dataset.type=c),"file"===o&&(document.querySelector(".file div span").textContent=(0,g.getFileName)(c))},codeUpdate:function(){if(!(0,g.isEmpty)(h)){var t=this.activeScript,e=t.id,n=t.codeOutput,r=_.codemirror.getValue();if((0,l.update_script)(h[e],{attr:"code",value:r},{input:n}),"javascript"===h[e].language&&b.compiler){var i=this.elements.output,a=(0,o.compileCode)(r,["es2015","stage-0"]),u=i.querySelector('input[name="savant_field['.concat(e,'][compiled]"]'));(0,o.updateCompiledCode)(h[e],a,u)}}},newScript:function(t){t.preventDefault();var e=document.querySelector("div.savant-config"),n=e.querySelector(".language input:checked").value,r=e.querySelector(".label input").value||n.toUpperCase(),i=e.querySelector(".type input:checked").value,a=(0,g.uniqueID)(h),u={id:a,language:n,type:i,label:r,code:b.boilerplate[n],file:""};(0,l.add_script)(h,u,this.elements),this.toggleMenu(this.elements._svt.querySelector("i.icon.add-new")),this.newSession(!1),this.setActiveScript(h[a].id)},toggleMenu:function(t){var e=t.target||t,n=e.getAttribute("menu-target");this.elements._svt.querySelector(".".concat(n)).classList.toggle("expand"),e.classList.toggle("open")},toggleButtons:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.parentNode.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var a=r.value;a.classList[this==a?"add":"remove"]("active"),a.children[0].checked=this==a}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}},uploadFile:function(t){var e=this;t.preventDefault();var n,r=(0,g.uploader)();r.on("select",function(){n=r.state().get("selection").first().toJSON(),e.attrUpdate(t,{attr:"file",value:n.url})}),r.open()}}).init()}document.querySelector("#savantSettings")&&wp.element.render(React.createElement(a.default,null),document.getElementById("savantSettings"))},{"./actions/scriptActions":1,"./modules/dataset":4,"./modules/editor":5,"./modules/transform":6,"./modules/utilities":7,"./settings/SavantSettings":11}],4:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scripts=this.getInitialScripts(),this.options=this.getOptions()}var e,n,r;return e=t,(n=[{key:"getInitialScripts",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,a=document.querySelectorAll(".savant-data input")[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value,o=u.getAttribute("data-id"),c=u.getAttribute("data-attribute");t[o]||(t[o]={}),t[o][c]=u.value}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"getOptions",value:function(){return Array.from(document.querySelectorAll(".savant-options input")).reduce(function(t,e){var n=e.dataset.attribute,r=e.dataset.language||!1;return t[n]||(t[n]={}),r?t[n][r]=e.value:t[n]=e.value,t},{})}}])&&i(e.prototype,n),r&&i(e,r),t}();n.default=r},{}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getEditorSettings=void 0;n.getEditorSettings=function(t){var e=t.theme,n=t.mode.javascript;console.log(wp.codeEditor);var r=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};return console.log("initialise"),r.codemirror=_.extend({},r.codemirror,{indentUnit:2,tabSize:2,theme:e,mode:n}),r}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.updateCompiledCode=n.compileCode=void 0;var r=t("../actions/scriptActions");n.compileCode=function(t,e){return Babel?Babel.transform(t,{presets:e}).code:null};n.updateCompiledCode=function(t,e,n){return(0,r.update_script)(t,{attr:"compiled",value:e},{input:n})}},{"../actions/scriptActions":1}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uploader=n.getFileName=n.getFirstScript=n.uniqueID=n.isEmpty=void 0;n.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};n.uniqueID=function t(e){for(var n=Math.floor(9999999*Math.random()+1),r=!0,i=Object.keys(e),a=0;a<i.length;a++)n==i[a]&&(r=!1);if(r)return n;t(e)};n.getFirstScript=function(t){return Object.keys(t)[0]};n.getFileName=function(t){return t.replace(/(.*)wp-content/g,"....")};n.uploader=function(){return wp.media.frames.file_frame=wp.media({title:"Choose a File",button:{text:"Choose File"},multiple:!1})}},{}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"ADD_SCRIPT":var e=t.data,n=t.scripts;return n[e.id]=e,n[e.id];case"UPDATE_SCRIPT":var r=t.script,i=t.data,a=i.attr,u=i.value;return r[a]=u,r[a];case"DELETE_SCRIPT":var o=t.id;delete t.scripts[o];break;default:return}}},{}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"ADD_SCRIPT":var e=t.data,n=e.id,r=e.language,i=e.label,a=document.createElement("li");a.dataset.attribute=r,a.dataset.id=n,a.classList.add("button-language"),a.textContent=i,t.dest.appendChild(a);break;case"UPDATE_SCRIPT":var u=t.attr,o=t.value,c=t.dest;"label"===u?c.textContent=o:"language"===u&&(c.dataset.attribute=o);break;case"DELETE_SCRIPT":t.menuItem.remove();break;default:return}}},{}],10:[function(t,e,n){"use strict";function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var u,o=t[Symbol.iterator]();!(r=(u=o.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){switch(t.type){case"DELETE_SCRIPT":var e=!0,n=!1,r=void 0;try{for(var i,a=t.inputs[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.remove()}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}break;case"ADD_SCRIPT":for(var u=t.data.id,o=Object.entries(t.data),c=0;c<o.length;c++){var s=m(o[c],2),l=s[0],d=s[1],p=document.createElement("input");p.dataset.attribute=l,p.dataset.id=u,p.name="savant_field[".concat(u,"][").concat(l,"]"),p.type="hidden",p.value=d,t.dest.appendChild(p)}break;case"UPDATE_SCRIPT":var f=t.dest,v=t.value;f.value=v;break;default:return}}},{}],11:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return React.createElement("div",null,"Some content is rendering")}},{}]},{},[3]);
//# sourceMappingURL=bundle.js.map
